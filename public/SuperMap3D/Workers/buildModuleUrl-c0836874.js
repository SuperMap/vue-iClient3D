define(["exports","./Cartesian4-442405e6","./Cartographic-2cfa3a3a","./Math-3024ab74","./when-b60132fc","./Cartesian2-c4c2a8f9","./WebGLConstants-aba9fc67"],(function(e,t,r,n,a,i,s){"use strict";function o(e,r,i,s){r=a.defaultValue(r,0),i=a.defaultValue(i,0),s=a.defaultValue(s,0),n.CesiumMath.equalsEpsilon(s,6356752.314245179,n.CesiumMath.EPSILON10)&&(n.CesiumMath.Radius=s),e._radii=new t.Cartesian3(r,i,s),e._radiiSquared=new t.Cartesian3(r*r,i*i,s*s),e._radiiToTheFourth=new t.Cartesian3(r*r*r*r,i*i*i*i,s*s*s*s),e._oneOverRadii=new t.Cartesian3(0===r?0:1/r,0===i?0:1/i,0===s?0:1/s),e._oneOverRadiiSquared=new t.Cartesian3(0===r?0:1/(r*r),0===i?0:1/(i*i),0===s?0:1/(s*s)),e._minimumRadius=Math.min(r,i,s),e._maximumRadius=Math.max(r,i,s),e._centerToleranceSquared=n.CesiumMath.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function u(e,t,r){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,o(this,e,t,r)}Object.defineProperties(u.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),u.clone=function(e,r){if(a.defined(e)){var n=e._radii;return a.defined(r)?(t.Cartesian3.clone(n,r._radii),t.Cartesian3.clone(e._radiiSquared,r._radiiSquared),t.Cartesian3.clone(e._radiiToTheFourth,r._radiiToTheFourth),t.Cartesian3.clone(e._oneOverRadii,r._oneOverRadii),t.Cartesian3.clone(e._oneOverRadiiSquared,r._oneOverRadiiSquared),r._minimumRadius=e._minimumRadius,r._maximumRadius=e._maximumRadius,r._centerToleranceSquared=e._centerToleranceSquared,r):new u(n.x,n.y,n.z)}},u.fromCartesian3=function(e,t){return a.defined(t)||(t=new u),a.defined(e)?(o(t,e.x,e.y,e.z),t):t},u.WGS84=Object.freeze(new u(6378137,6378137,n.CesiumMath.Radius)),u.XIAN80=Object.freeze(new u(6378140,6378140,6356755.29)),u.CGCS2000=Object.freeze(new u(6378137,6378137,6356752.31)),u.UNIT_SPHERE=Object.freeze(new u(1,1,1)),u.MOON=Object.freeze(new u(n.CesiumMath.LUNAR_RADIUS,n.CesiumMath.LUNAR_RADIUS,n.CesiumMath.LUNAR_RADIUS)),u.prototype.clone=function(e){return u.clone(this,e)},u.packedLength=t.Cartesian3.packedLength,u.pack=function(e,r,n){return n=a.defaultValue(n,0),t.Cartesian3.pack(e._radii,r,n),r},u.unpack=function(e,r,n){r=a.defaultValue(r,0);var i=t.Cartesian3.unpack(e,r);return u.fromCartesian3(i,n)},u.prototype.geocentricSurfaceNormal=t.Cartesian3.normalize,u.prototype.geodeticSurfaceNormalCartographic=function(e,r){var n=e.longitude,i=e.latitude,s=Math.cos(i),o=s*Math.cos(n),u=s*Math.sin(n),d=Math.sin(i);return a.defined(r)||(r=new t.Cartesian3),r.x=o,r.y=u,r.z=d,t.Cartesian3.normalize(r,r)},u.prototype.geodeticSurfaceNormal=function(e,r){return a.defined(r)||(r=new t.Cartesian3),r=t.Cartesian3.multiplyComponents(e,this._oneOverRadiiSquared,r),t.Cartesian3.normalize(r,r)};var d=new t.Cartesian3,c=new t.Cartesian3;u.prototype.cartographicToCartesian=function(e,r){var n=d,i=c;this.geodeticSurfaceNormalCartographic(e,n),t.Cartesian3.multiplyComponents(this._radiiSquared,n,i);var s=Math.sqrt(t.Cartesian3.dot(n,i));return t.Cartesian3.divideByScalar(i,s,i),t.Cartesian3.multiplyByScalar(n,e.height,n),a.defined(r)||(r=new t.Cartesian3),t.Cartesian3.add(i,n,r)},u.prototype.cartographicArrayToCartesianArray=function(e,t){var r=e.length;a.defined(t)?t.length=r:t=new Array(r);for(var n=0;n<r;n++)t[n]=this.cartographicToCartesian(e[n],t[n]);return t};var f=new t.Cartesian3,h=new t.Cartesian3,l=new t.Cartesian3;function p(e){this._ellipsoid=a.defaultValue(e,u.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}u.prototype.cartesianToCartographic=function(e,i){var s=this.scaleToGeodeticSurface(e,h);if(a.defined(s)){var o=this.geodeticSurfaceNormal(s,f),u=t.Cartesian3.subtract(e,s,l),d=Math.atan2(o.y,o.x),c=Math.asin(o.z),p=n.CesiumMath.sign(t.Cartesian3.dot(u,e))*t.Cartesian3.magnitude(u);return a.defined(i)?(i.longitude=d,i.latitude=c,i.height=p,i):new r.Cartographic(d,c,p)}},u.prototype.cartesianArrayToCartographicArray=function(e,t){var r=e.length;a.defined(t)?t.length=r:t=new Array(r);for(var n=0;n<r;++n)t[n]=this.cartesianToCartographic(e[n],t[n]);return t},u.prototype.scaleToGeodeticSurface=function(e,t){return r.scaleToGeodeticSurface(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},u.prototype.scaleToGeocentricSurface=function(e,r){a.defined(r)||(r=new t.Cartesian3);var n=e.x,i=e.y,s=e.z,o=this._oneOverRadiiSquared,u=1/Math.sqrt(n*n*o.x+i*i*o.y+s*s*o.z);return t.Cartesian3.multiplyByScalar(e,u,r)},u.prototype.transformPositionToScaledSpace=function(e,r){return a.defined(r)||(r=new t.Cartesian3),t.Cartesian3.multiplyComponents(e,this._oneOverRadii,r)},u.prototype.transformPositionFromScaledSpace=function(e,r){return a.defined(r)||(r=new t.Cartesian3),t.Cartesian3.multiplyComponents(e,this._radii,r)},u.prototype.equals=function(e){return this===e||a.defined(e)&&t.Cartesian3.equals(this._radii,e._radii)},u.prototype.toString=function(){return this._radii.toString()},u.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,r,n){r=a.defaultValue(r,0);var i=this._squaredXOverSquaredZ;if(a.defined(n)||(n=new t.Cartesian3),n.x=0,n.y=0,n.z=e.z*(1-i),!(Math.abs(n.z)>=this._radii.z-r))return n},Object.defineProperties(p.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),p.prototype.project=function(e,r){var n=this._semimajorAxis,i=e.longitude*n,s=e.latitude*n,o=e.height;return a.defined(r)?(r.x=i,r.y=s,r.z=o,r):new t.Cartesian3(i,s,o)},p.prototype.unproject=function(e,t){var n=this._oneOverSemimajorAxis,i=e.x*n,s=e.y*n,o=e.z;return a.defined(t)?(t.longitude=i,t.latitude=s,t.height=o,t):new r.Cartographic(i,s,o)};var m=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function y(e,t){this.start=a.defaultValue(e,0),this.stop=a.defaultValue(t,0)}function v(e,t,r,n){this.west=a.defaultValue(e,0),this.south=a.defaultValue(t,0),this.east=a.defaultValue(r,0),this.north=a.defaultValue(n,0)}Object.defineProperties(v.prototype,{width:{get:function(){return v.computeWidth(this)}},height:{get:function(){return v.computeHeight(this)}}}),v.packedLength=4,v.pack=function(e,t,r){return r=a.defaultValue(r,0),t[r++]=e.west,t[r++]=e.south,t[r++]=e.east,t[r]=e.north,t},v.unpack=function(e,t,r){return t=a.defaultValue(t,0),a.defined(r)||(r=new v),r.west=e[t++],r.south=e[t++],r.east=e[t++],r.north=e[t],r},v.computeWidth=function(e){var t=e.east,r=e.west;return t<r&&(t+=n.CesiumMath.TWO_PI),t-r},v.computeHeight=function(e){return e.north-e.south},v.fromDegrees=function(e,t,r,i,s){return e=n.CesiumMath.toRadians(a.defaultValue(e,0)),t=n.CesiumMath.toRadians(a.defaultValue(t,0)),r=n.CesiumMath.toRadians(a.defaultValue(r,0)),i=n.CesiumMath.toRadians(a.defaultValue(i,0)),a.defined(s)?(s.west=e,s.south=t,s.east=r,s.north=i,s):new v(e,t,r,i)},v.fromRadians=function(e,t,r,n,i){return a.defined(i)?(i.west=a.defaultValue(e,0),i.south=a.defaultValue(t,0),i.east=a.defaultValue(r,0),i.north=a.defaultValue(n,0),i):new v(e,t,r,n)},v.fromCartographicArray=function(e,t){for(var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=Number.MAX_VALUE,o=-Number.MAX_VALUE,u=Number.MAX_VALUE,d=-Number.MAX_VALUE,c=0,f=e.length;c<f;c++){var h=e[c];r=Math.min(r,h.longitude),i=Math.max(i,h.longitude),u=Math.min(u,h.latitude),d=Math.max(d,h.latitude);var l=h.longitude>=0?h.longitude:h.longitude+n.CesiumMath.TWO_PI;s=Math.min(s,l),o=Math.max(o,l)}return i-r>o-s&&(r=s,(i=o)>n.CesiumMath.PI&&(i-=n.CesiumMath.TWO_PI),r>n.CesiumMath.PI&&(r-=n.CesiumMath.TWO_PI)),a.defined(t)?(t.west=r,t.south=u,t.east=i,t.north=d,t):new v(r,u,i,d)},v.fromCartesianArray=function(e,t,r){t=a.defaultValue(t,u.WGS84);for(var i=Number.MAX_VALUE,s=-Number.MAX_VALUE,o=Number.MAX_VALUE,d=-Number.MAX_VALUE,c=Number.MAX_VALUE,f=-Number.MAX_VALUE,h=0,l=e.length;h<l;h++){var p=t.cartesianToCartographic(e[h]);i=Math.min(i,p.longitude),s=Math.max(s,p.longitude),c=Math.min(c,p.latitude),f=Math.max(f,p.latitude);var m=p.longitude>=0?p.longitude:p.longitude+n.CesiumMath.TWO_PI;o=Math.min(o,m),d=Math.max(d,m)}return s-i>d-o&&(i=o,(s=d)>n.CesiumMath.PI&&(s-=n.CesiumMath.TWO_PI),i>n.CesiumMath.PI&&(i-=n.CesiumMath.TWO_PI)),a.defined(r)?(r.west=i,r.south=c,r.east=s,r.north=f,r):new v(i,c,s,f)},v.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new v(e.west,e.south,e.east,e.north)},v.equalsEpsilon=function(e,t,r){return e===t||a.defined(e)&&a.defined(t)&&Math.abs(e.west-t.west)<=r&&Math.abs(e.south-t.south)<=r&&Math.abs(e.east-t.east)<=r&&Math.abs(e.north-t.north)<=r},v.prototype.clone=function(e){return v.clone(this,e)},v.prototype.equals=function(e){return v.equals(this,e)},v.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},v.prototype.equalsEpsilon=function(e,t){return v.equalsEpsilon(this,e,t)},v.validate=function(e){},v.southwest=function(e,t){return a.defined(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new r.Cartographic(e.west,e.south)},v.northwest=function(e,t){return a.defined(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new r.Cartographic(e.west,e.north)},v.northeast=function(e,t){return a.defined(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new r.Cartographic(e.east,e.north)},v.southeast=function(e,t){return a.defined(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new r.Cartographic(e.east,e.south)},v.center=function(e,t){var i=e.east,s=e.west;i<s&&(i+=n.CesiumMath.TWO_PI);var o=n.CesiumMath.negativePiToPi(.5*(s+i)),u=.5*(e.south+e.north);return a.defined(t)?(t.longitude=o,t.latitude=u,t.height=0,t):new r.Cartographic(o,u)},v.intersection=function(e,t,r){var i=e.east,s=e.west,o=t.east,u=t.west;i<s&&o>0?i+=n.CesiumMath.TWO_PI:o<u&&i>0&&(o+=n.CesiumMath.TWO_PI),i<s&&u<0?u+=n.CesiumMath.TWO_PI:o<u&&s<0&&(s+=n.CesiumMath.TWO_PI);var d=n.CesiumMath.negativePiToPi(Math.max(s,u)),c=n.CesiumMath.negativePiToPi(Math.min(i,o));if(!((e.west<e.east||t.west<t.east)&&c<=d)){var f=Math.max(e.south,t.south),h=Math.min(e.north,t.north);if(!(f>=h))return a.defined(r)?(r.west=d,r.south=f,r.east=c,r.north=h,r):new v(d,f,c,h)}},v.simpleIntersection=function(e,t,r){var n=Math.max(e.west,t.west),i=Math.max(e.south,t.south),s=Math.min(e.east,t.east),o=Math.min(e.north,t.north);if(!(i>=o||n>=s))return a.defined(r)?(r.west=n,r.south=i,r.east=s,r.north=o,r):new v(n,i,s,o)},v.union=function(e,t,r){a.defined(r)||(r=new v);var i=e.east,s=e.west,o=t.east,u=t.west;i<s&&o>0?i+=n.CesiumMath.TWO_PI:o<u&&i>0&&(o+=n.CesiumMath.TWO_PI),i<s&&u<0?u+=n.CesiumMath.TWO_PI:o<u&&s<0&&(s+=n.CesiumMath.TWO_PI);var d=n.CesiumMath.convertLongitudeRange(Math.min(s,u)),c=n.CesiumMath.convertLongitudeRange(Math.max(i,o));return r.west=d,r.south=Math.min(e.south,t.south),r.east=c,r.north=Math.max(e.north,t.north),r},v.expand=function(e,t,r){return a.defined(r)||(r=new v),r.west=Math.min(e.west,t.longitude),r.south=Math.min(e.south,t.latitude),r.east=Math.max(e.east,t.longitude),r.north=Math.max(e.north,t.latitude),r},v.contains=function(e,t){var r=t.longitude,a=t.latitude,i=e.west,s=e.east;return s<i&&(s+=n.CesiumMath.TWO_PI,r<0&&(r+=n.CesiumMath.TWO_PI)),(r>i||n.CesiumMath.equalsEpsilon(r,i,n.CesiumMath.EPSILON14))&&(r<s||n.CesiumMath.equalsEpsilon(r,s,n.CesiumMath.EPSILON14))&&a>=e.south&&a<=e.north};var C=new r.Cartographic;v.subsample=function(e,t,r,i){t=a.defaultValue(t,u.WGS84),r=a.defaultValue(r,0),a.defined(i)||(i=[]);var s=0,o=e.north,d=e.south,c=e.east,f=e.west,h=C;h.height=r,h.longitude=f,h.latitude=o,i[s]=t.cartographicToCartesian(h,i[s]),s++,h.longitude=c,i[s]=t.cartographicToCartesian(h,i[s]),s++,h.latitude=d,i[s]=t.cartographicToCartesian(h,i[s]),s++,h.longitude=f,i[s]=t.cartographicToCartesian(h,i[s]),s++,h.latitude=o<0?o:d>0?d:0;for(var l=1;l<8;++l)h.longitude=-Math.PI+l*n.CesiumMath.PI_OVER_TWO,v.contains(e,h)&&(i[s]=t.cartographicToCartesian(h,i[s]),s++);return 0===h.latitude&&(h.longitude=f,i[s]=t.cartographicToCartesian(h,i[s]),s++,h.longitude=c,i[s]=t.cartographicToCartesian(h,i[s]),s++),i.length=s,i};var g=new r.Cartographic;function q(e,r){this.center=t.Cartesian3.clone(a.defaultValue(e,t.Cartesian3.ZERO)),this.radius=a.defaultValue(r,0)}v.prototype.contains=function(e){return v.contains(this,v.southwest(e,g))&&v.contains(this,v.northwest(e,g))&&v.contains(this,v.southeast(e,g))&&v.contains(this,v.northeast(e,g))},v.MAX_VALUE=Object.freeze(new v(-Math.PI,-n.CesiumMath.PI_OVER_TWO,Math.PI,n.CesiumMath.PI_OVER_TWO));var w=new t.Cartesian3,_=new t.Cartesian3,R=new t.Cartesian3,b=new t.Cartesian3,O=new t.Cartesian3,S=new t.Cartesian3,A=new t.Cartesian3,x=new t.Cartesian3,M=new t.Cartesian3,T=new t.Cartesian3,E=new t.Cartesian3,I=new t.Cartesian3,P=4/3*n.CesiumMath.PI;q.fromPoints=function(e,r){if(a.defined(r)||(r=new q),!a.defined(e)||0===e.length)return r.center=t.Cartesian3.clone(t.Cartesian3.ZERO,r.center),r.radius=0,r;var n,i=t.Cartesian3.clone(e[0],A),s=t.Cartesian3.clone(i,w),o=t.Cartesian3.clone(i,_),u=t.Cartesian3.clone(i,R),d=t.Cartesian3.clone(i,b),c=t.Cartesian3.clone(i,O),f=t.Cartesian3.clone(i,S),h=e.length;for(n=1;n<h;n++){t.Cartesian3.clone(e[n],i);var l=i.x,p=i.y,m=i.z;l<s.x&&t.Cartesian3.clone(i,s),l>d.x&&t.Cartesian3.clone(i,d),p<o.y&&t.Cartesian3.clone(i,o),p>c.y&&t.Cartesian3.clone(i,c),m<u.z&&t.Cartesian3.clone(i,u),m>f.z&&t.Cartesian3.clone(i,f)}var y=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(d,s,x)),v=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(c,o,x)),C=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(f,u,x)),g=s,P=d,V=y;v>V&&(V=v,g=o,P=c),C>V&&(V=C,g=u,P=f);var U=M;U.x=.5*(g.x+P.x),U.y=.5*(g.y+P.y),U.z=.5*(g.z+P.z);var k=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(P,U,x)),z=Math.sqrt(k),L=T;L.x=s.x,L.y=o.y,L.z=u.z;var B=E;B.x=d.x,B.y=c.y,B.z=f.z;var D=t.Cartesian3.midpoint(L,B,I),N=0;for(n=0;n<h;n++){t.Cartesian3.clone(e[n],i);var j=t.Cartesian3.magnitude(t.Cartesian3.subtract(i,D,x));j>N&&(N=j);var K=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(i,U,x));if(K>k){var F=Math.sqrt(K);k=(z=.5*(z+F))*z;var H=F-z;U.x=(z*U.x+H*i.x)/F,U.y=(z*U.y+H*i.y)/F,U.z=(z*U.z+H*i.z)/F}}return z<N?(t.Cartesian3.clone(U,r.center),r.radius=z):(t.Cartesian3.clone(D,r.center),r.radius=N),r};var V=new p,U=new t.Cartesian3,k=new t.Cartesian3,z=new r.Cartographic,L=new r.Cartographic;q.fromRectangle2D=function(e,t,r){return q.fromRectangleWithHeights2D(e,t,0,0,r)},q.fromRectangleWithHeights2D=function(e,r,n,i,s){if(a.defined(s)||(s=new q),!a.defined(e))return s.center=t.Cartesian3.clone(t.Cartesian3.ZERO,s.center),s.radius=0,s;r=a.defaultValue(r,V),v.southwest(e,z),z.height=n,v.northeast(e,L),L.height=i;var o=r.project(z,U),u=r.project(L,k),d=u.x-o.x,c=u.y-o.y,f=u.z-o.z;s.radius=.5*Math.sqrt(d*d+c*c+f*f);var h=s.center;return h.x=o.x+.5*d,h.y=o.y+.5*c,h.z=o.z+.5*f,s};var B=[];q.fromRectangle3D=function(e,r,n,i){if(r=a.defaultValue(r,u.WGS84),n=a.defaultValue(n,0),a.defined(i)||(i=new q),!a.defined(e))return i.center=t.Cartesian3.clone(t.Cartesian3.ZERO,i.center),i.radius=0,i;var s=v.subsample(e,r,n,B);return q.fromPoints(s,i)},q.fromVertices=function(e,r,n,i){if(a.defined(i)||(i=new q),!a.defined(e)||0===e.length)return i.center=t.Cartesian3.clone(t.Cartesian3.ZERO,i.center),i.radius=0,i;r=a.defaultValue(r,t.Cartesian3.ZERO),n=a.defaultValue(n,3);var s=A;s.x=e[0]+r.x,s.y=e[1]+r.y,s.z=e[2]+r.z;var o,u=t.Cartesian3.clone(s,w),d=t.Cartesian3.clone(s,_),c=t.Cartesian3.clone(s,R),f=t.Cartesian3.clone(s,b),h=t.Cartesian3.clone(s,O),l=t.Cartesian3.clone(s,S),p=e.length;for(o=0;o<p;o+=n){var m=e[o]+r.x,y=e[o+1]+r.y,v=e[o+2]+r.z;s.x=m,s.y=y,s.z=v,m<u.x&&t.Cartesian3.clone(s,u),m>f.x&&t.Cartesian3.clone(s,f),y<d.y&&t.Cartesian3.clone(s,d),y>h.y&&t.Cartesian3.clone(s,h),v<c.z&&t.Cartesian3.clone(s,c),v>l.z&&t.Cartesian3.clone(s,l)}var C=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(f,u,x)),g=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(h,d,x)),P=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(l,c,x)),V=u,U=f,k=C;g>k&&(k=g,V=d,U=h),P>k&&(k=P,V=c,U=l);var z=M;z.x=.5*(V.x+U.x),z.y=.5*(V.y+U.y),z.z=.5*(V.z+U.z);var L=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(U,z,x)),B=Math.sqrt(L),D=T;D.x=u.x,D.y=d.y,D.z=c.z;var N=E;N.x=f.x,N.y=h.y,N.z=l.z;var j=t.Cartesian3.midpoint(D,N,I),K=0;for(o=0;o<p;o+=n){s.x=e[o]+r.x,s.y=e[o+1]+r.y,s.z=e[o+2]+r.z;var F=t.Cartesian3.magnitude(t.Cartesian3.subtract(s,j,x));F>K&&(K=F);var H=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(s,z,x));if(H>L){var W=Math.sqrt(H);L=(B=.5*(B+W))*B;var X=W-B;z.x=(B*z.x+X*s.x)/W,z.y=(B*z.y+X*s.y)/W,z.z=(B*z.z+X*s.z)/W}}return B<K?(t.Cartesian3.clone(z,i.center),i.radius=B):(t.Cartesian3.clone(j,i.center),i.radius=K),i},q.fromEncodedCartesianVertices=function(e,r,n){if(a.defined(n)||(n=new q),!a.defined(e)||!a.defined(r)||e.length!==r.length||0===e.length)return n.center=t.Cartesian3.clone(t.Cartesian3.ZERO,n.center),n.radius=0,n;var i=A;i.x=e[0]+r[0],i.y=e[1]+r[1],i.z=e[2]+r[2];var s,o=t.Cartesian3.clone(i,w),u=t.Cartesian3.clone(i,_),d=t.Cartesian3.clone(i,R),c=t.Cartesian3.clone(i,b),f=t.Cartesian3.clone(i,O),h=t.Cartesian3.clone(i,S),l=e.length;for(s=0;s<l;s+=3){var p=e[s]+r[s],m=e[s+1]+r[s+1],y=e[s+2]+r[s+2];i.x=p,i.y=m,i.z=y,p<o.x&&t.Cartesian3.clone(i,o),p>c.x&&t.Cartesian3.clone(i,c),m<u.y&&t.Cartesian3.clone(i,u),m>f.y&&t.Cartesian3.clone(i,f),y<d.z&&t.Cartesian3.clone(i,d),y>h.z&&t.Cartesian3.clone(i,h)}var v=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(c,o,x)),C=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(f,u,x)),g=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(h,d,x)),P=o,V=c,U=v;C>U&&(U=C,P=u,V=f),g>U&&(U=g,P=d,V=h);var k=M;k.x=.5*(P.x+V.x),k.y=.5*(P.y+V.y),k.z=.5*(P.z+V.z);var z=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(V,k,x)),L=Math.sqrt(z),B=T;B.x=o.x,B.y=u.y,B.z=d.z;var D=E;D.x=c.x,D.y=f.y,D.z=h.z;var N=t.Cartesian3.midpoint(B,D,I),j=0;for(s=0;s<l;s+=3){i.x=e[s]+r[s],i.y=e[s+1]+r[s+1],i.z=e[s+2]+r[s+2];var K=t.Cartesian3.magnitude(t.Cartesian3.subtract(i,N,x));K>j&&(j=K);var F=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(i,k,x));if(F>z){var H=Math.sqrt(F);z=(L=.5*(L+H))*L;var W=H-L;k.x=(L*k.x+W*i.x)/H,k.y=(L*k.y+W*i.y)/H,k.z=(L*k.z+W*i.z)/H}}return L<j?(t.Cartesian3.clone(k,n.center),n.radius=L):(t.Cartesian3.clone(N,n.center),n.radius=j),n},q.fromCornerPoints=function(e,r,n){a.defined(n)||(n=new q);var i=t.Cartesian3.midpoint(e,r,n.center);return n.radius=t.Cartesian3.distance(i,r),n},q.fromEllipsoid=function(e,r){return a.defined(r)||(r=new q),t.Cartesian3.clone(t.Cartesian3.ZERO,r.center),r.radius=e.maximumRadius,r};var D=new t.Cartesian3;q.fromBoundingSpheres=function(e,r){if(a.defined(r)||(r=new q),!a.defined(e)||0===e.length)return r.center=t.Cartesian3.clone(t.Cartesian3.ZERO,r.center),r.radius=0,r;var n=e.length;if(1===n)return q.clone(e[0],r);if(2===n)return q.union(e[0],e[1],r);var i,s=[];for(i=0;i<n;i++)s.push(e[i].center);var o=(r=q.fromPoints(s,r)).center,u=r.radius;for(i=0;i<n;i++){var d=e[i];u=Math.max(u,t.Cartesian3.distance(o,d.center,D)+d.radius)}return r.radius=u,r};var N=new t.Cartesian3,j=new t.Cartesian3,K=new t.Cartesian3;q.fromOrientedBoundingBox=function(e,r){a.defined(r)||(r=new q);var n=e.halfAxes,s=i.Matrix3.getColumn(n,0,N),o=i.Matrix3.getColumn(n,1,j),u=i.Matrix3.getColumn(n,2,K);return t.Cartesian3.add(s,o,s),t.Cartesian3.add(s,u,s),r.center=t.Cartesian3.clone(e.center,r.center),r.radius=t.Cartesian3.magnitude(s),r},q.clone=function(e,r){if(a.defined(e))return a.defined(r)?(r.center=t.Cartesian3.clone(e.center,r.center),r.radius=e.radius,r):new q(e.center,e.radius)},q.packedLength=4,q.pack=function(e,t,r){r=a.defaultValue(r,0);var n=e.center;return t[r++]=n.x,t[r++]=n.y,t[r++]=n.z,t[r]=e.radius,t},q.unpack=function(e,t,r){t=a.defaultValue(t,0),a.defined(r)||(r=new q);var n=r.center;return n.x=e[t++],n.y=e[t++],n.z=e[t++],r.radius=e[t],r};var F=new t.Cartesian3,H=new t.Cartesian3;q.union=function(e,r,n){a.defined(n)||(n=new q);var i=e.center,s=e.radius,o=r.center,u=r.radius,d=t.Cartesian3.subtract(o,i,F),c=t.Cartesian3.magnitude(d);if(s>=c+u)return e.clone(n),n;if(u>=c+s)return r.clone(n),n;var f=.5*(s+c+u),h=t.Cartesian3.multiplyByScalar(d,(-s+f)/c,H);return t.Cartesian3.add(h,i,h),t.Cartesian3.clone(h,n.center),n.radius=f,n};var W=new t.Cartesian3;q.expand=function(e,r,n){n=q.clone(e,n);var a=t.Cartesian3.magnitude(t.Cartesian3.subtract(r,n.center,W));return a>n.radius&&(n.radius=a),n},q.intersectPlane=function(e,r){var n=e.center,a=e.radius,i=r.normal,s=t.Cartesian3.dot(i,n)+r.distance;return s<-a?m.OUTSIDE:s<a?m.INTERSECTING:m.INSIDE},q.transform=function(e,t,r){return a.defined(r)||(r=new q),r.center=i.Matrix4.multiplyByPoint(t,e.center,r.center),r.radius=i.Matrix4.getMaximumScale(t)*e.radius,r};var X=new t.Cartesian3;q.distanceSquaredTo=function(e,r){var n=t.Cartesian3.subtract(e.center,r,X);return t.Cartesian3.magnitudeSquared(n)-e.radius*e.radius},q.transformWithoutScale=function(e,t,r){return a.defined(r)||(r=new q),r.center=i.Matrix4.multiplyByPoint(t,e.center,r.center),r.radius=e.radius,r};var G=new t.Cartesian3;q.computePlaneDistances=function(e,r,n,i){a.defined(i)||(i=new y);var s=t.Cartesian3.subtract(e.center,r,G),o=t.Cartesian3.dot(n,s);return i.start=o-e.radius,i.stop=o+e.radius,i};for(var Y=new t.Cartesian3,J=new t.Cartesian3,Z=new t.Cartesian3,Q=new t.Cartesian3,$=new t.Cartesian3,ee=new r.Cartographic,te=new Array(8),re=0;re<8;++re)te[re]=new t.Cartesian3;var ne=new p;
/**
     * @license
     *
     * Grauw URI utilities
     *
     * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js
     *
     * @author Laurens Holst (http://www.grauw.nl/)
     *
     *   Copyright 2012 Laurens Holst
     *
     *   Licensed under the Apache License, Version 2.0 (the "License");
     *   you may not use this file except in compliance with the License.
     *   You may obtain a copy of the License at
     *
     *       http://www.apache.org/licenses/LICENSE-2.0
     *
     *   Unless required by applicable law or agreed to in writing, software
     *   distributed under the License is distributed on an "AS IS" BASIS,
     *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     *   See the License for the specific language governing permissions and
     *   limitations under the License.
     *
     */
function ae(e){if(e instanceof ae)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=ie.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}q.projectTo2D=function(e,r,n){var i,s=(r=a.defaultValue(r,ne)).ellipsoid,o=e.center,u=e.radius;i=t.Cartesian3.equals(o,t.Cartesian3.ZERO)?t.Cartesian3.clone(t.Cartesian3.UNIT_X,Y):s.geodeticSurfaceNormal(o,Y);var d=t.Cartesian3.cross(t.Cartesian3.UNIT_Z,i,J);t.Cartesian3.normalize(d,d);var c=t.Cartesian3.cross(i,d,Z);t.Cartesian3.normalize(c,c),t.Cartesian3.multiplyByScalar(i,u,i),t.Cartesian3.multiplyByScalar(c,u,c),t.Cartesian3.multiplyByScalar(d,u,d);var f=t.Cartesian3.negate(c,$),h=t.Cartesian3.negate(d,Q),l=te,p=l[0];t.Cartesian3.add(i,c,p),t.Cartesian3.add(p,d,p),p=l[1],t.Cartesian3.add(i,c,p),t.Cartesian3.add(p,h,p),p=l[2],t.Cartesian3.add(i,f,p),t.Cartesian3.add(p,h,p),p=l[3],t.Cartesian3.add(i,f,p),t.Cartesian3.add(p,d,p),t.Cartesian3.negate(i,i),p=l[4],t.Cartesian3.add(i,c,p),t.Cartesian3.add(p,d,p),p=l[5],t.Cartesian3.add(i,c,p),t.Cartesian3.add(p,h,p),p=l[6],t.Cartesian3.add(i,f,p),t.Cartesian3.add(p,h,p),p=l[7],t.Cartesian3.add(i,f,p),t.Cartesian3.add(p,d,p);for(var m=l.length,y=0;y<m;++y){var v=l[y];t.Cartesian3.add(o,v,v);var C=s.cartesianToCartographic(v,ee);r.project(C,v)}var g=(o=(n=q.fromPoints(l,n)).center).x,w=o.y,_=o.z;return o.x=_,o.y=g,o.z=w,n},q.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)},q.equals=function(e,r){return e===r||a.defined(e)&&a.defined(r)&&t.Cartesian3.equals(e.center,r.center)&&e.radius===r.radius},q.prototype.intersectPlane=function(e){return q.intersectPlane(this,e)},q.prototype.distanceSquaredTo=function(e){return q.distanceSquaredTo(this,e)},q.prototype.computePlaneDistances=function(e,t,r){return q.computePlaneDistances(this,e,t,r)},q.prototype.isOccluded=function(e){return q.isOccluded(this,e)},q.prototype.equals=function(e){return q.equals(this,e)},q.prototype.clone=function(e){return q.clone(this,e)},q.prototype.volume=function(){var e=this.radius;return P*e*e*e},ae.prototype.scheme=null,ae.prototype.authority=null,ae.prototype.path="",ae.prototype.query=null,ae.prototype.fragment=null;var ie=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");ae.prototype.getScheme=function(){return this.scheme},ae.prototype.getAuthority=function(){return this.authority},ae.prototype.getPath=function(){return this.path},ae.prototype.getQuery=function(){return this.query},ae.prototype.getFragment=function(){return this.fragment},ae.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},ae.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},ae.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},ae.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(ue,ce).replace(se,de)),this.path&&(this.path=this.path.replace(se,de)),this.query&&(this.query=this.query.replace(se,de)),this.fragment&&(this.fragment=this.fragment.replace(se,de))};var se=/%[0-9a-z]{2}/gi,oe=/[a-zA-Z0-9\-\._~]/,ue=/(.*@)?([^@:]*)(:.*)?/;function de(e){var t=unescape(e);return oe.test(t)?t:e.toUpperCase()}function ce(e,t,r,n){return(t||"")+r.toLowerCase()+(n||"")}function fe(e,t){if(null===e||"object"!=typeof e)return e;t=a.defaultValue(t,!1);var r=new e.constructor;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];t&&(i=fe(i,t)),r[n]=i}return r}function he(e,t,r){r=a.defaultValue(r,!1);var n,i,s,o={},u=a.defined(e),d=a.defined(t);if(u)for(n in e)e.hasOwnProperty(n)&&(i=e[n],d&&r&&"object"==typeof i&&t.hasOwnProperty(n)?(s=t[n],o[n]="object"==typeof s?he(i,s,r):i):o[n]=i);if(d)for(n in t)t.hasOwnProperty(n)&&!o.hasOwnProperty(n)&&(s=t[n],o[n]=s);return o}function le(e,t){var r;return"undefined"!=typeof document&&(r=document),le._implementation(e,t,r)}ae.prototype.resolve=function(e){var t=new ae;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},ae.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],n=""==t[0];for(n&&t.shift(),""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?r.pop():"."!=e&&r.push(e);"."!=e&&".."!=e||r.push(""),n&&r.unshift(""),this.path=r.join("/")},ae.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},le._implementation=function(e,t,r){if(!a.defined(t)){if(void 0===r)return e;t=a.defaultValue(r.baseURI,r.location.href)}var n=new ae(t);return new ae(e).resolve(n).toString()};var pe,me=/^blob:/i;function ye(e){return me.test(e)}var ve=/^data:/i;function Ce(e){return ve.test(e)}var ge=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5}),qe=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3,PACK:4,BLOCK:5,BLOCKPACK:6});function we(e){e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT);var t=a.defaultValue(e.throttleByServer,!1),r=a.defaultValue(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=a.defaultValue(e.priority,0),this.throttle=r,this.throttleByServer=t,this.type=a.defaultValue(e.type,qe.OTHER),this.serverKey=void 0,this.state=ge.UNISSUED,this.deferred=void 0,this.cancelled=!1}function _e(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0;n<r.length;++n){var a=r[n],i=a.indexOf(": ");if(i>0){var s=a.substring(0,i),o=a.substring(i+2);t[s]=o}}return t}(this.responseHeaders))}function Re(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function be(e,t){return t-e}function Oe(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function Se(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}we.prototype.cancel=function(){this.cancelled=!0},we.prototype.clone=function(e){return a.defined(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new we(this)},_e.prototype.toString=function(){var e="Request has failed.";return a.defined(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},Object.defineProperties(Re.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),Re.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);var r=this;return function(){r.removeEventListener(e,t)}},Re.prototype.removeEventListener=function(e,t){for(var r=this._listeners,n=this._scopes,a=-1,i=0;i<r.length;i++)if(r[i]===e&&n[i]===t){a=i;break}return-1!==a&&(this._insideRaiseEvent?(this._toRemove.push(a),r[a]=void 0,n[a]=void 0):(r.splice(a,1),n.splice(a,1)),!0)},Re.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var t=this._listeners,r=this._scopes,n=t.length;for(e=0;e<n;e++){var i=t[e];a.defined(i)&&t[e].apply(r[e],arguments)}var s=this._toRemove;if((n=s.length)>0){for(s.sort(be),e=0;e<n;e++){var o=s[e];t.splice(o,1),r.splice(o,1)}s.length=0}this._insideRaiseEvent=!1},Object.defineProperties(Oe.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),Oe.prototype.reserve=function(e){e=a.defaultValue(e,this._length),this._array.length=e},Oe.prototype.heapify=function(e){e=a.defaultValue(e,0);for(var t=this._length,r=this._comparator,n=this._array,i=-1,s=!0;s;){var o=2*(e+1),u=o-1;i=u<t&&r(n[u],n[e])<0?u:e,o<t&&r(n[o],n[i])<0&&(i=o),i!==e?(Se(n,i,e),e=i):s=!1}},Oe.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},Oe.prototype.insert=function(e){var t,r=this._array,n=this._comparator,i=this._maximumLength,s=this._length++;for(s<r.length?r[s]=e:r.push(e);0!==s;){var o=Math.floor((s-1)/2);if(!(n(r[s],r[o])<0))break;Se(r,s,o),s=o}return a.defined(i)&&this._length>i&&(t=r[i],r.pop(),this._length=i),t},Oe.prototype.pop=function(e){if(e=a.defaultValue(e,0),0!==this._length){var t=this._array,r=t[e];return Se(t,e,--this._length),t[this._length]=void 0,this.heapify(e),r}};var Ae="undefined"!=typeof performance&&"function"==typeof performance.now&&isFinite(performance.now())?function(){return performance.now()}:function(){return Date.now()};function xe(e,t){return e.priority-t.priority}var Me={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0,totalRequestTime:0},Te=20,Ee=new Oe({comparator:xe});Ee.maximumLength=Te,Ee.reserve(Te);var Ie=[],Pe={},Ve="undefined"!=typeof document?new ae(document.location.href):new ae,Ue=new Re;function ke(){}function ze(e){a.defined(e.priorityFunction)&&(e.priority=e.priorityFunction())}function Le(e){var t=a.defaultValue(ke.requestsByServer[e],ke.maximumRequestsPerServer);return Pe[e]<t}function Be(e){return a.defined(e.packKey)||(e.packKey=e.serverKey+"_"+e.providerName),e.packKey}function De(e){return a.defined(e.blockKey)||(e.blockKey=e.serverKey+"_"+e.providerName+"_"+e.quadKey+e.url.substring(e.url.indexOf("dataVersion"))),e.blockKey}function Ne(e){var t=Be(e);return a.defined(ke.packRequestGroup[t])||(ke.packRequestGroup[t]=[]),a.defined(ke.packRequestQuadKey[t])||(ke.packRequestQuadKey[t]=""),a.defined(ke.packRequestPromise[t])||(ke.packRequestPromise[t]=a.when.defer()),a.defined(ke.quadKeyIndex[t])||(ke.quadKeyIndex[t]=0),e.quadKeyIndex=ke.quadKeyIndex[t]++,e.deferred=ke.packRequestPromise[t],e.state=ge.ISSUED,ke.packRequestGroup[t].push(e),e.deferred.promise}function je(e){for(var t=0,r=e.length;t<r;t++){e[t].state=ge.CANCELLED}}function Ke(e){for(var t=[],r={},n=0,a=e.length;n<a;n++){var i=e[n];if(!i.cancelled){var s=i.quadKey;r[s]||(r[s]=!0,t.push(s))}}return t}function Fe(){var e=ke.packRequestGroup;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(r.length<1)continue;var n=r[0].clone(),i=-1!==n.url.indexOf("rest/maps");n.serverKey=r[0].serverKey,n.state=r[0].state;var s=n.url,o=Ke(r);if(o.length<1)continue;ke.packRequestQuadKey[t]=i?o.join(","):o.join(";");var u=ke.packRequestQuadKey[t];if(n.throttleByServer&&!Le(n.serverKey)){je(r),ke.packRequestPromise[t].reject();continue}n.deferred=ke.packRequestPromise[t];var d=new ae(s);d.query=i?a.defined(d.query)?d.query+"&tiles="+u:"tiles="+u:a.defined(d.query)?d.query+"&extratiles="+u:"extratiles="+u,n.url=d.toString(),Xe(n,n.url)}ke.packRequestGroup={},ke.packRequestPromise={},ke.packRequestQuadKey={},ke.quadKeyIndex={}}function He(){var e=ke.blockRequest;for(var t in e){if(e.hasOwnProperty(t))Xe(e[t])}ke.blockRequest={}}function We(e){if(e.state===ge.UNISSUED)if(e.state=ge.ISSUED,e.type===qe.PACK||e.type===qe.BLOCKPACK){var t=Be(e);a.defined(ke.packRequestPromise[t])||(ke.packRequestPromise[t]=a.when.defer()),e.deferred=ke.packRequestPromise[t]}else e.deferred=a.when.defer();return e.deferred.promise}function Xe(e,t){var r=We(e);return e.state=ge.ACTIVE,Ie.push(e),++Me.numberOfActiveRequests,++Me.numberOfActiveRequestsEver,++Pe[e.serverKey],e.startTime=Ae(),e.requestFunction(t).then(function(e){return function(t){if(e.state!==ge.CANCELLED&&(--Me.numberOfActiveRequests,--Pe[e.serverKey],Ue.raiseEvent(),e.state=ge.RECEIVED,e.deferred.resolve(t),e.endTime=Ae(),(ke.statisticRequestTime>0||e.type!==qe.OTHER)&&(Me.totalRequestTime+=e.endTime-e.startTime),e.type===qe.BLOCK||e.type===qe.BLOCKPACK)){var r=De(e);a.defined(ke.blockDefer[r])&&(ke.blockDefer[r]=void 0,delete ke.blockDefer[r])}}}(e)).otherwise(function(e){return function(t){e.state!==ge.CANCELLED&&(++Me.numberOfFailedRequests,--Me.numberOfActiveRequests,--Pe[e.serverKey],Ue.raiseEvent(t),e.state=ge.FAILED,e.deferred.reject(t))}}(e)),r}function Ge(e){var t=e.state===ge.ACTIVE;e.state=ge.CANCELLED,++Me.numberOfCancelledRequests,e.deferred.reject(),t&&(--Me.numberOfActiveRequests,--Pe[e.serverKey],++Me.numberOfCancelledActiveRequests),a.defined(e.cancelFunction)&&e.cancelFunction()}ke.TIMEOUT=5e3,ke.CANCLE_COUNT=3,ke.statisticRequestTime=-1,ke.maximumRequests=50,ke.maximumRequestsPerServer=6,ke.perPacketCount=20,ke.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},ke.throttleRequests=!0,ke.debugShowStatistics=!1,ke.requestCompletedEvent=Ue,Object.defineProperties(ke,{activeRequestLength:{get:function(){return Ie.length}},statistics:{get:function(){return Me}},priorityHeapLength:{get:function(){return Te},set:function(e){if(e<Te)for(;Ee.length>e;){Ge(Ee.pop())}Te=e,Ee.maximumLength=e,Ee.reserve(e)}}}),ke.packRequestGroup={},ke.packRequestPromise={},ke.packRequestQuadKey={},ke.quadKeyIndex={},ke.packRequestHeap={},ke.blockDefer={},ke.blockRequest={},ke.update=function(){var e,t,r=0,n=Ie.length;for(e=0;e<n;++e)(t=Ie[e]).cancelled&&Ge(t),t.state===ge.ACTIVE?r>0&&(Ie[e-r]=t):++r;Ie.length-=r;var a=Ee.internalArray,i=Ee.length;for(e=0;e<i;++e)ze(a[e]);Ee.resort(),function(){for(var e in ke.packRequestHeap)if(ke.packRequestHeap.hasOwnProperty(e)){for(var t=ke.packRequestHeap[e],r=t.internalArray,n=t.length,a=0;a<n;++a)ze(r[a]);t.resort()}}(),He(),function(){for(var e in ke.packRequestHeap)if(ke.packRequestHeap.hasOwnProperty(e))for(var t=ke.packRequestHeap[e];t.length>0;){var r=t.pop();r.cancelled?Ge(r):Ne(r)}Fe()}();for(var s=Math.max(ke.maximumRequests-Ie.length,0),o=0;o<s&&Ee.length>0;)(t=Ee.pop()).cancelled?Ge(t):!t.throttleByServer||Le(t.serverKey)?(Xe(t),++o):Ge(t);!function(){if(!ke.debugShowStatistics)return;0===Me.numberOfActiveRequests&&Me.lastNumberOfActiveRequests>0&&(Me.numberOfAttemptedRequests>0&&(console.log("Number of attempted requests: "+Me.numberOfAttemptedRequests),Me.numberOfAttemptedRequests=0),Me.numberOfCancelledRequests>0&&(console.log("Number of cancelled requests: "+Me.numberOfCancelledRequests),Me.numberOfCancelledRequests=0),Me.numberOfCancelledActiveRequests>0&&(console.log("Number of cancelled active requests: "+Me.numberOfCancelledActiveRequests),Me.numberOfCancelledActiveRequests=0),Me.numberOfFailedRequests>0&&(console.log("Number of failed requests: "+Me.numberOfFailedRequests),Me.numberOfFailedRequests=0));Me.lastNumberOfActiveRequests=Me.numberOfActiveRequests}()},ke.getServerKey=function(e){var t=new ae(e).resolve(Ve);t.normalize();var r=t.authority;/:/.test(r)||(r=r+":"+("https"===t.scheme?"443":"80"));var n=Pe[r];return a.defined(n)||(Pe[r]=0),r},ke.request=function(e){if(Ce(e.url)||ye(e.url))return Ue.raiseEvent(),e.state=ge.RECEIVED,e.requestFunction();if(++Me.numberOfAttemptedRequests,a.defined(e.serverKey)||(e.serverKey=ke.getServerKey(e.url)),e.type===qe.BLOCK)return function(e){var t=De(e),r=ke.blockDefer[t];return a.defined(r)||(r=ke.blockDefer[t]=a.when.defer(),ke.blockRequest[t]=e),e.deferred=r,e.state=ge.ISSUED,e.deferred.promise}(e);if(!e.throttleByServer||Le(e.serverKey)){if(!ke.throttleRequests||!e.throttle)return Xe(e);if(!(Ie.length>=ke.maximumRequests)){var t;if(ze(e),e.type===qe.PACK||e.type===qe.BLOCKPACK){var r=function(e){var t=Be(e),r=ke.packRequestHeap[t];return a.defined(r)||((r=ke.packRequestHeap[t]=new Oe({comparator:xe})).maximumLength=ke.perPacketCount,r.reserve(Te)),r}(e),n=!0;if(e.type===qe.BLOCKPACK)for(var i=0;i<r.length;i++)if(r._array[i].quadKey===e.quadKey){e.blockRequest=r._array[i],n=!1;break}n&&(t=r.insert(e))}else t=Ee.insert(e);if(a.defined(t)){if(t===e)return;Ge(t)}return We(e)}}},ke.clearForSpecs=function(){for(;Ee.length>0;){Ge(Ee.pop())}for(var e=Ie.length,t=0;t<e;++t)Ge(Ie[t]);Ie.length=0,Pe={},Me.numberOfAttemptedRequests=0,Me.numberOfActiveRequests=0,Me.numberOfCancelledRequests=0,Me.numberOfCancelledActiveRequests=0,Me.numberOfFailedRequests=0,Me.numberOfActiveRequestsEver=0,Me.lastNumberOfActiveRequests=0,Me.totalRequestTime=0},ke.numberOfActiveRequestsByServer=function(e){return Pe[e]},ke.requestHeap=Ee;var Ye={},Je={};Ye.add=function(e,t){var r=e.toLowerCase()+":"+t;a.defined(Je[r])||(Je[r]=!0)},Ye.remove=function(e,t){var r=e.toLowerCase()+":"+t;a.defined(Je[r])&&delete Je[r]},Ye.contains=function(e){var t=function(e){var t=new ae(e);t.normalize();var r=t.getAuthority();if(a.defined(r)){if(-1!==r.indexOf("@")){var n=r.split("@");r=n[1]}if(-1===r.indexOf(":")){var i=t.getScheme();if(a.defined(i)||(i=(i=window.location.protocol).substring(0,i.length-1)),"http"===i)r+=":80";else{if("https"!==i)return;r+=":443"}}return r}}(e);return!(!a.defined(t)||!a.defined(Je[t]))},Ye.clear=function(){Je={}};var Ze={};function Qe(e,t){a.defined(Ze[e])||(Ze[e]=!0,console.warn(a.defaultValue(t,e)))}Qe.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",Qe.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",Qe.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",Qe.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var $e,et=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function tt(e,t,r,n){var i,s=e.query;if(!a.defined(s)||0===s.length)return{};if(-1===s.indexOf("=")){var o={};o[s]=void 0,i=o}else i=function(e){var t={};if(""===e)return t;for(var r=e.replace(/\+/g,"%20").split(/[&;]/),n=0,i=r.length;n<i;++n){var s=r[n].split("=");if(s.length>2){var o=r[n].indexOf("=");s=[r[n].substring(0,o),r[n].substring(o+1,r[n].length)]}var u=decodeURIComponent(s[0]),d=s[1];d=a.defined(d)?decodeURIComponent(d):"";var c=t[u];"string"==typeof c?t[u]=[c,d]:Array.isArray(c)?c.push(d):t[u]=d}return t}(s);t._queryParameters=r?it(i,t._queryParameters,n):i,e.query=void 0}function rt(e,t){var r=t._queryParameters,n=Object.keys(r);1!==n.length||a.defined(r[n[0]])?e.query=function(e,t){var r="";for(var n in e)if(e.hasOwnProperty(n)){var a=e[n],i=encodeURIComponent(n)+"=";if(Array.isArray(a))for(var s=0,o=a.length;s<o;++s)r+=!0===t?i+encodeURI(a[s])+"&":i+encodeURIComponent(a[s])+"&";else r+=!0===t?i+encodeURI(a)+"&":i+encodeURIComponent(a)+"&"}return r.slice(0,-1)}(r):e.query=n[0]}function nt(e,t){return a.defined(e)?a.defined(e.clone)?e.clone():fe(e):t}function at(e){if(e.state===ge.ISSUED||e.state===ge.ACTIVE)throw new s.RuntimeError("The Resource is already being fetched.");e.state=ge.UNISSUED,e.deferred=void 0}function it(e,t,r){if(!r)return he(e,t);var n=fe(e,!0);for(var i in t)if(t.hasOwnProperty(i)){var s=n[i],o=t[i];a.defined(s)?(Array.isArray(s)||(s=n[i]=[s]),n[i]=s.concat(o)):n[i]=Array.isArray(o)?o.slice():o}return n}function st(e){"string"==typeof(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT))&&(e={url:e}),this._url=void 0,this._templateValues=nt(e.templateValues,{}),this._queryParameters=nt(e.queryParameters,{}),this.headers=nt(e.headers,{}),this.request=a.defaultValue(e.request,new we),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=a.defaultValue(e.retryAttempts,0),this._retryCount=0;var t=new ae(e.url);tt(t,this,!0,!0),t.fragment=void 0,this._url=t.toString()}function ot(e){var t=e.resource,r=e.flipY,n=e.preferImageBitmap,i=t.request;i.url=t.url,i.requestFunction=function(){var e=!1;t.isDataUri||t.isBlobUri||(e=t.isCrossOriginUrl);var s=a.when.defer();return st._Implementations.createImage(i,e,s,r,n),s.promise};var s=ke.request(i);if(a.defined(s))return s.otherwise((function(e){return i.state!==ge.FAILED?a.when.reject(e):t.retryOnError(e).then((function(s){return s?(i.state=ge.UNISSUED,i.deferred=void 0,ot({resource:t,flipY:r,preferImageBitmap:n})):a.when.reject(e)}))}))}function ut(e,t,r){var n={};n[t]=r,e.setQueryParameters(n);var i=e.request;i.url=e.url,i.requestFunction=function(){var t=a.when.defer();return window[r]=function(e){t.resolve(e);try{delete window[r]}catch(e){window[r]=void 0}},st._Implementations.loadAndExecuteScript(e.url,r,t),t.promise};var s=ke.request(i);if(a.defined(s))return s.otherwise((function(n){return i.state!==ge.FAILED?a.when.reject(n):e.retryOnError(n).then((function(s){return s?(i.state=ge.UNISSUED,i.deferred=void 0,ut(e,t,r)):a.when.reject(n)}))}))}st.createIfNeeded=function(e){return e instanceof st?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new st({url:e})},st.supportsImageBitmapOptions=function(){if(a.defined($e))return $e;if("function"!=typeof createImageBitmap)return $e=a.when.resolve(!1);return $e=st.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWP4////fwAJ+wP9CNHoHgAAAABJRU5ErkJggg=="}).then((function(e){return createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none"})})).then((function(e){return!0})).otherwise((function(){return!1}))},Object.defineProperties(st,{isBlobSupported:{get:function(){return et}}}),Object.defineProperties(st.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new ae(e);tt(t,this,!1),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return function(e){var t=new ae(e);t.normalize();var r=t.path,n=r.lastIndexOf("/");return-1!==n&&(r=r.substr(n+1)),n=r.lastIndexOf("."),-1===n?"":r.substr(n+1)}(this._url)}},isDataUri:{get:function(){return Ce(this._url)}},isBlobUri:{get:function(){return ye(this._url)}},isCrossOriginUrl:{get:function(){return function(e){a.defined(pe)||(pe=document.createElement("a")),pe.href=window.location.href;var t=pe.host,r=pe.protocol;return pe.href=e,pe.href=pe.href,r!==pe.protocol||t!==pe.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),st.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;var r=new ae(this._url);e&&rt(r,this);var n=r.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),i=this._templateValues;return n=n.replace(/{(.*?)}/g,(function(e,t){var r=i[t];return a.defined(r)?encodeURIComponent(r):e})),t&&a.defined(this.proxy)&&(n=this.proxy.getURL(n)),n},st.prototype.setQueryParameters=function(e,t){this._queryParameters=t?it(this._queryParameters,e,!1):it(e,this._queryParameters,!1)},st.prototype.appendQueryParameters=function(e){this._queryParameters=it(e,this._queryParameters,!0)},st.prototype.setTemplateValues=function(e,t){this._templateValues=t?he(this._templateValues,e):he(e,this._templateValues)},st.prototype.getDerivedResource=function(e){var t=this.clone();if(t._retryCount=0,a.defined(e.url)){var r=new ae(e.url);tt(r,t,!0,a.defaultValue(e.preserveQueryParameters,!1)),r.fragment=void 0,t._url=r.resolve(new ae(le(this._url))).toString()}return a.defined(e.queryParameters)&&(t._queryParameters=he(e.queryParameters,t._queryParameters)),a.defined(e.templateValues)&&(t._templateValues=he(e.templateValues,t.templateValues)),a.defined(e.headers)&&(t.headers=he(e.headers,t.headers)),a.defined(e.proxy)&&(t.proxy=e.proxy),a.defined(e.request)&&(t.request=e.request),a.defined(e.retryCallback)&&(t.retryCallback=e.retryCallback),a.defined(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},st.prototype.retryOnError=function(e){var t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return a.when(!1);var r=this;return a.when(t(this,e)).then((function(e){return++r._retryCount,e}))},st.prototype.clone=function(e){return a.defined(e)||(e=new st({url:this._url})),e._url=this._url,e._queryParameters=fe(this._queryParameters),e._templateValues=fe(this._templateValues),e.headers=fe(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},st.prototype.getBaseUri=function(e){return function(e,t){var r="",n=e.lastIndexOf("/");return-1!==n&&(r=e.substring(0,n+1)),t?(e=new ae(e),a.defined(e.query)&&(r+="?"+e.query),a.defined(e.fragment)&&(r+="#"+e.fragment),r):r}(this.getUrlComponent(e),e)},st.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e+="/"),e)},st.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},st.fetchArrayBuffer=function(e){return new st(e).fetchArrayBuffer()},st.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},st.fetchBlob=function(e){return new st(e).fetchBlob()},st.prototype.fetchImage=function(e){e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT);var t=a.defaultValue(e.preferImageBitmap,!1),r=a.defaultValue(e.preferBlob,!1),n=a.defaultValue(e.flipY,!1);if(at(this.request),!et||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!r)return ot({resource:this,flipY:n,preferImageBitmap:t});var i,s,o,u=this.fetchBlob();return a.defined(u)?st.supportsImageBitmapOptions().then((function(e){return i=e&&t,u})).then((function(e){if(a.defined(e)){if(o=e,i)return st.createImageBitmapFromBlob(e,{flipY:n,premultiplyAlpha:!1});var t=window.URL.createObjectURL(e);return ot({resource:s=new st({url:t}),flipY:n,preferImageBitmap:!1})}})).then((function(e){if(a.defined(e))return e.blob=o,i||window.URL.revokeObjectURL(s.url),e})).otherwise((function(e){return a.defined(s)&&window.URL.revokeObjectURL(s.url),e.blob=o,a.when.reject(e)})):void 0},st.fetchImage=function(e){return new st(e).fetchImage({flipY:e.flipY,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},st.prototype.fetchText=function(){return this.fetch({responseType:"text"})},st.fetchText=function(e){return new st(e).fetchText()},st.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(a.defined(e))return e.then((function(e){if(a.defined(e))return JSON.parse(e)}))},st.fetchJson=function(e){return new st(e).fetchJson()},st.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},st.fetchXML=function(e){return new st(e).fetchXML()},st.prototype.fetchJsonp=function(e){var t;e=a.defaultValue(e,"callback"),at(this.request);do{t="loadJsonp"+Math.random().toString().substring(2,8)}while(a.defined(window[t]));return ut(this,e,t)},st.fetchJsonp=function(e){return new st(e).fetchJsonp(e.callbackParameterName)},st.prototype._makeRequest=function(e){var t=this;at(t.request);var r=t.request;r.url=t.url,r.requestFunction=function(n){var i=e.responseType,s=he(e.headers,t.headers),o=e.overrideMimeType,u=e.method,d=e.data,c=a.when.defer(),f=a.defined(n)?n:t.url,h=st._Implementations.loadWithXhr(f,i,u,d,s,c,o);return a.defined(h)&&a.defined(h.abort)&&(r.cancelFunction=function(){h.abort()}),c.promise};var n=ke.request(r);if(a.defined(n))return n.then((function(e){return e})).otherwise((function(n){return r.state!==ge.FAILED?a.when.reject(n):t.retryOnError(n).then((function(i){return i?(r.state=ge.UNISSUED,r.deferred=void 0,t.fetch(e)):a.when.reject(n)}))}))};var dt=/^data:(.*?)(;base64)?,(.*)$/;function ct(e,t){var r=decodeURIComponent(t);return e?atob(r):r}function ft(e,t){for(var r=ct(e,t),n=new ArrayBuffer(r.length),a=new Uint8Array(n),i=0;i<r.length;i++)a[i]=r.charCodeAt(i);return n}function ht(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}st.prototype.fetch=function(e){return(e=nt(e,{})).method="GET",this._makeRequest(e)},st.fetch=function(e){return new st(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},st.prototype.delete=function(e){return(e=nt(e,{})).method="DELETE",this._makeRequest(e)},st.delete=function(e){return new st(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},st.prototype.head=function(e){return(e=nt(e,{})).method="HEAD",this._makeRequest(e)},st.head=function(e){return new st(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},st.prototype.options=function(e){return(e=nt(e,{})).method="OPTIONS",this._makeRequest(e)},st.options=function(e){return new st(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},st.prototype.post=function(e,t){return n.Check.defined("data",e),(t=nt(t,{})).method="POST",t.data=e,this._makeRequest(t)},st.post=function(e){return new st(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},st.prototype.put=function(e,t){return n.Check.defined("data",e),(t=nt(t,{})).method="PUT",t.data=e,this._makeRequest(t)},st.put=function(e){return new st(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},st.prototype.patch=function(e,t){return n.Check.defined("data",e),(t=nt(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},st.patch=function(e){return new st(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},st._Implementations={},st._Implementations.createImage=function(e,t,r,n,i){var o=e.url;st.supportsImageBitmapOptions().then((function(u){if(u&&i){var d=a.when.defer(),c=st._Implementations.loadWithXhr(o,"blob","GET",void 0,void 0,d,void 0,void 0,void 0);return a.defined(c)&&a.defined(c.abort)&&(e.cancelFunction=function(){c.abort()}),d.promise.then((function(e){if(a.defined(e))return st.createImageBitmapFromBlob(e,{flipY:n,premultiplyAlpha:!1});r.reject(new s.RuntimeError("Successfully retrieved "+o+" but it contained no content."))})).then(r.resolve)}!function(e,t,r){var n=new Image;n.onload=function(){r.resolve(n)},n.onerror=function(e){r.reject(e)},t&&(Ye.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e}(o,t,r)})).otherwise(r.reject)},st.createImageBitmapFromBlob=function(e,t){return n.Check.defined("options",t),n.Check.typeOf.bool("options.flipY",t.flipY),n.Check.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none"})};var lt="undefined"==typeof XMLHttpRequest;st._Implementations.loadWithXhr=function(e,t,r,n,i,o,u){var d=dt.exec(e);if(null===d){if(!lt){var c=new XMLHttpRequest;if(Ye.contains(e)&&(c.withCredentials=!0),e=e.replace(/{/g,"%7B").replace(/}/g,"%7D"),c.open(r,e,!0),a.defined(u)&&a.defined(c.overrideMimeType)&&c.overrideMimeType(u),a.defined(i))for(var f in i)i.hasOwnProperty(f)&&c.setRequestHeader(f,i[f]);a.defined(t)&&(c.responseType=t);var h=!1;return"string"==typeof e&&(h=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),c.onload=function(){if(!(c.status<200||c.status>=300)||h&&0===c.status){var e=c.response,n=c.responseType;if("HEAD"===r||"OPTIONS"===r){var i=c.getAllResponseHeaders().trim().split(/[\r\n]+/),u={};return i.forEach((function(e){var t=e.split(": "),r=t.shift();u[r]=t.join(": ")})),void o.resolve(u)}if(204===c.status)o.resolve();else if(!a.defined(e)||a.defined(t)&&n!==t)if("json"===t&&"string"==typeof e)try{o.resolve(JSON.parse(e))}catch(e){o.reject(e)}else(""===n||"document"===n)&&a.defined(c.responseXML)&&c.responseXML.hasChildNodes()?o.resolve(c.responseXML):""!==n&&"text"!==n||!a.defined(c.responseText)?o.reject(new s.RuntimeError("Invalid XMLHttpRequest response type.")):o.resolve(c.responseText);else o.resolve(e)}else o.reject(new _e(c.status,c.response,c.getAllResponseHeaders()))},c.onerror=function(e){o.reject(new _e)},c.send(n),c}!function(e,t,r,n,a,i,o){var u=require("url").parse(e),d="https:"===u.protocol?require("https"):require("http"),c=require("zlib"),f={protocol:u.protocol,hostname:u.hostname,port:u.port,path:u.path,query:u.query,method:r,headers:a};d.request(f).on("response",(function(e){if(e.statusCode<200||e.statusCode>=300)i.reject(new _e(e.statusCode,e,e.headers));else{var r=[];e.on("data",(function(e){r.push(e)})),e.on("end",(function(){var n=Buffer.concat(r);"gzip"===e.headers["content-encoding"]?c.gunzip(n,(function(e,r){e?i.reject(new s.RuntimeError("Error decompressing response.")):i.resolve(ht(r,t))})):i.resolve(ht(n,t))}))}})).on("error",(function(e){i.reject(new _e)})).end()}(e,t,r,0,i,o)}else o.resolve(function(e,t){t=a.defaultValue(t,"");var r=e[1],n=!!e[2],i=e[3];switch(t){case"":case"text":return ct(n,i);case"arraybuffer":return ft(n,i);case"blob":var s=ft(n,i);return new Blob([s],{type:r});case"document":return(new DOMParser).parseFromString(ct(n,i),r);case"json":return JSON.parse(ct(n,i))}}(d,t))},st._Implementations.loadAndExecuteScript=function(e,t,r){return function(e){var t=a.when.defer(),r=document.createElement("script");r.async=!0,r.src=e;var n=document.getElementsByTagName("head")[0];return r.onload=function(){r.onload=void 0,n.removeChild(r),t.resolve()},r.onerror=function(e){t.reject(e)},n.appendChild(r),t.promise}(e).otherwise(r.reject)},st._DefaultImplementations={},st._DefaultImplementations.createImage=st._Implementations.createImage,st._DefaultImplementations.loadWithXhr=st._Implementations.loadWithXhr,st._DefaultImplementations.loadAndExecuteScript=st._Implementations.loadAndExecuteScript,st.DEFAULT=Object.freeze(new st({url:"undefined"==typeof document?"":document.location.href.split("?")[0]}));var pt,mt,yt,vt=/((?:.*\/)|^)SuperMap3D\.js$/;function Ct(e){return"undefined"==typeof document?e:(a.defined(pt)||(pt=document.createElement("a")),pt.href=e,pt.href=pt.href,pt.href)}function gt(){return a.defined(mt)||(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:"object"==typeof define&&a.defined(define.amd)&&!define.amd.toUrlUndefined&&a.defined(require.toUrl)?le("..",_t("Core/buildModuleUrl.js")):function(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var n=e[t].getAttribute("src"),a=vt.exec(n);if(null!==a)return a[1]}}(),(mt=new st({url:Ct(e)})).appendForwardSlash()),mt;var e}function qt(e){return Ct(require.toUrl("../"+e))}function wt(e){return gt().getDerivedResource({url:e}).url}function _t(e){return a.defined(yt)||(yt="object"==typeof define&&a.defined(define.amd)&&!define.amd.toUrlUndefined&&a.defined(require.toUrl)?qt:wt),yt(e)}_t._buildModuleUrlFromBaseUrl=wt,_t._clearBaseResource=function(){mt=void 0},_t.setBaseUrl=function(e){mt=st.DEFAULT.getDerivedResource({url:e})},_t.getCesiumBaseUrl=gt,e.BoundingSphere=q,e.Ellipsoid=u,e.GeographicProjection=p,e.Intersect=m,e.Interval=y,e.Rectangle=v,e.Resource=st,e.buildModuleUrl=_t,e.oneTimeWarning=Qe}));
