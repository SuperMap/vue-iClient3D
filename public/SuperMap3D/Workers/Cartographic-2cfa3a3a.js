define(["exports","./Cartesian4-442405e6","./Math-3024ab74","./when-b60132fc"],(function(e,t,i,a){"use strict";var n=new t.Cartesian3,u=new t.Cartesian3;function d(e,d,r,s,o){var h=e.x,l=e.y,f=e.z,C=d.x,c=d.y,g=d.z,m=h*h*C*C,M=l*l*c*c,p=f*f*g*g,w=m+M+p,R=Math.sqrt(1/w),v=t.Cartesian3.multiplyByScalar(e,R,n);if(w<s)return isFinite(R)?t.Cartesian3.clone(v,o):void 0;var y=r.x,q=r.y,z=r.z,O=u;O.x=v.x*y*2,O.y=v.y*q*2,O.z=v.z*z*2;var S,b,x,E,k,V,B,I=(1-R)*t.Cartesian3.magnitude(e)/(.5*t.Cartesian3.magnitude(O)),L=0;do{L=(S=m*(k=(b=1/(1+(I-=L)*y))*b)+M*(V=(x=1/(1+I*q))*x)+p*(B=(E=1/(1+I*z))*E)-1)/(-2*(m*(k*b)*y+M*(V*x)*q+p*(B*E)*z))}while(Math.abs(S)>i.CesiumMath.EPSILON12);return a.defined(o)?(o.x=h*b,o.y=l*x,o.z=f*E,o):new t.Cartesian3(h*b,l*x,f*E)}function r(e,t,i){this.longitude=a.defaultValue(e,0),this.latitude=a.defaultValue(t,0),this.height=a.defaultValue(i,0)}r.fromRadians=function(e,t,i,n){return i=a.defaultValue(i,0),a.defined(n)?(n.longitude=e,n.latitude=t,n.height=i,n):new r(e,t,i)},r.fromDegrees=function(e,t,a,n){return e=i.CesiumMath.toRadians(e),t=i.CesiumMath.toRadians(t),r.fromRadians(e,t,a,n)};var s=new t.Cartesian3,o=new t.Cartesian3,h=new t.Cartesian3,l=new t.Cartesian3(1/6378137,1/6378137,1/6356752.314245179),f=new t.Cartesian3(1/6378137,1/6378137,1/6378137),C=new t.Cartesian3(1/40680631590769,1/40680631590769,1/40408299984661.445),c=new t.Cartesian3(1/40680631590769,1/40680631590769,1/40680631590769),g=i.CesiumMath.EPSILON1;r.fromCartesian=function(e,n,u){var m=a.defined(n)?n.oneOverRadii:f,M=a.defined(n)?n.oneOverRadiiSquared:c,p=a.defined(n)?n._centerToleranceSquared:g;i.CesiumMath.equalsEpsilon(i.CesiumMath.Radius,6356752.314245179,i.CesiumMath.EPSILON10)&&(m=a.defined(n)?n.oneOverRadii:l,M=a.defined(n)?n.oneOverRadiiSquared:C);var w=d(e,m,M,p,o);if(a.defined(w)){var R=t.Cartesian3.multiplyComponents(w,M,s);R=t.Cartesian3.normalize(R,R);var v=t.Cartesian3.subtract(e,w,h),y=Math.atan2(R.y,R.x),q=Math.asin(R.z),z=i.CesiumMath.sign(t.Cartesian3.dot(v,e))*t.Cartesian3.magnitude(v);return a.defined(u)?(u.longitude=y,u.latitude=q,u.height=z,u):new r(y,q,z)}},r.toCartesian=function(e,i,a){return t.Cartesian3.fromRadians(e.longitude,e.latitude,e.height,i,a)},r.sphericalDistance=function(e,t,a,n){if(i.Check.defined("longitudeA",e),i.Check.defined("longitudeB",a),i.Check.defined("latitudeA",t),i.Check.defined("latitudeB",n),e===a&&t===n)return 0;var u=i.CesiumMath.toRadians(t),d=i.CesiumMath.toRadians(n),r=i.CesiumMath.toRadians(e),s=i.CesiumMath.toRadians(a),o=r*r+u*u,h=s*s+d*d,l=(o+h-((r-s)*(r-s)+(u-d)*(u-d)))/(2*Math.sqrt(o)*Math.sqrt(h));return l=i.CesiumMath.clamp(l,-1,1),Math.acos(l)*i.CesiumMath.Radius},r.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new r(e.longitude,e.latitude,e.height)},r.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},r.equalsEpsilon=function(e,t,i){return e===t||a.defined(e)&&a.defined(t)&&Math.abs(e.longitude-t.longitude)<=i&&Math.abs(e.latitude-t.latitude)<=i&&Math.abs(e.height-t.height)<=i},r.ZERO=Object.freeze(new r(0,0,0)),r.prototype.clone=function(e){return r.clone(this,e)},r.prototype.equals=function(e){return r.equals(this,e)},r.prototype.equalsEpsilon=function(e,t){return r.equalsEpsilon(this,e,t)},r.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},e.Cartographic=r,e.scaleToGeodeticSurface=d}));
