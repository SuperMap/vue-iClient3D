define(["./createTaskProcessorWorker","./pako_inflate-f73548c4","./PixelFormat-4f95fc60","./when-b60132fc","./WebGLConstants-aba9fc67"],(function(e,r,t,n,a){"use strict";var i,f,E=1,u=2,s={};s[0]=t.PixelFormat.RGB_DXT1,s[E]=t.PixelFormat.RGBA_DXT3,s[u]=t.PixelFormat.RGBA_DXT5;var o,_=0;function c(e){var r=e.data,E=r.byteLength,u=new Uint8Array(r,e.offset),c=o._malloc(E);!function(e,r,t,n){var a,i=t/4,f=n%4,E=new Uint32Array(e.buffer,0,(n-f)/4),u=new Uint32Array(r.buffer);for(a=0;a<E.length;a++)u[i+a]=E[a];for(a=n-f;a<n;a++)r[t+a]=e[a]}(u,o.HEAPU8,c,E);var d=o._crn_get_dxt_format(c,E),y=s[d];if(!n.defined(y))throw new a.RuntimeError("Unsupported compressed format.");var T,l=o._crn_get_levels(c,E),U=o._crn_get_width(c,E),m=o._crn_get_height(c,E),p=0;for(T=0;T<l;++T)p+=t.PixelFormat.compressedTextureSizeInBytes(y,U>>T,m>>T);if(_<p&&(n.defined(i)&&o._free(i),i=o._malloc(p),f=new Uint8Array(o.HEAPU8.buffer,i,p),_=p),o._crn_decompress(c,E,i,p,0,l),o._free(c),n.defaultValue(e.bMipMap,!1)){var A=f.slice(0,p);return new t.CompressedTextureBuffer(y,U,m,A)}var B=t.PixelFormat.compressedTextureSizeInBytes(y,U,m),g=f.subarray(0,B),w=new Uint8Array(B);return w.set(g,0),new t.CompressedTextureBuffer(y,U,m,w)}function d(e){var r=new DataView(e),t=0,n=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var a=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var i=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var f=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var E=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var u=c({data:e.slice(t,t+E)}).bufferView,s=new ArrayBuffer(t+u.byteLength),o=new Uint8Array(s),_=new Uint32Array(s);return t=0,_[0]=n,t+=Uint32Array.BYTES_PER_ELEMENT,_[1]=a,t+=Uint32Array.BYTES_PER_ELEMENT,_[2]=i,t+=Uint32Array.BYTES_PER_ELEMENT,_[3]=f,t+=Uint32Array.BYTES_PER_ELEMENT,_[4]=u.byteLength,t+=Uint32Array.BYTES_PER_ELEMENT,o.set(u,t),s}function y(e,t){for(var n=e.data,a=[],i=0;i<n.length;i++){var f,E=n[i];try{var u=new Uint8Array(E.zipBuffer);f=r.pako.inflate(u).buffer,e.isCRN&&(f=d(f)),t.push(f),a.push({unzipBuffer:f,name:E.name})}catch(r){E.unzipLength===E.zippedLength&&(f=E.zipBuffer.buffer,e.isCRN&&(f=d(f)),t.push(f),a.push({unzipBuffer:f,name:E.name}));continue}}return{data:a}}function T(){self.onmessage=e(y),self.postMessage(!0)}return function(e){var r=e.data.webAssemblyConfig;if(n.defined(r))return require([r.modulePath],(function(e){n.defined(r.wasmBinaryFile)?(n.defined(e)||(e=self.Module),o=e,T()):(o=e,T())}))}}));
