import{reactive as e,toRefs as r,ref as l,watch as t,onMounted as o,onBeforeUnmount as n,resolveComponent as i,resolveDirective as a,openBlock as u,createBlock as s,Fragment as c,withDirectives as d,createVNode as p,toDisplayString as v,vModelSelect as f,vModelCheckbox as h,createTextVNode as m,vModelRadio as g,vShow as b}from"vue";function R(e,r,l){return r in e?Object.defineProperty(e,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[r]=l,e}function y(e,r){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),l.push.apply(l,t)}return l}function w(e){for(var r=1;r<arguments.length;r++){var l=null!=arguments[r]?arguments[r]:{};r%2?y(Object(l),!0).forEach((function(r){R(e,r,l[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):y(Object(l)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(l,r))}))}return e}var k,S,M={errorMsg:function(e){console.log("error",e),alert("error："+e)},warnMsg:function(e){console.log("warn",e)},successMsg:function(e){console.log("success",e)}},L={showRenderLoopErrors:"渲染时发生错误，已停止渲染。",AttributeError:"该组件props没有这个属性：",NoPickPositionSupported:"不支持深度纹理,无法绘制多边形，地形操作功能无法使用！",NoTerrain:"请在地形里使用地形组件！",initViewerWarn:"请先初始化viewer!",MoveMouseHeightBox:"点击鼠标左键结束矩形绘制，移动鼠标绘制box高度",RightClickEndDrawing:"右键单击结束绘制",LeftClickBottomBox:"点击鼠标左键，开始绘制矩形作为box底面",ClickModelAddBox:"点击模型，添加裁剪盒子",SkyLineWarn:"获取天际线体前，请先绘制天际线！",SkyLineBody:"天际线体",ShadowqueryWarn:"此操作需要先开启阴影！",VeiwshedBody:"可视体",VeiwshedBodyHidden:"不可视体",EchartsErr:"二维显示需要echarts支持，未找到相关依赖！",BaseMapImg:"底图",tip1:"<p>点击左键确定操作区域中间点</p><p>右键单击结束绘制</p>"},D=(S=(navigator.language||navigator.browserLanguage).toLowerCase(),window.lang=S,S).toLowerCase();var E=((k=void 0!==D?D:(navigator.language||navigator.browserLanguage).toLowerCase()).startsWith("zh")||k.startsWith("ja"),L),B=e({isViewer:!1,changeLayers:0,changeGeometrys:0});function T(i){var a,u,s,c=e({useRoller:!1,rollerMode:"lrRoller",lrRoller:"1",tbRoller:"4",TreeDatas:[]});if(i)for(var d in i)c.hasOwnProperty(d)?c[d]=i[d]:M.errorMsg(E.AttributeError+d);var p=document.getElementById("SuperMap3DContainer"),v=document.body.clientWidth-p.clientWidth,f=document.body.clientHeight-p.clientHeight,h=p.clientWidth,m=p.clientHeight,g=l(null),b=l(null),R=l(null),y=l(null),k=l(null),S=new SuperMap3D.BoundingRectangle,L={startX:.33,startY:.33,endX:.66,endY:.66,index:1,mode:1};function D(){var e,r;a=viewer.scene.layers.layerQueue,u=viewer.imageryLayers._layers,s=viewer.scene._vectorTileMaps._layerQueue,viewer.terrainProvider,c.TreeDatas.length=0,function(){if(0==a.length)return;var e={id:"s3m",label:"S3M图层",children:[]};a.forEach((function(r,l){var t={id:"s3m-"+l,label:r._name};e.children.push(t)})),c.TreeDatas[0]=e}(),function(){if(1==u.length)return;var e={id:"img",label:"IMG图层",children:[]};u.forEach((function(r,l){if(0===l)return!0;if(r._imageryProvider instanceof SuperMap3D.MvtProviderGL)return!0;var t={id:"img-"+l,label:E.BaseMapImg};r._imageryProvider.tablename&&(t.label=r._imageryProvider.tablename),e.children.unshift(t)})),e.children.length>0&&(c.TreeDatas[1]=e)}(),function(){if(0==s.length)return;var e={id:"mvt",label:"MVT图层",children:[]};s.forEach((function(r,l){var t={id:"mvt-"+l,label:r.name};e.children.unshift(t)})),c.TreeDatas[2]=e}(),r={id:"globe-0",label:"地表"},(e={id:"globe",label:"地球",children:[]}).children.push(r),c.TreeDatas[4]=e,setTimeout((function(){g.value.setCheckedNodes(c.TreeDatas)}),500)}function T(){var e=L.startX,r=L.startY,l=L.endX,t=L.endY;switch(L.mode){case 1:SuperMap3D.BoundingRectangle.unpack([e,0,1,1],0,S);break;case 2:SuperMap3D.BoundingRectangle.unpack([0,0,e,1],0,S);break;case 4:SuperMap3D.BoundingRectangle.unpack([0,r,1,1],0,S);break;case 8:SuperMap3D.BoundingRectangle.unpack([0,0,1,r],0,S);break;case 15:SuperMap3D.BoundingRectangle.unpack([e,r,l-e,t-r],0,S);break;default:SuperMap3D.BoundingRectangle.unpack([0,0,1,1],0,S)}g.value.getCheckedKeys(!0).forEach((function(e){O(e.split("-"),!0)}))}function O(e,r){var l=e[0],t=e[1];switch(l){case"s3m":if(!t){for(var o=0;o<a.length;o++)a[o].swipeEnabled=r,a[o].swipeRegion=S;return}a[t].swipeEnabled=r,a[t].swipeRegion=S;break;case"img":if(!t){for(var n=1;n<u.length;n++)u[n].swipeEnabled=r,u[n].swipeRegion=S;return}u[t].swipeEnabled=r,u[t].swipeRegion=S;break;case"mvt":if(!t){for(var i=0;i<s.length;i++)s[i].swipeEnabled=r,s[i].swipeRegion=S;return}s[t].swipeEnabled=r,s[t].swipeRegion=S;break;case"globe":viewer.scene.globe.swipeEnabled=r,viewer.scene.globe.swipeRegion=S}}function V(e){b.value.style.display="none",R.value.style.display="none",y.value.style.display="none",k.value.style.display="none",1&e&&(b.value.style.display="block"),2&e&&(R.value.style.display="block"),4&e&&(y.value.style.display="block"),8&e&&(k.value.style.display="block")}return t((function(){return B.changeLayers}),(function(e){D()})),o((function(){!function(){function e(e){document.removeEventListener("mousemove",l,!1)}function r(e,r){L.index=r,document.addEventListener("mousemove",l,!1)}function l(e){switch(e.preventDefault?e.preventDefault():e.returnValue=!1,L.index){case 1:b.value.style.left=e.clientX-v+"px",L.startX=(e.clientX-v)/h;break;case 2:y.value.style.top=e.clientY-f+"px",L.startY=(e.clientY-f)/m;break;case 3:R.value.style.left=e.clientX-v+"px",L.endX=(e.clientX-v)/h;break;case 4:k.value.style.top=e.clientY-f+"px",L.endY=(e.clientY-f)/m}T()}b.value.addEventListener("mousedown",(function(e){r(e,1)}),!1),R.value.onmousedown=function(e){r(e,3)},y.value.onmousedown=function(e){r(e,2)},k.value.onmousedown=function(e){r(e,4)},window.addEventListener("resize",(function(){h=document.body.clientWidth-v,m=document.body.clientHeight-f})),document.addEventListener("mouseup",e,!1)}(),setTimeout((function(){D()}),500)})),t((function(){return c.multiViewport}),(function(e){viewer.scene.multiViewportMode=SuperMap3D.MultiViewportMode[e]})),t((function(){return c.selectedViewport}),(function(e,r){var l=g.value.getCheckedKeys(!0);c["KeysViewport"+r]=l,g.value.setCheckedKeys(c["KeysViewport"+e],!0)})),t((function(){return c.useRoller}),(function(e){e?(1!=L.mode&&2!=L.mode||V(1),4!=L.mode&&8!=L.mode||V(4),15==L.mode&&V(15),T()):(V(0),O(["s3m"],!1),O(["img"],!1),O(["mvt"],!1),O(["globe"],!1))})),t((function(){return c.rollerMode}),(function(e){switch(e){case"lrRoller":c.useRoller&&V(1),L.mode=Number(c.lrRoller);break;case"tbRoller":c.useRoller&&V(4),L.mode=Number(c.tbRoller);break;case"customRoller":c.useRoller&&V(15),L.mode=15}c.useRoller&&T()})),t((function(){return c.lrRoller}),(function(e){c.useRoller&&(L.mode=Number(e),T())})),t((function(){return c.tbRoller}),(function(e){c.useRoller&&(L.mode=Number(e),T())})),n((function(){a=void 0,u=void 0,s=void 0})),w(w({},r(c)),{},{tree:g,checkNode:function(e){var r=g.value.getNode(e);O(e.id.split("-"),r.checked)},verticalSliderLeft:b,verticalSliderRight:R,horizontalSliderTop:y,horizontalSliderBottom:k})}var O={name:"Sm3dRoller",props:{rollerMode:{type:String}},setup:function(e){var r=T(e);return{useRoller:r.useRoller,rollerMode:r.rollerMode,lrRoller:r.lrRoller,tbRoller:r.tbRoller,TreeDatas:r.TreeDatas,tree:r.tree,checkNode:r.checkNode,verticalSliderLeft:r.verticalSliderLeft,verticalSliderRight:r.verticalSliderRight,horizontalSliderTop:r.horizontalSliderTop,horizontalSliderBottom:r.horizontalSliderBottom}}},V={id:"split-screen-panel",class:"sm-panel"},P={class:"sm-function-module-sub-section",style:{margin:"0"}},x={class:"sm-half-L"},j={style:{width:"40%"}},C={value:"lrRoller"},z={value:"tbRoller"},N={value:"customRoller"},X={class:"sm-half-L"},Y={style:{width:"auto"}},W={class:"sm-half-L"},_={style:{width:"auto"}},H={style:{width:"auto"}},U={class:"sm-half-L"},K={style:{width:"auto"}},I={style:{width:"auto"}},A={class:"sm-half-L"},G={id:"verticalSliderLeft",ref:"verticalSliderLeft"},Q={id:"verticalSliderRight",ref:"verticalSliderRight"},q={id:"horizontalSliderTop",ref:"horizontalSliderTop"},F={id:"horizontalSliderBottom",ref:"horizontalSliderBottom"};O.render=function(e,r,l,t,o,n){var R=i("el-tree"),y=a("stopdrag"),w=a("drag");return u(),s(c,null,[d(p("div",V,[d(p("div",P,[p("div",x,[p("label",j,v(e.Resource.rollerMode),1),d(p("select",{class:"sm-select-m",style:{width:"60%"},"onUpdate:modelValue":r[1]||(r[1]=function(e){return t.rollerMode=e})},[p("option",C,v(e.Resource.lrRoller),1),p("option",z,v(e.Resource.tbRoller),1),p("option",N,v(e.Resource.customRoller),1)],512),[[f,t.rollerMode]])]),p("div",X,[p("label",Y,[d(p("input",{type:"checkbox","onUpdate:modelValue":r[2]||(r[2]=function(e){return t.useRoller=e})},null,512),[[h,t.useRoller]]),m(" "+v(e.Resource.useRoller),1)])]),d(p("div",W,[p("label",_,[d(p("input",{type:"radio",value:"1","onUpdate:modelValue":r[3]||(r[3]=function(e){return t.lrRoller=e})},null,512),[[g,t.lrRoller]]),m(" "+v(e.Resource.shieldLeft),1)]),p("label",H,[d(p("input",{type:"radio",value:"2","onUpdate:modelValue":r[4]||(r[4]=function(e){return t.lrRoller=e})},null,512),[[g,t.lrRoller]]),m(" "+v(e.Resource.shieldRight),1)])],512),[[b,"lrRoller"==t.rollerMode&&t.useRoller]]),d(p("div",U,[p("label",K,[d(p("input",{type:"radio",value:"4","onUpdate:modelValue":r[5]||(r[5]=function(e){return t.tbRoller=e})},null,512),[[g,t.tbRoller]]),m(" "+v(e.Resource.shieldTop),1)]),p("label",I,[d(p("input",{type:"radio",value:"8","onUpdate:modelValue":r[6]||(r[6]=function(e){return t.tbRoller=e})},null,512),[[g,t.tbRoller]]),m(" "+v(e.Resource.shieldBottom),1)])],512),[[b,"tbRoller"==t.rollerMode&&t.useRoller]]),d(p("div",A,[p(R,{data:t.TreeDatas,"show-checkbox":"","node-key":"id",accordion:"",ref:"tree",onCheck:t.checkNode},null,8,["data","onCheck"])],512),[[b,t.useRoller]])],512),[[y]])],512),[[w]]),p("div",G,null,512),p("div",Q,null,512),p("div",q,null,512),p("div",F,null,512)],64)},O.__file="src/components/scene/roller/roller.vue",O.install=function(e){e.component(O.name,O)};export default O;
