!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["vue-webgl"]=t(e.Vue)}(this,(function(e){"use strict";var t=e.reactive({isViewer:!1,changeLayers:0,changeGeometrys:0}),o={setIsViewer:function(e){t.isViewer=e},setChangeLayers:function(e){t.changeLayers+=1},setGeometrys:function(e){t.changeGeometrys+=1,console.log(i.geometrys)}},i={geometrys:{},layers:null},n={storeState:t,actions:o,storeDate:i};function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,o){return t&&l(e.prototype,t),o&&l(e,o),e}function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function u(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){c(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=p(e);if(t){var n=p(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return h(this,o)}}function f(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return w(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}function g(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=v(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return a=e.done,e},e:function(e){l=!0,r=e},f:function(){try{a||null==o.return||o.return()}finally{if(l)throw r}}}}var b,S=/^\s+|\s+$/g,V=/^[-+]0x[0-9a-f]+$/i,D=/^0b[01]+$/i,N=/^0o[0-7]+$/i,C=parseInt,M="object"==("undefined"==typeof global?"undefined":r(global))&&global&&global.Object===Object&&global,x="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,R=M||x||Function("return this")(),k=Object.prototype.toString,L=Math.max,P=Math.min,B=function(){return R.Date.now()};function T(e,t,o){var i,n,r,a,l,s,c=0,d=!1,u=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var o=i,r=n;return i=n=void 0,c=t,a=e.apply(r,o)}function h(e){return c=e,l=setTimeout(f,t),d?m(e):a}function y(e){var o=e-s;return void 0===s||o>=t||o<0||u&&e-c>=r}function f(){var e=B();if(y(e))return v(e);l=setTimeout(f,function(e){var o=t-(e-s);return u?P(o,r-(e-c)):o}(e))}function v(e){return l=void 0,p&&i?m(e):(i=n=void 0,a)}function w(){var e=B(),o=y(e);if(i=arguments,n=this,s=e,o){if(void 0===l)return h(s);if(u)return l=setTimeout(f,t),m(s)}return void 0===l&&(l=setTimeout(f,t)),a}return t=I(t)||0,E(o)&&(d=!!o.leading,r=(u="maxWait"in o)?L(I(o.maxWait)||0,t):r,p="trailing"in o?!!o.trailing:p),w.cancel=function(){void 0!==l&&clearTimeout(l),c=0,i=s=n=l=void 0},w.flush=function(){return void 0===l?a:v(B())},w}function E(e){var t=r(e);return!!e&&("object"==t||"function"==t)}function A(e){return"symbol"==r(e)||function(e){return!!e&&"object"==r(e)}(e)&&"[object Symbol]"==k.call(e)}function I(e){if("number"==typeof e)return e;if(A(e))return NaN;if(E(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=E(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(S,"");var o=D.test(e);return o||N.test(e)?C(e.slice(2),o?2:8):V.test(e)?NaN:+e}var F=(c(b={analyze:"分析",clear:"清除",meter_second:"米/秒",meter:"米",isEdit:"编辑",isEditZ:"编辑Z轴",zAxis:"z-轴方向",visiblePositions:"坐标显示",longitude:"经度",latitude:"纬度",altitude:"高程",delete:"删除",analysisArea:"分析区域",specifyPolygon:"指定多边形区域",allRegionsAnalysis:"全部区域参与分析",allRegionsNOAnalysis:"全部区域不参与分析",slopeRange:"坡度区间",displayStyle:"显示样式",slope:"坡度",terrainExcavation:"地形开挖",terrainModify:"地形修改",terrainExcavationDepth:"开挖深度(米)",modify:"修改",excavation:"开挖",visibleHeight:"可见高度",isolineInterval:"等值距(米)",displayMode:"显示模式",contourFilling:"等高线填充",panelFilling:"等高面填充",contourPanelFilling:"等高线面填充",noColorTable:"无颜色表",currentHeight:"当前高程",floodSpeed:"淹没速度",add:"添加",scanMode:"扫描模式",lineScan:"线状扫描",circularScan:"环状扫描",scanColor:"扫描颜色",scanTexture:"扫描纹理",particleSystem:"粒子",flameTyle:"火焰类型",fountainTyle:"水柱类型",type:"类型",flame:"标准立体火焰",ringFire:"环形火",jetFire:"喷射火",flowFire:"流淌火",explosionFire:"爆炸火",fountain:"喷泉",fireWater:"消防水",setting:"参数设置",ringRadius:"环形半径",emissionRate:"粒子数量",particleSize:"粒子大小",particleLife:"生命周期",speedRange:"速度范围",startScale:"初始比例",endScale:"终止比例",gravity:"重力",launchType:"发射类型",circularRadiation:"圆形放射",spheroidRadiation:"球体放射",conicalRadiation:"圆锥体放射",boxedRadiation:"盒状放射",scale:"缩放",searchLayers:"查询图层",positionMode:"位置模式",intersects:"相交",disjoint:"相离",contains:"包含",geometryType:"模型选择",box:"立方体",search:"查询",viewportOne:"视口一",viewportTwo:"视口二",viewportThree:"视口三",viewportFour:"视口四",earthShow:"地球",timeline:"时间轴",atomsphereRender:"大气渲染",sunShow:"太阳",fogEffect:"雾化效果",depthAgainst:"深度检测",shadowMap:"阴影",underground:"开启地下",frameRate:"显示帧率",cloud:"云层",skyBox:"天空盒",rain:"雨",snow:"雪",viewMode:"视图模式",surfaceTransparency:"地表透明度",rollerMode:"卷帘模式",lrRoller:"左右卷帘",tbRoller:"上下卷帘",customRoller:"自定义卷帘",useRoller:"使用卷帘",shieldLeft:"屏蔽左侧",shieldRight:"屏蔽右侧",shieldTop:"屏蔽上侧",shieldBottom:"屏蔽下侧",videoUrl:"视频路径",fileType:"在线或本地文件",horizontal:"水平视角",vertical:"垂直视角",projectDistance:"投放距离",clipMode:"裁剪模式",clipInside:"裁剪内部",clipOutside:"裁剪外部",visibleLine:"显示投放线和模型",projection:"投放",clip:"裁剪",planeDirection:"平面方向",verticalGround:"竖直方向",parallelGround:"水平方向",lightColor:"光源颜色",cutoffDistance:"扩散距离",lightDecay:"衰减因子",lightIntensity:"光源强度",spotLightAngle:"聚光范围",lightModel:"光源模型",lightPositions:"光源坐标",multiViewport:"分屏显示",onePort:"不使用分屏",horizontalSnap:"水平分屏",verticalSnap:"垂直分屏",tripeSnap:"三视口",quadSnap:"四视口",flatten:"压平",facadeDistance:"立面图距离",facadeHeight:"立面图高度",setLodrange:"设置模型精细度",selectedLayer:"选择图层",noLayer:"暂无图层",lodrange:"缩放系数",setRegion:"指定范围",execute:"立面出图",fullScreen:"全屏",compass:"罗盘",zoomIn:"放大",zoomOut:"缩小",reset:"重置",operationType:"操作类型",stretch_cut:"拉伸与剖切",drilling:"钻孔",stretchHeight:"拉伸高度",drawLine:"画线",cut:"剖切",drillRadius:"钻孔半径",drillHeight:"钻孔深度",drawClip:"绘制裁剪",boxClip:"Box裁剪",foreColor:"前景色",lineColor:"线颜色",selectedColor:"选中色",selectColorMode:"选中色模式",mix:"混合",replace:"替换",bottomAltitude:"底部高层",layerTrans:"图层透明度",fillStyle:"填充风格",fillMode:"填充模式",lineMode:"线框模式",fillAndLine:"填充和线框模式",visibleDistanceMin:"最小可见距离",visibleDistanceMax:"最大可见距离",noS3mLayer:"暂无s3m图层",selectedPbr:"选择材质",selectedoffset:"选中偏移",offsetX:"沿X轴偏移",offsetY:"沿Y轴偏移",offsetZ:"沿Z轴偏移",polygonOffset:"多边形偏移",polygonOffsetFactor:"偏移因子",polygonOffsetUnit:"偏移量",brightness:"亮度",contrast:"对比度",hue:"色调",saturation:"饱和度",gamma:"伽马",closeShadow:"关闭阴影",openShadow:"开启阴影",shadowDarkness:"阴影明暗度",selectEnabled:"是否可选",multiChoose:"多选",cullEnabled:"双面渲染",visibility:"可见性",onlyShowSlection:"仅选中对象可见",onlyHideSlection:"仅选中对象隐藏",showAll:"显示全部",noImgLayer:"暂无影像图层",alpha:"透明度",transparentColor:"透明色",transparentColorTolerance:"透明色容限",designatedRoute:"指定路线",customRoute:"自定义路线",routeType:"路线选择",selectFlyRouteFile:"选择飞行线路文件",selectStop:"站点选择",showRoute:"显示路线",showStop:"显示站点",pause:"暂停",stop:"结束",start:"开始",flySpeed:"飞行速度",addedStops:"已添站点",save:"保存",customRouteOperating:"自定义路线操作",downLoad:"下载",polyline:"绘制线",polygon:"绘制面",drawModle:"绘制模式",space:"空间模式",stick:"贴地模式",postObject:"贴对象模式"},"lineColor","线颜色"),c(b,"lineWidth","线宽度"),c(b,"dottedColor","间隔颜色"),c(b,"dottedLength","分量长度"),c(b,"outLineColor","轮廓颜色"),c(b,"outLineWidth","轮廓宽度"),c(b,"glowStrength","光晕强度"),c(b,"trailPercentage","尾迹占比"),c(b,"polygonColor","面颜色"),c(b,"gridWidth","网格线宽"),c(b,"gridCount","网格线数"),c(b,"gridCellAlpha","单元透明度"),c(b,"stripeEvenColor","偶数带颜色"),c(b,"stripeOddColor","基数带颜色"),c(b,"stripeRepeat","带条重复数"),c(b,"stripeOffset","带条偏移量"),c(b,"downstripeOrientationLoad","带条水平方向"),c(b,"stripeOrientation","带条垂直方向"),c(b,"draw","绘制"),c(b,"symbolType","符号类型"),c(b,"symbolColor","符号颜色"),c(b,"addType","添加模式"),c(b,"singleAdd","单个添加"),c(b,"lineAdd","沿线添加"),c(b,"faceAdd","区域添加"),c(b,"spacing","间距"),c(b,"number","数量"),c(b,"Xrotation","绕X轴旋转（°）"),c(b,"Yrotation","绕Y轴旋转（°）"),c(b,"Zrotation","绕Z轴旋转（°）"),c(b,"ClipWidth","裁剪宽度（米）"),c(b,"ClipHeight","裁剪高度（米）"),c(b,"displayVisualsBody","显示可视体"),c(b,"displayInvisibleBody","显示不可视体"),c(b,"viewshedAnimation","动态可视域"),c(b,"addheight","附加高度"),c(b,"verticalFov","垂直视角"),c(b,"horizontalFov","水平视角"),c(b,"hintLineColor","提示线颜色"),c(b,"visibleAreaColor","可视区颜色"),c(b,"hiddenAreaColor","不可视颜色"),c(b,"visibleBodyColor","可视域体颜色"),c(b,"invisibleBodyColor","不可视体颜色"),c(b,"polylineShow","线显示"),c(b,"polygonShow","面显示"),c(b,"bodyShow","体显示"),c(b,"graphDisplay","二维显示"),c(b,"limitBody","限高体"),c(b,"skylineRadius","分析半径"),c(b,"skylineColor","天际线颜色"),c(b,"skyBodyColor","天际体颜色"),c(b,"barrierColor","障碍物颜色"),c(b,"highlightBarrier","高亮障碍物"),c(b,"ignoreGlobe","地表不参与分析"),c(b,"visibleColor","可视区颜色"),c(b,"hiddenColor","不可视颜色"),c(b,"showBarrierPoints","显示障碍点"),c(b,"title1","播放一天时间段内阳光和阴影动画"),c(b,"title2","播放一年的阳光和阴影动画"),c(b,"title0","停止动画"),c(b,"daylightFilter","采光率过滤"),c(b,"shadowShow","显示阴影"),c(b,"profileInformation","剖面信息"),c(b,"observeRadius","观察半径"),c(b,"allShow","全部显示"),c(b,"visibleShow","可视部分"),c(b,"hiddenShow","不可视部分"),c(b,"selectMode","模式选择"),c(b,"measureSpace","空间量算"),c(b,"measureGround","贴地量算"),c(b,"planeProjection","平面投影"),c(b,"measureDistance","测距"),c(b,"measureHeight","测高"),c(b,"measureSurface","测面"),c(b,"showContour","显示等高线"),c(b,"startAngle","开始角度"),c(b,"endAngle","终止角度"),c(b,"isClosed","是否封口"),c(b,"fire","火焰"),c(b,"water","水滴"),c(b,"fireworks","烟花"),c(b,"displayEdit","显示编辑框"),c(b,"parameterSet","参数设置"),c(b,"emitSpeed","发射速度"),c(b,"lifeCycle","生命周期"),c(b,"speedRange","速度范围"),c(b,"scaleRange","比例范围"),c(b,"emitType","发射类型"),c(b,"particleNumber","发射数量"),c(b,"particleSize","粒子大小"),c(b,"gravity","重力"),c(b,"coneEmit","圆锥体放射"),c(b,"sphereEmit","球体放射"),c(b,"boxEmit","盒状放射"),c(b,"addParticle","添加"),c(b,"clearParticle","清除"),b);function U(e,t){var o=[];try{e&&e.forEach((function(e){o.push(viewer.scene.addS3MTilesLayerByScp(e.url,e.options))})),O(o,t,"S3M")}catch(e){var i=viewer.SuperMap3DWidget;if(i._showRenderLoopErrors){i.showErrorPanel("渲染时发生错误，已停止渲染。",void 0,e)}}}function _(e,t,o){t&&t.SceneToken&&(SuperMap3D.Credential.CREDENTIAL=new SuperMap3D.Credential(t.SceneToken));var i=!0;if(t&&t.autoSetView&&(i=t.autoSetView),function(e){if(null===e||""===e)return!1;if('"'==e.charAt(0)||"'"==e.charAt(0)){var t=/^['|"](.*)['|"]$/;e=e.replace(t,"$1")}return!0}(e))try{O([viewer.scene.open(e,void 0,{autoSetView:i})],o,"SCENE")}catch(e){var n=viewer.SuperMap3DWidget;if(n._showRenderLoopErrors){n.showErrorPanel("渲染时发生错误，已停止渲染。",void 0,e)}}}function O(e,t,n){SuperMap3D.when.all(e,(function(e){console.log("layers:",e),i.layers=viewer.scene.layers.layerQueue,o.setChangeLayers(),t(e[0],n),i.layers.forEach((function(e){(!e.visibleDistanceMax||e.visibleDistanceMax>12e3)&&(e.visibleDistanceMax=12e3)}))}),(function(e){var t=viewer.SuperMap3DWidget;if(t._showRenderLoopErrors){t.showErrorPanel("请检查url地址是否正确？",void 0,e)}}))}var H={addS3mLayers:U,addScene:_,addTerrainLayer:function(e,t){try{viewer.terrainProvider=new SuperMap3D.SuperMap3DTerrainProvider({url:e,isSct:t})}catch(e){var o=viewer.SuperMap3DWidget;if(o._showRenderLoopErrors){o.showErrorPanel("渲染时发生错误，已停止渲染。",void 0,e)}}},addImageLayer:function(e){try{return viewer.imageryLayers.addImageryProvider(new SuperMap3D.SuperMapImageryProvider({url:e}))}catch(e){var t=viewer.SuperMap3DWidget;if(t._showRenderLoopErrors){t.showErrorPanel("渲染时发生错误，已停止渲染。",void 0,e)}}},layersDelete:function(e,t,i){switch(e){case"S3M":viewer.scene.layers.remove(t),o.setChangeLayers(),i();break;case"IMG":var n;if("nunber"==typeof t)n=viewer.imageryLayers.get(t);else for(var r=viewer.imageryLayers._layers,a=0;a<r.length;a++)r[a].imageryProvider.tablename&&r[a].imageryProvider.tablename===t&&(n=r[a]);n&&(viewer.imageryLayers.remove(n),o.setChangeLayers(),i());break;case"TERRAIN":viewer.terrainProvider=new SuperMap3D.EllipsoidTerrainProvider,o.setChangeLayers(),i();break;case"MVT":viewer.scene.removeVectorTilesMap(t),o.setChangeLayers(),i()}},addMvtLayer:function(e,t,i){try{var n=viewer.scene.addVectorTilesMap({url:e,canvasWidth:512,name:t||"mvt",viewer:viewer});return SuperMap3D.when(n.readyPromise,(function(e){var t=n.rectangle;viewer.scene.camera.flyTo({destination:new SuperMap3D.Cartesian3.fromRadians(.5*(t.east+t.west),.5*(t.north+t.south),1e4),duration:0,orientation:{heading:0,roll:0}}),o.setChangeLayers(),i(n)})),n}catch(e){var r=viewer.SuperMap3DWidget;if(r._showRenderLoopErrors){r.showErrorPanel("渲染时发生错误，已停止渲染。",void 0,e)}}}};function z(){}Object.assign(z.prototype,{addEventListener:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];void 0===this._listeners&&(this._listeners={}),this._mutex=this._mutex||{};var i=this._mutex,n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&(o&&(i[e]=t),n[e].push(t))},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var o=this._listeners;return void 0!==o[e]&&-1!==o[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var o=this._listeners[e];if(this._mutex[e]===t&&(this._mutex[e]=null),void 0!==o){var i=o.indexOf(t);-1!==i&&o.splice(i,1)}}},dispatchEvent:function(e){var t=this;if(void 0!==this._listeners){var o=this._listeners[e.type];if(void 0!==o){e.target=this;var i=o.slice(0);if(this._mutex[e.type])return void i.find((function(o){return o===t._mutex[e.type]})).call(this,e);for(var n=0,r=i.length;n<r;n++)i[n].call(this,e)}}},removeAllListener:function(){for(var e in this._mutex={},this._listeners)this._listeners[e]=[]}});var G="CLICK",j="LEFT_DOWN",W="LEFT_UP",K="MOUSE_MOVE",Q="RIGHT_CLICK",X="LEFT_DOWN_MOUSE_MOVE",Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,e);var t=y(o);function o(e){var i;return a(this,o),(i=t.call(this)).viewer=e,i.handler=new SuperMap3D.ScreenSpaceEventHandler(i.viewer.scene.canvas),i.handler.setInputAction((function(e){i.dispatchEvent({type:G,message:e})}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK),i.handler.setInputAction((function(e){i.press=!0,i.dispatchEvent({type:j,message:e})}),SuperMap3D.ScreenSpaceEventType.LEFT_DOWN),i.handler.setInputAction((function(e){i.press=!1,i.dispatchEvent({type:W,message:e})}),SuperMap3D.ScreenSpaceEventType.LEFT_UP),i.handler.setInputAction((function(e){i.dispatchEvent({type:Q,message:e})}),SuperMap3D.ScreenSpaceEventType.RIGHT_CLICK),i.handler.setInputAction((function(e){i.press&&i.dispatchEvent({type:X,message:e}),i.dispatchEvent({type:K,message:e})}),SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),i}return s(o,[{key:"addCameraMoveListener",value:function(e){this.viewer.camera.changed.addEventListener(e)}},{key:"removeCameraMoveListener",value:function(e){this.viewer.camera.changed.removeEventListener(e)}}]),o}(z);function Z(e){var t=function(e){var t=document.createElement("DIV");t.className="tooltip",this._div=t,this.message="",e.appendChild(t)};return t.prototype.setVisible=function(e){this._div.style.right=e?"10px":"-300px"},t.prototype.showAt=function(e,t){t&&(this._div.style.top=t),e&&(this.setVisible(!0),this._div.innerHTML=e)},new t(e)}var q,J,$={showRenderLoopErrors:"渲染时发生错误，已停止渲染。",AttributeError:"该组件props没有这个属性：",NoPickPositionSupported:"不支持深度纹理,无法绘制多边形，地形操作功能无法使用！",NoTerrain:"请在地形里使用地形组件！",initViewerWarn:"请先初始化viewer!",MoveMouseHeightBox:"点击鼠标左键结束矩形绘制，移动鼠标绘制box高度",RightClickEndDrawing:"右键单击结束绘制",LeftClickBottomBox:"点击鼠标左键，开始绘制矩形作为box底面",ClickModelAddBox:"点击模型，添加裁剪盒子",SkyLineWarn:"获取天际线体前，请先绘制天际线！",SkyLineBody:"天际线体",ShadowqueryWarn:"此操作需要先开启阴影！",VeiwshedBody:"可视体",VeiwshedBodyHidden:"不可视体",EchartsErr:"二维显示需要echarts支持，未找到相关依赖！",BaseMapImg:"底图",tip1:"<p>点击左键确定操作区域中间点</p><p>右键单击结束绘制</p>"},ee=(J=(navigator.language||navigator.browserLanguage).toLowerCase(),window.lang=J,J).toLowerCase();var te=((q=void 0!==ee?ee:(navigator.language||navigator.browserLanguage).toLowerCase()).startsWith("zh")||q.startsWith("ja"),$);var oe={name:"Sm3dViewer",props:{sceneUrl:{type:String},s3mScps:{type:Array},afterInitviewer:{type:Function},openingAnimation:{type:Boolean}},setup:function(t){e.onMounted((function(){!function(t,i){var n;if(window.viewer&&(window.viewer=null),window.isPCBroswer=SuperMap3D.FeatureDetection.isPCBroswer())n=new SuperMap3D.Viewer("SuperMap3DContainer",{timeline:!0,baseLayerPicker:!1,imageryProvider:!1,navigation:!1,animation:!1,infoBox:!1,contextOptions:{msaaLevel:8,requestWebgl2:!0},shadows:!1,pcss:!0,shadowQuality:0,creditContainer:document.createElement("div")}),document.getElementsByClassName("supermap3d-viewer-timelineContainer")[0].style.visibility="hidden";else{var r=(n=new SuperMap3D.Viewer("SuperMap3DContainer",{selectionIndicator:!1,infoBox:!1,skyBox:!1,navigation:!1,contextOptions:{requestWebgl2:!0}})).scene;SuperMap3D.defined(r.sun)&&(r.globe.enableLighting=!1),SuperMap3D.defined(r.moon)&&(r.moon.show=!1),document.documentElement.style.height=window.innerHeight+"px",document.addEventListener("touchmove",(function(e){e.preventDefault()}),!1)}n.scene.debugShowFramesPerSecond=!0,n.scene.globe.baseColor=SuperMap3D.Color.BLACK,window.viewer=n,window.scene=n.scene,scene.moon.show=!1,n.eventManager=new Y(n);var a=n.SuperMap3DWidget;o.setIsViewer(!0),n.geocoder&&(n.geocoder.viewModel.geoKey="fvV2osxwuZWlY0wJb8FEb2i5"),window.tooltip||(window.tooltip=Z(n._element));try{t&&t.openingAnimation&&n.camera.flyTo({destination:new SuperMap3D.Cartesian3(6788287.844465209,-41980756.10214644,29619220.04004376),duration:0,complete:function(){n.camera.flyTo({destination:new SuperMap3D.Cartesian3.fromDegrees(110.60396458865515,34.54408834959379,30644793.325518917),duration:5})}}),t&&t.afterInitviewer&&t.afterInitviewer(),t&&t.sceneUrl&&_(t.sceneUrl,{},(function(e){})),t&&t.s3mScps&&U(t.s3mScps)}catch(e){if(a._showRenderLoopErrors){var l=te.showRenderLoopErrors;a.showErrorPanel(l,void 0,e)}}e.onBeforeUnmount((function(){n.destroy(),window.viewer=void 0,window.scene=void 0}))}(t)}))}},ie={id:"SuperMap3DContainer",ref:"viewer"};oe.render=function(t,o,i,n,r,a){return e.openBlock(),e.createBlock("div",ie,[e.renderSlot(t.$slots,"default")],512)},oe.__file="src/components/viewer/viewer.vue",oe.install=function(e){e.component(oe.name,oe)};var ne=function(e,t){if(!e||!t)return!0;var o=!0;if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var i in e)if("object"==r(e[i])){if(!(o=isSame(e[i],t[i])))break}else if(e[i]!=t[i]){o=!1;break}return o},re=function(e){for(var t=[].concat(e),o=[],i=0,n=t.length;i<n;i++){var r=SuperMap3D.Cartographic.fromCartesian(t[i]),a=SuperMap3D.Math.toDegrees(r.longitude),l=SuperMap3D.Math.toDegrees(r.latitude),s=r.height;-1==o.indexOf(a)&&-1==o.indexOf(l)&&(o.push(a),o.push(l),o.push(s))}return o};var ae={Message:{errorMsg:function(e){console.log("error",e),alert("error："+e)},warnMsg:function(e){console.log("warn",e)},successMsg:function(e){console.log("success",e)}},axiosJsonp:function(e){if(e)return new Promise((function(t,o){window.jsonCallBack=function(e){t(e)};var i=document.createElement("script");i.type="text/javascript",i.src="".concat(e,"&callback=jsonCallBack"),document.getElementsByTagName("head")[0].appendChild(i),setTimeout((function(){document.getElementsByTagName("head")[0].removeChild(i)}),500)}));console.error("Axios.JSONP 至少需要一个url参数!")},isEqualArr:ne,CartesiantoDegrees:re,CartesiantoDegreesObjs:function(e){for(var t=[].concat(e),o=[],i=0,n=t.length;i<n;i++){var r=SuperMap3D.Cartographic.fromCartesian(t[i]),a={longitude:SuperMap3D.Math.toDegrees(r.longitude),latitude:SuperMap3D.Math.toDegrees(r.latitude),height:r.height};o.push(a)}return o},unique:function(e){for(var t=[],o={},i=0;i<e.length;i++)o[e[i]]||(t.push(e[i]),o[e[i]]=1);return t},gradientColors:function(e,t,o,i){var n,r,a,l,s=[],c=[];i=i||1;var d,u=function(e){return Math.pow(e/255,i)};for(e=p(e).map(u),t=p(t).map(u),n=0;n<o;n++){for(l=1-(a=n/(o-1)),r=0;r<3;r++)c[r]=1===(d=Math.round(255*Math.pow(e[r]*l+t[r]*a,1/i)).toString(16)).length?"0"+d:d;s.push("#"+c.join(""))}return s;function p(e){return 4===e.length?e.substr(1).split("").map((function(e){return 17*parseInt(e,16)})):[e.substr(1,2),e.substr(3,2),e.substr(5,2)].map((function(e){return parseInt(e,16)}))}},getAngleAndRadian:function(e,t){var o=SuperMap3D.Transforms.eastNorthUpToFixedFrame(e),i=SuperMap3D.Cartesian3.subtract(t,e,new SuperMap3D.Cartesian3),n=SuperMap3D.Matrix4.multiplyByPointAsVector(SuperMap3D.Matrix4.inverse(o,new SuperMap3D.Matrix4),i,new SuperMap3D.Cartesian3),r=SuperMap3D.Cartesian3.normalize(n,new SuperMap3D.Cartesian3),a=Math.atan2(r.y,r.x)-SuperMap3D.Math.PI_OVER_TWO,l=SuperMap3D.Math.TWO_PI-SuperMap3D.Math.zeroToTwoPi(a),s=l*(180/Math.PI);return s<0&&(s+=360),{angle:s,radian:l}},CartographictoDegrees:function(e){return[SuperMap3D.Math.toDegrees(e.longitude),SuperMap3D.Math.toDegrees(e.latitude),e.height]},getPitch:function(e,t){var o=SuperMap3D.Transforms.eastNorthUpToFixedFrame(e),i=SuperMap3D.Cartesian3.subtract(t,e,new SuperMap3D.Cartesian3),n=SuperMap3D.Matrix4.multiplyByPointAsVector(SuperMap3D.Matrix4.inverse(o,o),i,i);SuperMap3D.Cartesian3.normalize(n,n);var r=SuperMap3D.Math.PI_OVER_TWO-SuperMap3D.Math.acosClamped(n.z),a=r*(180/Math.PI);return a<0&&(a+=360),{angle:a,radian:r}}},le=function(e,t){var o=0;switch(t&&(o=t),e){case"Point":window.handlerPoint=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Point);break;case"Polyline":window.handlerPolyline=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Line,o);break;case"Polygon":window.handlerPolygon=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Polygon,o);break;case"Marker":window.handlerMarker=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Marker,o);break;case"Box":window.handlerBox=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Box,o)}window.tooltip||(window.tooltip=function(e){var t=function(e){var t=document.createElement("DIV");t.className="twipsy right";var o=document.createElement("DIV");o.className="twipsy-arrow",t.appendChild(o);var i=document.createElement("DIV");i.className="twipsy-inner",t.appendChild(i),this._div=t,this._title=i,this.message="",e.appendChild(t);var n=this;t.onmousemove=function(e){n.showAt({x:e.clientX,y:e.clientY},n.message)}};return t.prototype.setVisible=function(e){this._div.style.display=e?"block":"none"},t.prototype.showAt=function(e,t){e&&t&&(this.setVisible(!0),this._title.innerHTML=t,this._div.style.left=e.x+10+"px",this._div.style.top=e.y-this._div.clientHeight/2+"px",this.message=t)},new t(e)}(viewer._element)),window.polylineCollection||(window.polylineCollection=new SuperMap3D.PolylineCollection({translucentRS:SuperMap3D.RenderState.fromCache({depthMask:!1,depthTest:{enabled:!1}})}),window.polylineTransparent=window.polylineCollection.add({width:2,material:SuperMap3D.Material.fromType(SuperMap3D.Material.ColorType,{color:SuperMap3D.Color.fromCssColorString("#51ff00").withAlpha(.3)})}),viewer.scene.primitives.add(window.polylineCollection))},se=function(e,t,o){var i=!0;!1===t&&(i=t);var n=de(e);return new Promise((function(t,o){var r=window.tooltip,a=n.activeEvt.addEventListener((function(t){1==t?(viewer.enableCursorStyle=!1,viewer._element.style.cursor="","Point"==e||"Marker"==e?document.body.classList.add("measureCur"):document.body.classList.add("drawCur")):(viewer.enableCursorStyle=!0,r.setVisible(!1),"Point"==e||"Marker"==e?document.body.classList.remove("measureCur"):document.body.classList.remove("drawCur"))})),l=n.movingEvt.addEventListener((function(t){if(t.x<200&&t.y<150)r.setVisible(!1);else if(n.polyline&&n.isDrawing){var o=f(n.positions);"Polygon"==e&&o.push(o[0]),window.polylineTransparent.show=!0,window.polylineTransparent.positions=o}})),s=n.drawEvt.addEventListener((function(o){if(!o.object.positions&&"Point"!=e&&"Box"!=e)return r.showAt(o,"<p>请绘制正确的多边形</p>"),n.polygon.show=!1,n.polyline.show=!1,n.deactivate(),void n.activate();if("Box"!=e){if("Point"==e||"Marker"==e)n.clear(),t({result:o});else{if(window.polylineTransparent.show=i,i&&"Polygon"==e&&i){n.polygon._polygon._material._color._value.alpha=.1;var c=f(o.object.positions);c.push(c[0]),window.polylineTransparent.positions=c}var d=re(o.object.positions);t({result:o,positions:d})}a(),l(),s()}else t({result:o})}))}))},ce=function(e){var t;(t=e?de(e):window.handlerPolygon)&&(t.deactivate(),t.clear(),viewer.enableCursorStyle=!0,window.tooltip.setVisible(!1),window.polylineTransparent&&(window.polylineTransparent.show=!1))},de=function(e){var t;switch(e){case"Point":t=window.handlerPoint;break;case"Polyline":t=window.handlerPolyline;break;case"Polygon":t=window.handlerPolygon;break;case"Marker":t=window.handlerMarker;break;case"Box":t=window.handlerBox}return t},ue=le,pe=se,me=ce,he=function(e,t,o){window.selectHandler||(window.selectHandler=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas));var i=window.selectHandler;window.handlerPolygon&&window.handlerPolygon.polygon&&(window.handlerPolygon.polygon.show=!0),i.setInputAction((function(){console.log("viewer.selectedEntity:",viewer.selectedEntity);var n=viewer.selectedEntity,r=window.editHandler;n&&(r&&r&&r.clear(),r?(r.deactivate(),r.setEditObject(n),r.activate()):(window.editHandler=new SuperMap3D.EditHandler(viewer,n),window.editHandler.isEditZ=t||!1,window.editHandler.activate()),i.setInputAction((function(){if(n=viewer.selectedEntity,r=window.editHandler,n&&r&&r._positions){var t=re(r._positions);if(ne(e,t))return;if(e=t,o&&o(t,window.editHandler),window.handlerPolygon&&window.handlerPolygon.polygon&&window.handlerPolygon.polygon.show){var i=f(r._positions);i.push(i[0]),window.polylineTransparent.positions=i}}}),SuperMap3D.ScreenSpaceEventType.LEFT_UP))}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)},ye=function(){window.editHandler&&(window.editHandler.deactivate(),window.editHandler.clear()),window.selectHandler&&(window.selectHandler.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_UP),window.selectHandler.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK),window.selectHandler.destroy(),window.selectHandler=null)};var fe={name:"Sm3dTerrainOperation",props:{digDepth:{type:Number,default:500},digPositions:{type:Array},modifyPositions:{type:Array},isEdit:{type:Boolean,default:!1},isEditZ:{type:Boolean,default:!1},lineVisible:{type:Boolean,default:!0}},setup:function(t){var o=function(t){var o=e.reactive({digDepth:500,isEdit:!1,isEditZ:!1,lineVisible:!0,digPositions:[],modifyPositions:[],operationType:"dig",terrainVisible:"terrainVisible"});if(t)for(var i in t)o.hasOwnProperty(i)?o[i]=t[i]:ae.Message.errorMsg(te.AttributeError+i);var n=[],r=[],a="dig";function l(e){e&&(n=e),viewer.scene.globe.removeAllExcavationRegion(),viewer.scene.globe.addExcavationRegion({name:"dig_terrain",position:n,height:o.digDepth,transparent:!1})}function s(e){e&&(r=e),viewer.scene.globe.removeAllModifyRegion(),viewer.scene.globe.addModifyRegion({name:"ggg",position:r})}return t&&t.digPositions&&l(t.digPositions),e.watch((function(){return o.digDepth}),(function(e){0!=n.length&&l()})),e.watch((function(){return o.isEdit}),(function(e){e&&window.handlerPolygon?"dig"===a?he(n,o.isEditZ,l):he(r,o.isEditZ,s):(ye(),window.handlerPolygon&&window.handlerPolygon.polygon&&(window.handlerPolygon.polygon.show=!1))})),e.watch((function(){return o.isEditZ}),(function(e){window.editHandler&&(window.editHandler.isEditZ=e)})),e.watch((function(){return o.terrainVisible}),(function(e){switch(e){case"terrainVisible":viewer.terrainProvider._visible=!0;break;case"terrainUnvisible":viewer.terrainProvider._visible=!1}})),u(u({},e.toRefs(o)),{},{digTerrain:function(e){o.isEdit=!1,e.preventDefault(),a="dig",window.handlerPolygon||le("Polygon"),se("Polygon",o.lineVisible).then((function(e){n=e.positions;var t=window.handlerPolygon;l(e.positions),t.polygon.show=!1,t.polyline.show=!1,t.deactivate(),o.isEdit&&he(n,o.isEditZ,l)}),(function(e){console.log(e)})),window.handlerPolygon.activate(),viewer.scene.pickPositionSupported||ae.Message.errorMsg(te.NoPickPositionSupported)},clearDig:function(e){e.preventDefault(),n=[],o.isEdit=!1,window.handlerPolygon&&(viewer.scene.globe.removeAllExcavationRegion(),ce("Polygon"),ye())},modifyTerrain:function(e){e.preventDefault(),a="modify",window.handlerPolygon||le("Polygon"),se("Polygon",o.lineVisible).then((function(e){r=e.positions;var t=window.handlerPolygon;s(e.positions),t.polygon.show=!1,t.polyline.show=!1,o.isEdit&&he(r,o.isEditZ,s)}),(function(e){console.log(e)})),window.handlerPolygon.activate(),viewer.scene.pickPositionSupported||alert("不支持深度纹理,无法绘制多边形，地形修改功能无法使用！")},clearModify:function(e){e.preventDefault(),window.handlerPolygon&&(viewer.scene.globe.removeAllModifyRegion(),ce("Polygon"),ye())},digPosition:n,modifyPosition:r})}(t);return{digDepth:o.digDepth,isEdit:o.isEdit,isEditZ:o.isEditZ,terrainVisible:o.terrainVisible,digTerrain:o.digTerrain,clearDig:o.clearDig,modifyTerrain:o.modifyTerrain,clearModify:o.clearModify,operationType:o.operationType}}},ve={id:"terrain-operation-panel",class:"sm-panel"},we={class:"sm-function-module-sub-section",style:{margin:"0"}},ge={class:"sm-half-L"},be={style:{width:"auto"}},Se={style:{width:"auto"}},Ve={class:"sm-half-L"},De={style:{width:"35%"}},Ne={class:"sm-half-L"},Ce={style:{width:"auto"}},Me={style:{width:"auto"}},xe={class:"boxchild"},Re={class:"boxchild"};fe.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",ve,[e.withDirectives(e.createVNode("div",we,[e.createVNode("div",ge,[e.createVNode("label",be,[e.withDirectives(e.createVNode("input",{type:"radio",value:"dig","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.operationType=e})},null,512),[[e.vModelRadio,n.operationType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.terrainExcavation),1)]),e.createVNode("label",Se,[e.withDirectives(e.createVNode("input",{type:"radio",value:"modify","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.operationType=e})},null,512),[[e.vModelRadio,n.operationType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.terrainModify),1)])]),e.withDirectives(e.createVNode("div",Ve,[e.createVNode("label",De,e.toDisplayString(t.Resource.terrainExcavationDepth),1),e.withDirectives(e.createVNode("input",{class:"sm-input",style:{width:"43%"},type:"number",min:"0","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.digDepth=e})},null,512),[[e.vModelText,n.digDepth]])],512),[[e.vShow,"dig"===n.operationType]]),e.createVNode("div",Ne,[e.createVNode("label",Ce,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.isEdit=e})},null,512),[[e.vModelCheckbox,n.isEdit]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.isEdit),1)]),e.withDirectives(e.createVNode("label",Me,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.isEditZ=e})},null,512),[[e.vModelCheckbox,n.isEditZ]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.isEditZ),1)],512),[[e.vShow,"modify"===n.operationType]])]),e.withDirectives(e.createVNode("div",xe,[e.createVNode("button",{onClick:o[6]||(o[6]=function(){return n.modifyTerrain&&n.modifyTerrain.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.modify),1),e.createVNode("button",{onClick:o[7]||(o[7]=function(){return n.clearModify&&n.clearModify.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)],512),[[e.vShow,"modify"===n.operationType]]),e.withDirectives(e.createVNode("div",Re,[e.createVNode("button",{onClick:o[8]||(o[8]=function(){return n.digTerrain&&n.digTerrain.apply(n,arguments)}),onTouchstart:o[9]||(o[9]=function(){return n.digTerrain&&n.digTerrain.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.excavation),33),e.createVNode("button",{onClick:o[10]||(o[10]=function(){return n.clearDig&&n.clearDig.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)],512),[[e.vShow,"dig"===n.operationType]])],512),[[l]])],512)),[[s]])},fe.__file="src/components/terrain-analysis/terrain-operation/terrain-operation.vue",fe.install=function(e){e.component(fe.name,fe)};var ke={name:"Sm3dTerrainSlope",props:{analysisArea:{type:String},displayMode:{type:String},wideMaxR:{type:Number},wideMinR:{type:Number},trans:{type:Number},isEdit:{type:Boolean,default:!1},slopePositions:{type:Array},lineVisible:{type:Boolean,default:!0}},methods:{formatTooltip:function(e){return Resource.slope+e+"°"}},setup:function(o){var i=function(o){var i=e.reactive({analysisArea:"ARM_REGION",displayMode:"FACE_AND_ARROW",wideMaxR:90,wideMinR:0,slopeInterval:[0,90],trans:.8,isEdit:!1,slopePositions:[],lineVisible:!0});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r=!0,a=new SuperMap3D.SlopeSetting,l=SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode[i.analysisArea],s=SuperMap3D.SlopeSettingEnum.DisplayMode[i.displayMode],c=new SuperMap3D.ColorTable,d=[];function p(e){e&&(d=e),a.CoverageArea=e,viewer.scene.globe.SlopeSetting={slopeSetting:a,analysisMode:l}}return c.insert(80,new SuperMap3D.Color(1,0,0)),c.insert(50,new SuperMap3D.Color(221/255,224/255,7/255)),c.insert(30,new SuperMap3D.Color(20/255,187/255,18/255)),c.insert(20,new SuperMap3D.Color(0,161/255,1)),c.insert(0,new SuperMap3D.Color(9/255,9/255,1)),o&&o.slopePositions&&p(o.slopePositions),t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element))),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)))})),e.watch((function(){return i.analysisArea}),(function(e){switch(e){case"ARM_REGION":l=SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION;break;case"ARM_ALL":l=SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_ALL;break;case"ARM_NONE":l=SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_NONE}0!=d.length&&p(d)})),e.watch((function(){return i.wideMaxR}),(function(e){a.MaxVisibleValue=parseFloat(e),0!=d.length&&(viewer.scene.globe.SlopeSetting={slopeSetting:a,analysisMode:l})})),e.watch((function(){return i.wideMinR}),(function(e){a.MinVisibleValue=parseFloat(e),0!=d.length&&(viewer.scene.globe.SlopeSetting={slopeSetting:a,analysisMode:l})})),e.watch((function(){return i.slopeInterval}),(function(e){i.wideMinR=e[0],i.wideMaxR=e[1]})),e.watch((function(){return i.displayMode}),(function(e){switch(e){case"FACE":s=SuperMap3D.SlopeSettingEnum.DisplayMode.FACE;break;case"ARROW":s=SuperMap3D.SlopeSettingEnum.DisplayMode.ARROW;break;case"FACE_AND_ARROW":s=SuperMap3D.SlopeSettingEnum.DisplayMode.FACE_AND_ARROW}a.DisplayMode=s,0!=d.length&&p(d)})),e.watch((function(){return i.trans}),(function(e){a.Opacity=parseFloat(e),0!=d.length&&(viewer.scene.globe.SlopeSetting={slopeSetting:a,analysisMode:l})})),e.watch((function(){return i.isEdit}),(function(e){e&&window.handlerPolygon?he(d,!1,p):(ye(),window.handlerPolygon&&window.handlerPolygon.polygon&&(window.handlerPolygon.polygon.show=!1))})),e.onBeforeUnmount((function(){a.destroy(),c.destroy(),a=void 0,c=void 0})),u(u({},e.toRefs(i)),{},{startSlope:function(e){e.preventDefault(),tooltip.setVisible(!1),r&&(window.tooltip.showAt(" <p>点击鼠标左键绘制分析区域</p><p>点击鼠标右键结束绘制</p><p>坡度坡向分析需要带法线地形</p>","250px"),r=!1),a.DisplayMode=s,a.MaxVisibleValue=i.wideMaxR,a.MinVisibleValue=i.wideMinR,a.ColorTable=c,a.Opacity=i.trans,window.handlerPolygon||le("Polygon"),se("Polygon",i.lineVisible).then((function(e){p(d=e.positions);var t=window.handlerPolygon;t.polygon.show=!1,t.polyline.show=!1,t.deactivate(),i.isEdit&&he(d,!1,p)}),(function(e){console.log(e)})),handlerPolygon.activate(),scene.pickPositionSupported||ae.Message.errorMsg(te.NoPickPositionSupported)},clearSlope:function(e){e.preventDefault(),d=[],window.handlerPolygon&&(viewer.scene.globe.SlopeSetting={analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_NONE},tooltip.setVisible(!1),ce("Polygon"),ye())},slopePosition:d})}(o);return{analysisArea:i.analysisArea,displayMode:i.displayMode,wideMaxR:i.wideMaxR,wideMinR:i.wideMinR,trans:i.trans,isEdit:i.isEdit,slopeInterval:i.slopeInterval,startSlope:i.startSlope,clearSlope:i.clearSlope}}},Le={id:"terrain-slope-panel",class:"sm-panel"},Pe={class:"sm-function-module-sub-section",style:{margin:"0"}},Be={class:"sm-half-L"},Te={class:"label-S"},Ee={value:"ARM_REGION"},Ae={value:"ARM_ALL"},Ie={value:"ARM_NONE"},Fe={class:"sm-half-L"},Ue={style:{width:"40%"}},_e={class:"boxchild"};function Oe(t){var o=e.reactive({fillMaxHeight:9e3,fillMinHeight:0,fillHeight:[0,9e3],equivalentIsoline:100,fillOptionsSelected:"Line",lineColor:"#FF8040",isEdit:!1,isolinePositions:[],lineVisible:!0});if(t)for(var i in t)o.hasOwnProperty(i)?o[i]=t[i]:ae.Message.errorMsg(te.AttributeError+i);var n=new SuperMap3D.HypsometricSetting,r=SuperMap3D.HypsometricSettingEnum.DisplayMode.LINE,a=new SuperMap3D.ColorTable;!function(e){e.insert(5597.06640625,new SuperMap3D.Color(0,0,1)),e.insert(5406.387386067709,new SuperMap3D.Color(0,.2,1)),e.insert(5215.708365885417,new SuperMap3D.Color(0,.4,1)),e.insert(5025.029345703126,new SuperMap3D.Color(0,.6,1)),e.insert(4834.350325520834,new SuperMap3D.Color(0,.8,1)),e.insert(4643.671305338543,new SuperMap3D.Color(0,1,1)),e.insert(4452.992285156252,new SuperMap3D.Color(.2,1,.8)),e.insert(4262.313264973961,new SuperMap3D.Color(.4,1,.6)),e.insert(4071.6342447916695,new SuperMap3D.Color(.6,1,.4)),e.insert(3880.955224609378,new SuperMap3D.Color(.8,1,.2)),e.insert(3690.2762044270867,new SuperMap3D.Color(1,1,0)),e.insert(3499.5971842447952,new SuperMap3D.Color(1,.8,0)),e.insert(3308.918164062504,new SuperMap3D.Color(1,.6,0)),e.insert(3118.239143880213,new SuperMap3D.Color(1,.4,0)),e.insert(2927.5601236979214,new SuperMap3D.Color(1,.2,0)),e.insert(2736.88110351563,new SuperMap3D.Color(1,0,0))}(a);var l=[];function s(e){e&&(l=e),0!=l.length&&(e&&(n.CoverageArea=e),viewer.scene.globe.HypsometricSetting={hypsometricSetting:n,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION})}return t&&t.isolinePositions&&s(t.isolinePositions),e.watch((function(){return o.fillMaxHeight}),(function(e){n.MaxVisibleValue=parseFloat(e),0!=l.length&&s()})),e.watch((function(){return o.fillMinHeight}),(function(e){n.MinVisibleValue=parseFloat(e),0!=l.length&&s()})),e.watch((function(){return o.fillHeight}),(function(e){o.fillMinHeight=e[0],o.fillMaxHeight=e[1]})),e.watch((function(){return o.equivalentIsoline}),(function(e){n.LineInterval=parseFloat(e),0!=l.length&&s()})),e.watch((function(){return o.lineColor}),(function(e){if(e){if(n._lineColor=SuperMap3D.Color.fromCssColorString(e),0==l.length)return;s()}else console.warn("err: color is  null")})),e.watch((function(){return o.fillOptionsSelected}),(function(e){switch(e){case"None":r=void 0;break;case"Line":r=SuperMap3D.HypsometricSettingEnum.DisplayMode.LINE,n.Opacity=1;break;case"Region":r=SuperMap3D.HypsometricSettingEnum.DisplayMode.FACE,n.Opacity=.5;break;case"Line_Region":r=SuperMap3D.HypsometricSettingEnum.DisplayMode.FACE_AND_LINE,n.Opacity=.5}n.DisplayMode=r,0!=l.length&&s(l)})),e.watch((function(){return o.isEdit}),(function(e){e&&window.handlerPolygon?he(l,!1,s):(ye(),window.handlerPolygon&&window.handlerPolygon.polygon&&(window.handlerPolygon.polygon.show=!1))})),e.onBeforeUnmount((function(){n.destroy(),a.destroy(),n=void 0,a=void 0})),u(u({},e.toRefs(o)),{},{isoLineAnalysis:function(e){e.preventDefault(),n.DisplayMode=r,n._lineColor=SuperMap3D.Color.fromCssColorString(o.lineColor),n.LineInterval=parseFloat(o.equivalentIsoline),n.MaxVisibleValue=parseFloat(o.fillMaxHeight),n.MinVisibleValue=parseFloat(o.fillMinHeight),n.ColorTableMinKey=2736.88110351563,n.ColorTableMaxKey=5597.06640625,n.ColorTable=a,window.handlerPolygon||le("Polygon"),se("Polygon",o.lineVisible).then((function(e){l=e.positions;var t=window.handlerPolygon;s(l),t.polygon.show=!1,t.polyline.show=!1,t.deactivate(),o.isEdit&&he(l,!1,s)}),(function(e){console.log(e)})),window.handlerPolygon.activate(),scene.pickPositionSupported||ae.Message.errorMsg(te.NoPickPositionSupported)},clearIsoLine:function(e){e.preventDefault(),l=[],window.handlerPolygon&&(viewer.scene.globe.HypsometricSetting=void 0,n&&(n.MaxVisibleValue=-1e3),n&&(n.MinVisibleValue=-1e3),ce("Polygon"),ye())},isolinePosition:l})}ke.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Le,[e.withDirectives(e.createVNode("div",Pe,[e.createVNode("div",Be,[e.createVNode("label",Te,e.toDisplayString(t.Resource.analysisArea),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"60%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.analysisArea=e})},[e.createVNode("option",Ee,e.toDisplayString(t.Resource.specifyPolygon),1),e.createVNode("option",Ae,e.toDisplayString(t.Resource.allRegionsAnalysis),1),e.createVNode("option",Ie,e.toDisplayString(t.Resource.allRegionsNOAnalysis),1)],512),[[e.vModelSelect,n.analysisArea]])]),e.createVNode("div",Fe,[e.createVNode("label",Ue,e.toDisplayString(t.Resource.slopeRange),1),e.createVNode(l,{modelValue:n.slopeInterval,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.slopeInterval=e}),min:0,max:90,range:"",step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class","format-tooltip":a.formatTooltip,style:{width:"58%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",_e,[e.createVNode("button",{onClick:o[3]||(o[3]=function(){return n.startSlope&&n.startSlope.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.clearSlope&&n.clearSlope.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},ke.__file="src/components/terrain-analysis/terrain-slope/terrain-slope.vue",ke.install=function(e){e.component(ke.name,ke)};var He={name:"Sm3dTerrainIsoline",props:{fillMaxHeight:{type:Number},fillMinHeight:{type:Number},equivalentIsoline:{type:Number},lineColor:{type:String},fillOptionsSelected:{type:String},isEdit:{type:Boolean,default:!1},isolinePositions:{type:Array},lineVisible:{type:Boolean,default:!0}},methods:{formatTooltip:function(e){return e+Resource.meter},formatTooltip2:function(e){return e+Resource.meter_second}},setup:function(e){var t=Oe(e);return{fillMaxHeight:t.fillMaxHeight,fillMinHeight:t.fillMinHeight,fillHeight:t.fillHeight,equivalentIsoline:t.equivalentIsoline,lineColor:t.lineColor,fillOptionsSelected:t.fillOptionsSelected,isEdit:t.isEdit,isoLineAnalysis:t.isoLineAnalysis,clearIsoLine:t.clearIsoLine}}},ze={id:"terrain-isoline-panel",class:"sm-panel"},Ge={class:"sm-function-module-sub-section",style:{margin:"0"}},je={class:"sm-half-L"},We={style:{width:"40%"}},Ke={class:"sm-half-L"},Qe={style:{width:"40%"}},Xe={class:"sm-half-L"},Ye={style:{width:"40%"}},Ze={value:"Line"},qe={value:"Region"},Je={value:"Line_Region"},$e={value:"None"},et={class:"boxchild"};function tt(t){var o=e.reactive({maxHeight:9e3,minHeight:1e3,floodHeight:[1e3,9e3],currentHeight:1e3,floodTrans:.8,cheackedBand:"band1",colorBandShow:!1,floodSpeed:800,floodPositions:[],lineVisible:!0});if(t)for(var i in t)o.hasOwnProperty(i)?o[i]=t[i]:ae.Message.errorMsg(te.AttributeError+i);var n,r=SuperMap3D.HypsometricSettingEnum.DisplayMode.FACE,a=new SuperMap3D.HypsometricSetting,l=new SuperMap3D.ColorTable;l.insert(9e3,new SuperMap3D.Color(0,39/255,148/255)),l.insert(0,new SuperMap3D.Color(149/255,232/255,249/255));var s=[];function c(e){e&&(s=e);var t=parseFloat(o.minHeight);a.CoverageArea=e,n=setInterval("flood()",100),window.flood=function(){if(t<=o.maxHeight&&(o.currentHeight=parseInt(t)),t>o.maxHeight)return o.currentHeight=o.maxHeight,void clearInterval(n);a.MaxVisibleValue=t;try{viewer.scene.globe.HypsometricSetting={hypsometricSetting:a,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION}}catch(e){console.log(e),clearInterval(n)}t+=parseFloat(o.floodSpeed)/10}}return e.watch((function(){return o.floodTrans}),(function(e){a.Opacity=parseFloat(e),0!=s.length&&(viewer.scene.globe.HypsometricSetting={hypsometricSetting:a,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION})})),e.watch((function(){return o.floodHeight}),(function(e){o.minHeight=e[0],o.maxHeight=e[1]})),e.watch((function(){return o.minHeight}),(function(e){a.MinVisibleValue=parseInt(e),0!=s.length?viewer.scene.globe.HypsometricSetting={hypsometricSetting:a,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION}:o.currentHeight=parseInt(e)})),e.watch((function(){return o.maxHeight}),(function(e){a.MaxVisibleValue=parseInt(e),0!=s.length&&(viewer.scene.globe.HypsometricSetting={hypsometricSetting:a,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION})})),e.watch((function(){return o.cheackedBand}),(function(e){l=function(e){var t=new SuperMap3D.ColorTable;switch(e){case"band1":t.insert(9e3,new SuperMap3D.Color(0,39/255,148/255)),t.insert(0,new SuperMap3D.Color(149/255,232/255,249/255));break;case"band2":t.insert(9e3,new SuperMap3D.Color(162/255,251/255,194/255)),t.insert(0,new SuperMap3D.Color(1,103/255,103/255));break;case"band3":t.insert(9e3,new SuperMap3D.Color(230/255,198/255,1)),t.insert(0,new SuperMap3D.Color(157/255,0,1));break;case"band4":t.insert(9e3,new SuperMap3D.Color(210/255,15/255,15/255)),t.insert(6e3,new SuperMap3D.Color(221/255,224/255,7/255)),t.insert(5e3,new SuperMap3D.Color(20/255,187/255,18/255)),t.insert(4e3,new SuperMap3D.Color(0,161/255,1)),t.insert(0,new SuperMap3D.Color(9/255,9/255,212/255));break;case"band5":t.insert(9e3,new SuperMap3D.Color(186/255,1,229/255)),t.insert(0,new SuperMap3D.Color(26/255,185/255,156/255));break;default:t.insert(9e3,new SuperMap3D.Color(0,39/255,148/255)),t.insert(0,new SuperMap3D.Color(149/255,232/255,249/255))}return t}(e),a.ColorTable=l,0!=s.length&&n&&(viewer.scene.globe.HypsometricSetting={hypsometricSetting:a,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION})})),e.onBeforeUnmount((function(){a.destroy(),l.destroy(),a=void 0,l=void 0})),u(u({},e.toRefs(o)),{},{floodBegin:function(e){e.preventDefault(),a.DisplayMode=r,a._lineColor=new SuperMap3D.Color(1,0,0,1),a.MinVisibleValue=o.minHeight,a.MaxVisibleValue=0,a.ColorTableMinKey=1,a.ColorTableMaxKey=9e3,a.ColorTable=l,a.Opacity=o.floodTrans,a.LineInterval=200,window.handlerPolygon||ue("Polygon"),t&&t.floodPositions?c(t.floodPositions):(pe("Polygon",o.lineVisible).then((function(e){var t=window.handlerPolygon;c(e.positions),t.polygon.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate(),viewer.scene.pickPositionSupported||ae.Message.errorMsg(te.NoPickPositionSupported))},floodClear:function(e){e.preventDefault(),s=[],window.handlerPolygon&&(viewer.scene.globe.HypsometricSetting=void 0,clearInterval(n),me("Polygon"))},changeColor:function(e){o.colorBandShow=!1,o.cheackedBand=e},floodPosition:s})}He.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",ze,[e.withDirectives(e.createVNode("div",Ge,[e.createVNode("div",je,[e.createVNode("label",We,e.toDisplayString(t.Resource.visibleHeight),1),e.createVNode(l,{modelValue:n.fillHeight,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.fillHeight=e}),min:0,max:9e3,range:"",step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class","format-tooltip":a.formatTooltip,style:{width:"58%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",Ke,[e.createVNode("label",Qe,e.toDisplayString(t.Resource.isolineInterval),1),e.withDirectives(e.createVNode("input",{class:"sm-input",style:{width:"58%"},min:"0",type:"number","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.equivalentIsoline=e})},null,512),[[e.vModelText,n.equivalentIsoline]])]),e.createVNode("div",Xe,[e.createVNode("label",Ye,e.toDisplayString(t.Resource.displayMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},id:"fillOptions","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.fillOptionsSelected=e})},[e.createVNode("option",Ze,e.toDisplayString(t.Resource.contourFilling),1),e.createVNode("option",qe,e.toDisplayString(t.Resource.panelFilling),1),e.createVNode("option",Je,e.toDisplayString(t.Resource.contourPanelFilling),1),e.createVNode("option",$e,e.toDisplayString(t.Resource.noColorTable),1)],512),[[e.vModelSelect,n.fillOptionsSelected]])]),e.createVNode("div",et,[e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.isoLineAnalysis&&n.isoLineAnalysis.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{onClick:o[5]||(o[5]=function(){return n.clearIsoLine&&n.clearIsoLine.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},He.__file="src/components/terrain-analysis/terrain-isoline/terrain-isoline.vue",He.install=function(e){e.component(He.name,He)};var ot={name:"Sm3dTerrainFlood",props:{maxHeight:{type:Number,default:8e3},minHeight:{type:Number,default:1e3},cheackedBand:{type:String,default:"band1"},floodSpeed:{type:Number,default:800},floodTrans:{type:Number,default:.8},floodPositions:{type:Array},lineVisible:{type:Boolean,default:!0}},methods:{formatTooltip:function(e){return e+"米"},formatTooltip2:function(e){return e+"米/秒"}},setup:function(e){var t=tt(e);return{floodHeight:t.floodHeight,currentHeight:t.currentHeight,floodSpeed:t.floodSpeed,floodBegin:t.floodBegin,floodClear:t.floodClear}}},it={id:"terrain-flood-panel",class:"sm-panel"},nt={class:"sm-function-module-sub-section",style:{margin:"0"}},rt={class:"sm-half-L"},at={style:{width:"40%"}},lt={class:"sm-half-L"},st={style:{width:"40%"}},ct={class:"sm-half-L"},dt={style:{width:"40%"}},ut={class:"boxchild"};function pt(o){var i=e.reactive({clipModel:"ClipInside"});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r,a,l,s,c="clip_behind_all_plane";function d(){if(void 0!==l){var e=l.box.dimensions.getValue(),t=l.position.getValue(0),o=0;if(void 0!==l.orientation){var i=SuperMap3D.Matrix3.fromQuaternion(l.orientation._value,new SuperMap3D.Matrix3),n=SuperMap3D.Matrix4.fromRotationTranslation(i,SuperMap3D.Cartesian3.ZERO,new SuperMap3D.Matrix4),r=SuperMap3D.Matrix4.inverse(SuperMap3D.Transforms.eastNorthUpToFixedFrame(t),new SuperMap3D.Matrix4),a=SuperMap3D.Matrix4.multiply(r,n,new SuperMap3D.Matrix4),s=SuperMap3D.Matrix4.getMatrix3(a,new SuperMap3D.Matrix3);o=SuperMap3D.HeadingPitchRoll.fromQuaternion(SuperMap3D.Quaternion.fromRotationMatrix(s)).heading}p({dimensions:e,position:t,clipMode:c,heading:o})}}function p(e){for(var t=0,o=r.length;t<o;t++)r[t].setCustomClipBox(e)}function m(){if(a&&(a.deactivate(),tooltip.setVisible(!1)),l){var e,t=g(r);try{for(t.s();!(e=t.n()).done;){e.value.clearCustomClipBox()}}catch(e){t.e(e)}finally{t.f()}l=void 0,s.deactivate(),viewer.entities.removeAll(),a.clear()}}return t.isViewer&&(r=viewer.scene.layers.layerQueue,a=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Box),window.tooltip||(window.tooltip=Z(viewer._element))),e.watch((function(){return t.isViewer}),(function(e){e&&(r=viewer.scene.layers.layerQueue,a=new SuperMap3D.DrawHandler(viewer,SuperMap3D.DrawMode.Box),window.tooltip||(window.tooltip=Z(viewer._element)))})),e.watch((function(){return i.clipModel}),(function(e){switch(e){case"ClipInside":c="clip_behind_all_plane";break;case"ClipOutside":c="clip_behind_any_plane"}l&&d()})),e.onBeforeUnmount((function(){s&&s.destroy(),s=void 0,r=void 0,a=void 0,l=void 0})),u(u({},e.toRefs(i)),{},{BoxClipByEitor:function(){m(),s||(function(){for(var e=0,t=r.length;e<t;e++)r[e].selectEnabled=!1,r[e].clipLineColor=new SuperMap3D.Color(1,1,1,0)}(),a.movingEvt.addEventListener((function(e){a.isDrawing?tooltip.showAt(" <p>点击鼠标左键结束绘制box底面</p><p>移动鼠标绘制box高度</p><p>点击鼠标右键结束绘制</p>","230px"):tooltip.showAt(" <p>点击鼠标左键开始绘制box底面</p>","230px")})),a.drawEvt.addEventListener((function(e){var t={dimensions:(l=e.object).box.dimensions.getValue(),position:l.position.getValue(0),clipMode:c,heading:0};(s=new SuperMap3D.BoxEditor(viewer,l)).editEvt.addEventListener((function(e){l.box.dimensions=e.dimensions,l.position=e.position,l.orientation=e.orientation,d()})),s.activate(),p(t),tooltip.setVisible(!1),a.clear(),a.deactivate()}))),a.activate()},clearBoxClipByEitor:m})}ot.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",it,[e.withDirectives(e.createVNode("div",nt,[e.createVNode("div",rt,[e.createVNode("label",at,e.toDisplayString(t.Resource.visibleHeight),1),e.createVNode(l,{modelValue:n.floodHeight,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.floodHeight=e}),min:0,max:9e3,range:"",step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class","format-tooltip":a.formatTooltip,style:{width:"58%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",lt,[e.createVNode("label",st,e.toDisplayString(t.Resource.currentHeight),1),e.withDirectives(e.createVNode("input",{class:"sm-input",disabled:"",type:"number",style:{width:"58%"},"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.currentHeight=e})},null,512),[[e.vModelText,n.currentHeight]])]),e.createVNode("div",ct,[e.createVNode("label",dt,e.toDisplayString(t.Resource.floodSpeed),1),e.createVNode(l,{modelValue:n.floodSpeed,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.floodSpeed=e}),max:1e3,min:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class","format-tooltip":a.formatTooltip2,style:{width:"58%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",ut,[e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.floodBegin&&n.floodBegin.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{onClick:o[5]||(o[5]=function(){return n.floodClear&&n.floodClear.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},ot.__file="src/components/terrain-analysis/terrain-flood/terrain-flood.vue",ot.install=function(e){e.component(ot.name,ot)};var mt={name:"Sm3dClipBoxByeditor",props:{clipModel:{type:String,default:"ClipInside"}},setup:function(e){var t=pt(e);return{clipModel:t.clipModel,BoxClipByEitor:t.BoxClipByEitor,clearBoxClipByEitor:t.clearBoxClipByEitor}}},ht={id:"clip-box-panel",class:"sm-panel"},yt={class:"sm-function-module-sub-section",style:{margin:"0"}},ft={class:"sm-half-L"},vt={style:{width:"auto"}},wt={style:{width:"auto"}},gt={class:"boxchild"};mt.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",ht,[e.withDirectives(e.createVNode("div",yt,[e.createVNode("div",ft,[e.createVNode("label",vt,[e.withDirectives(e.createVNode("input",{type:"radio",value:"ClipInside","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.clipModel=e})},null,512),[[e.vModelRadio,n.clipModel]]),e.createTextVNode(e.toDisplayString(t.Resource.clipInside),1)]),e.createVNode("label",wt,[e.withDirectives(e.createVNode("input",{type:"radio",value:"ClipOutside","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.clipModel=e})},null,512),[[e.vModelRadio,n.clipModel]]),e.createTextVNode(e.toDisplayString(t.Resource.clipOutside),1)])]),e.createVNode("div",gt,[e.createVNode("button",{onClick:o[3]||(o[3]=function(){return n.BoxClipByEitor&&n.BoxClipByEitor.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.clip),1),e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.clearBoxClipByEitor&&n.clearBoxClipByEitor.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[l]])],512)),[[s]])},mt.__file="src/components/clip/clip-box-editor/clip-box-editor.vue",mt.install=function(e){e.component(mt.name,mt)};var bt={name:"Sm3dClipPolygon",props:{clipModelPolygon:{type:String,default:"ClipInside"},isEdit:{type:Boolean,default:!1},isEditZ:{type:Boolean,default:!1},polygonPositions:{type:Array},lineVisible:{type:Boolean,default:!0}},setup:function(o){var i=function(o){var i=e.reactive({clipModelPolygon:"ClipInside",isEdit:!1,isEditZ:!1,lineVisible:!0});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message&&ae.Message.errorMsg(te.AttributeError+n);var r,a=SuperMap3D.ModifyRegionMode.CLIP_INSIDE,l=!0,s=[];function c(e){s=e;var t,o=g(r);try{for(o.s();!(t=o.n()).done;)t.value.setModifyRegions([e],a)}catch(e){o.e(e)}finally{o.f()}}return o&&o.polygonPositions&&c(o.slopePositions),t.isViewer&&(r=viewer.scene.layers.layerQueue,window.tooltip||(window.tooltip=Z(viewer._element))),e.watch((function(){return t.isViewer}),(function(e){e&&(r=viewer.scene.layers.layerQueue,window.tooltip||(window.tooltip=Z(viewer._element)))})),e.watch((function(){return i.clipModelPolygon}),(function(e){switch(e){case"ClipInside":a=SuperMap3D.ModifyRegionMode.CLIP_INSIDE;break;case"ClipOutside":a=SuperMap3D.ModifyRegionMode.CLIP_OUTSIDE}s.length>0&&c(s)})),e.watch((function(){return i.isEdit}),(function(e){e&&window.handlerPolygon?he(s,i.isEditZ,c):(ye(),window.handlerPolygon&&window.handlerPolygon.polygon&&(window.handlerPolygon.polygon.show=!1))})),e.watch((function(){return i.isEditZ}),(function(e){window.editHandler&&(window.editHandler.isEditZ=e)})),e.onBeforeUnmount((function(){r=void 0})),u(u({},e.toRefs(i)),{},{clipPolygon:function(e){e.preventDefault(),tooltip.setVisible(!1),l&&(tooltip.showAt(" <p>点击鼠标左键开始绘制多边形</p><p>点击鼠标右键结束绘制</p>","230px"),l=!1),r||(r=viewer.scene.layers.layerQueue);var t,o=g(r);try{for(o.s();!(t=o.n()).done;){var n=t.value;n.selectEnabled=!1,n.clipLineColor=new SuperMap3D.Color(1,1,1,0)}}catch(e){o.e(e)}finally{o.f()}window.handlerPolygon||le("Polygon"),se("Polygon",i.lineVisible).then((function(e){c(e.positions);var t=window.handlerPolygon;t.polygon.show=!1,t.polyline.show=!1,t.deactivate(),i.isEdit&&he(s,i.isEditZ,c)}),(function(e){console.log(e)})),window.handlerPolygon.activate(),scene.pickPositionSupported||ae.Message&&ae.Message.errorMsg(te.NoPickPositionSupported)},clearClipPolygon:function(e){if(e.preventDefault(),s=[],tooltip.setVisible(!1),window.handlerPolygon){ce("Polygon");var t,o=g(r);try{for(o.s();!(t=o.n()).done;)t.value.clearModifyRegions()}catch(e){o.e(e)}finally{o.f()}}},polygonPosition:s})}(o);return{clipModelPolygon:i.clipModelPolygon,isEdit:i.isEdit,isEditZ:i.isEditZ,clipPolygon:i.clipPolygon,clearClipPolygon:i.clearClipPolygon}}},St={id:"clip-polygon-panel",class:"sm-panel"},Vt={class:"sm-function-module-sub-section",style:{margin:"0"}},Dt={class:"sm-half-L"},Nt={style:{width:"auto"}},Ct={style:{width:"auto"}},Mt={class:"boxchild"};function xt(o){var i,n,r,a,l,s,c,d=e.reactive({clipWidth:5,clipHeight:5,heading:0,pitch:0,roll:0,extrude:1});if(o)for(var p in o)d.hasOwnProperty(p)?d[p]=o[p]:ae.Message.errorMsg(te.AttributeError+p);function m(){var e,t=g(i);try{for(t.s();!(e=t.n()).done;){e.value.setCustomClipCross({position:c,dimensions:s,heading:d.heading,pitch:d.pitch,roll:d.roll,extrudeDistance:Number(d.extrude)})}}catch(e){t.e(e)}finally{t.f()}}function h(){a&&viewer.entities.removeById("cross-clip-identify-box");var e,t=g(i);try{for(t.s();!(e=t.n()).done;){e.value.clearCustomClipBox()}}catch(e){t.e(e)}finally{t.f()}r=!1,a=void 0,n.removeInputAction(SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),n.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}return t.isViewer&&(n=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas),i=viewer.scene.layers.layerQueue),e.watch((function(){return t.isViewer}),(function(e){e&&(n=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas),i=viewer.scene.layers.layerQueue)})),e.watch((function(){return d.clipWidth}),(function(e){var t=Number(e);t<=0||!a||(a.box.dimensions=new SuperMap3D.Cartesian3(d.clipWidth,d.clipHeight,.1),s=new SuperMap3D.Cartesian3(t,d.clipHeight,d.extrude),m())})),e.watch((function(){return d.clipHeight}),(function(e){var t=Number(e);t<=0||!a||(a.box.dimensions=new SuperMap3D.Cartesian3(d.clipWidth,d.clipHeight,.1),s=new SuperMap3D.Cartesian3(d.clipWidth,t,d.extrude),m())})),e.watch((function(){return d.pitch}),(function(e){if(""!==e&&a){var t=Number(e),o=new SuperMap3D.HeadingPitchRoll(SuperMap3D.Math.toRadians(d.heading),SuperMap3D.Math.toRadians(t),SuperMap3D.Math.toRadians(d.roll)),i=SuperMap3D.Transforms.headingPitchRollQuaternion(l,o);a.orientation=i,m()}})),e.watch((function(){return d.roll}),(function(e){if(""!==e&&a){var t=Number(e),o=new SuperMap3D.HeadingPitchRoll(SuperMap3D.Math.toRadians(d.heading),SuperMap3D.Math.toRadians(d.pitch),SuperMap3D.Math.toRadians(t)),i=SuperMap3D.Transforms.headingPitchRollQuaternion(l,o);a.orientation=i,m()}})),e.watch((function(){return d.heading}),(function(e){if(""!==e&&a){var t=Number(e),o=new SuperMap3D.HeadingPitchRoll(SuperMap3D.Math.toRadians(t),SuperMap3D.Math.toRadians(d.pitch),SuperMap3D.Math.toRadians(d.roll)),i=SuperMap3D.Transforms.headingPitchRollQuaternion(l,o);a.orientation=i,m()}})),e.watch((function(){return d.extrude}),(function(e){Number(e)<=0||!a||m()})),e.onBeforeUnmount((function(){n.destroy(),i=void 0,a=void 0,n=void 0,s=void 0})),u(u({},e.toRefs(d)),{},{startCross:function(e){e.preventDefault(),viewer&&(a&&h(),function(){var e,t,o=g(i);try{for(o.s();!(e=o.n()).done;){e.value.selectEnabled=!1}}catch(e){o.e(e)}finally{o.f()}l=SuperMap3D.Cartesian3.fromDegrees(0,0,0),s=new SuperMap3D.Cartesian3(d.clipWidth,d.clipHeight,.1),a=viewer.entities.add({id:"cross-clip-identify-box",position:l,show:!1,box:{dimensions:s,fill:!1,outline:!0,outlineColor:SuperMap3D.Color.AQUA,outlineWidth:5}}),n.setInputAction((function(e){if(r){if(!(l=scene.pickPosition(e.endPosition)))return;a.position=l,t||(t=new SuperMap3D.HeadingPitchRoll(SuperMap3D.Math.toRadians(d.heading),SuperMap3D.Math.toRadians(d.pitch),SuperMap3D.Math.toRadians(d.roll)));var o=SuperMap3D.Transforms.headingPitchRollQuaternion(l,t);a.orientation=o}}),SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),n.setInputAction((function(e){if(r){if(!(c=scene.pickPosition(e.position)))return;m(),r=!1,a.show=!1}n.removeInputAction(SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),n.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK),t=null}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}(),r=!0,a.show=!0)},clearCross:h})}bt.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",St,[e.withDirectives(e.createVNode("div",Vt,[e.createVNode("div",Dt,[e.createVNode("label",Nt,[e.withDirectives(e.createVNode("input",{type:"radio",value:"ClipInside","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.clipModelPolygon=e})},null,512),[[e.vModelRadio,n.clipModelPolygon]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.clipInside),1)]),e.createVNode("label",Ct,[e.withDirectives(e.createVNode("input",{type:"radio",value:"ClipOutside","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.clipModelPolygon=e})},null,512),[[e.vModelRadio,n.clipModelPolygon]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.clipOutside),1)])]),e.createVNode("div",Mt,[e.createVNode("button",{onClick:o[3]||(o[3]=function(){return n.clipPolygon&&n.clipPolygon.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.clip),1),e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.clearClipPolygon&&n.clearClipPolygon.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[l]])],512)),[[s]])},bt.__file="src/components/clip/clip-polygon/clip-polygon.vue",bt.install=function(e){e.component(bt.name,bt)};var Rt={name:"Sm3dClipCross",props:{clipWidth:{type:Number,default:5},clipHeight:{type:Number,default:5},heading:{type:Number,default:0},pitch:{type:Number,default:0},roll:{type:Number,default:0},extrude:{type:Number,default:1}},setup:function(e){var t=xt(e);return{clipWidth:t.clipWidth,clipHeight:t.clipHeight,heading:t.heading,pitch:t.pitch,roll:t.roll,extrude:t.extrude,startCross:t.startCross,clearCross:t.clearCross}}},kt={id:"viewer-panel",class:"sm-panel"},Lt={class:"sm-function-module-sub-section",style:{margin:"0"}},Pt={class:"sm-half-L"},Bt={class:"label-S"},Tt={class:"sm-slider-input-box"},Et={class:"sm-half-L"},At={class:"label-S"},It={class:"sm-slider-input-box"},Ft={class:"sm-half-L"},Ut={class:"label-S"},_t={class:"sm-slider-input-box"},Ot={class:"sm-half-L"},Ht={class:"label-S"},zt={class:"sm-slider-input-box"},Gt={class:"sm-half-L"},jt={class:"label-S"},Wt={class:"sm-slider-input-box"},Kt={class:"sm-half-L"},Qt={class:"label-S"},Xt={class:"sm-slider-input-box"},Yt={class:"boxchild"};function Zt(o){var i,n,r,a,l=e.reactive({clipMode:0,planeDirection:"vertical"});if(o)for(var s in o)l.hasOwnProperty(s)?l[s]=o[s]:ae.Message.errorMsg(te.AttributeError+s);var c,d,p="public/data/s3m/box.s3m";function m(){i=viewer.scene.layers.layerQueue,a=new SuperMap3D.S3MInstanceCollection(scene._context),viewer.scene.primitives.add(a),window.tooltip||(window.tooltip=Z(viewer._element))}function h(){if(n.cartPositions){var e,t=g(i);try{for(t.s();!(e=t.n()).done;){e.value.setCustomClipPlane(n.cartPositions[0],n.cartPositions[1],n.cartPositions[2])}}catch(e){t.e(e)}finally{t.f()}}}function y(){if(tooltip.setVisible(!1),d&&(viewer.entities.remove(d),c.deactivate(),a.removeCollection(p),d=null,n=null),window.handlerPolyline){ce("Polyline");var e,t=g(i);try{for(t.s();!(e=t.n()).done;){e.value.clearCustomClipBox()}}catch(e){t.e(e)}finally{t.f()}}}return e.watch((function(){return t.changeLayers}),(function(e){var t,o=g(i=viewer.scene.layers.layerQueue);try{for(o.s();!(t=o.n()).done;){var n=t.value;n.selectEnabled=!1,n.clipLineColor=new SuperMap3D.Color(1,1,1,0)}}catch(e){o.e(e)}finally{o.f()}})),t.isViewer&&m(),e.watch((function(){return t.isViewer}),(function(e){m()})),e.watch((function(){return l.clipMode}),(function(e){if(n){var t=f(n.cartPositions),o=[t[1],t[0],t[3],t[2]];n.cartPositions=o,h()}})),e.onBeforeUnmount((function(){i=void 0,c&&c.destroy()})),u(u({},e.toRefs(l)),{},{clipPlaneStart:function(e){e.preventDefault(),d&&y(),tooltip.setVisible(!1),tooltip.showAt("<p>点击鼠标左键开始绘制平面的一条边</p><p>绘制两点即可</p><p>点击鼠标右键结束绘制</p>","350px"),window.handlerPolygon||le("Polyline"),se("Polyline").then((function(e){console.log("res:",e);var t=window.handlerPolyline;t.polyline.show=!1,window.polylineTransparent.show=!1,t.deactivate(),function(e,t){var o,i=SuperMap3D.Cartesian3.distance(t[0],t[1]);i=SuperMap3D.defaultValue(i,100),o="vertical"===l.planeDirection?function(e,t,o){var i=e.slice(0,3),n=e.slice(3,6),r=n.slice(0,2).concat(n[2]+o),a=i.slice(0,2).concat(i[2]+o),l=[].concat(t);return l.push(SuperMap3D.Cartesian3.fromDegrees(r[0],r[1],r[2])),l.push(SuperMap3D.Cartesian3.fromDegrees(a[0],a[1],a[2])),l}(e,t,i):function(e,t){var o=new SuperMap3D.Cartesian3(0,0,0),i=new SuperMap3D.Cartesian3(0,0,0),n=new SuperMap3D.Cartesian3(0,0,0),r=new SuperMap3D.Cartesian3(0,0,0),a=new SuperMap3D.Cartesian3(0,0,0);return SuperMap3D.Cartesian3.subtract(e[0],e[1],o),SuperMap3D.Cartesian3.cross(o,e[0],i),SuperMap3D.Cartesian3.normalize(i,i),SuperMap3D.Cartesian3.multiplyComponents(i,new SuperMap3D.Cartesian3(t,t,t),n),SuperMap3D.Cartesian3.add(e[0],n,a),SuperMap3D.Cartesian3.add(e[1],n,r),[e[0],e[1],r,a]}(t,i);var s=SuperMap3D.BoundingSphere.fromPoints(o).center;n={cartPositions:o,centerPositions:s},d=viewer.entities.add({id:"clip-plane",polygon:{hierarchy:new SuperMap3D.CallbackProperty((function(){return{positions:n.cartPositions,holes:[]}}),!1),material:SuperMap3D.Color.GOLD.withAlpha(.2),outline:!0,outlineColor:SuperMap3D.Color.GOLD,perPositionHeight:!0}}),u=ae.getAngleAndRadian(n.cartPositions[0],n.cartPositions[1]).radian,m="clip-model",a.add(p,{id:m,position:n.centerPositions,hpr:new SuperMap3D.HeadingPitchRoll(u,0,0),scale:new SuperMap3D.Cartesian3(.1,.1,.1)}),r=a.getInstance(p,m),c?(c.setEditObject(r),c.activate()):(y=r,(c=new SuperMap3D.ModelEditor({model:y,scene:viewer.scene,axesShow:{translation:!0,rotation:!1,scale:!1}})).activate(),c.changedEvt.addEventListener((function(e){var t=new SuperMap3D.Cartesian3;if(SuperMap3D.Matrix4.getTranslation(e.modelMatrix,t),t){for(var o=t.x-n.centerPositions.x,i=t.y-n.centerPositions.y,r=t.z-n.centerPositions.z,a=0;a<4;a++)n.cartPositions[a].x+=o,n.cartPositions[a].y+=i,n.cartPositions[a].z+=r;n.centerPositions=t,h()}}))),h();var u,m,y}(e.positions,e.result.positions),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()},clearClipPlane:y})}Rt.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",kt,[e.withDirectives(e.createVNode("div",Lt,[e.createVNode("div",Pt,[e.createVNode("label",Bt,e.toDisplayString(t.Resource.ClipWidth),1),e.createVNode("div",Tt,[e.createVNode(l,{modelValue:n.clipWidth,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.clipWidth=e}),min:1,step:1,"input-size":"mini",debounce:500,"show-tooltip":!1,style:{width:"62%"}},null,8,["modelValue"]),e.withDirectives(e.createVNode("input",{class:"sm-input-S",min:"1",step:"1",type:"number","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.clipWidth=e})},null,512),[[e.vModelText,n.clipWidth]])])]),e.createVNode("div",Et,[e.createVNode("label",At,e.toDisplayString(t.Resource.ClipHeight),1),e.createVNode("div",It,[e.createVNode(l,{modelValue:n.clipHeight,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.clipHeight=e}),min:1,step:1,"input-size":"mini",debounce:500,"show-tooltip":!1,style:{width:"62%"}},null,8,["modelValue"]),e.withDirectives(e.createVNode("input",{class:"sm-input-S",min:"1",step:"1",type:"number","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.clipHeight=e})},null,512),[[e.vModelText,n.clipHeight]])])]),e.createVNode("div",Ft,[e.createVNode("label",Ut,e.toDisplayString(t.Resource.Xrotation),1),e.createVNode("div",_t,[e.createVNode(l,{modelValue:n.pitch,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.pitch=e}),min:0,step:1,max:360,"input-size":"mini",debounce:500,"show-tooltip":!1,style:{width:"62%"}},null,8,["modelValue"]),e.withDirectives(e.createVNode("input",{class:"sm-input-S",min:"0",max:"360",step:"1",type:"number","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.pitch=e})},null,512),[[e.vModelText,n.pitch]])])]),e.createVNode("div",Ot,[e.createVNode("label",Ht,e.toDisplayString(t.Resource.Yrotation),1),e.createVNode("div",zt,[e.createVNode(l,{modelValue:n.roll,"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.roll=e}),min:0,step:1,max:360,"input-size":"mini",debounce:500,"show-tooltip":!1,style:{width:"62%"}},null,8,["modelValue"]),e.withDirectives(e.createVNode("input",{class:"sm-input-S",min:"0",step:"1",max:"360",type:"number","onUpdate:modelValue":o[8]||(o[8]=function(e){return n.roll=e})},null,512),[[e.vModelText,n.roll]])])]),e.createVNode("div",Gt,[e.createVNode("label",jt,e.toDisplayString(t.Resource.Zrotation),1),e.createVNode("div",Wt,[e.createVNode(l,{modelValue:n.heading,"onUpdate:modelValue":o[9]||(o[9]=function(e){return n.heading=e}),min:0,step:1,max:360,"input-size":"mini",debounce:500,"show-tooltip":!1,style:{width:"62%"}},null,8,["modelValue"]),e.withDirectives(e.createVNode("input",{class:"sm-input-S",min:"0",step:"1",max:"360",type:"number","onUpdate:modelValue":o[10]||(o[10]=function(e){return n.heading=e})},null,512),[[e.vModelText,n.heading]])])]),e.createVNode("div",Kt,[e.createVNode("label",Qt,e.toDisplayString(t.Resource.stretchHeight),1),e.createVNode("div",Xt,[e.createVNode(l,{modelValue:n.extrude,"onUpdate:modelValue":o[11]||(o[11]=function(e){return n.extrude=e}),min:1,step:1,"input-size":"mini",debounce:500,"show-tooltip":!1,style:{width:"62%"}},null,8,["modelValue"]),e.withDirectives(e.createVNode("input",{class:"sm-input-S",min:"1",step:"1",type:"number","onUpdate:modelValue":o[12]||(o[12]=function(e){return n.extrude=e})},null,512),[[e.vModelText,n.extrude]])])]),e.createVNode("div",Yt,[e.createVNode("button",{onClick:o[13]||(o[13]=function(){return n.startCross&&n.startCross.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.clip),1),e.createVNode("button",{onClick:o[14]||(o[14]=function(){return n.clearCross&&n.clearCross.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},Rt.__file="src/components/clip/clip-cross/clip-cross.vue",Rt.install=function(e){e.component(Rt.name,Rt)};var qt={name:"Sm3dClipPlane",props:{},setup:function(e){var t=Zt(e);return{clipPlaneStart:t.clipPlaneStart,clearClipPlane:t.clearClipPlane,clipMode:t.clipMode,planeDirection:t.planeDirection}}},Jt={id:"clip-plane-panel",class:"sm-panel"},$t={class:"sm-function-module-sub-section",style:{margin:"0"}},eo={class:"sm-half-L"},to={style:{width:"40%"}},oo={selected:"",value:"vertical"},io={value:"parallel"},no={class:"sm-half-L"},ro={style:{width:"40%"}},ao={selected:"",value:"0"},lo={value:"1"},so={class:"boxchild"};function co(o){var i,n,r,a,l,s,c,d=e.reactive({measureMode:"Space",clampMode:SuperMap3D.ClampMode.Space,Ellipsoid:null,contourColor:"#ff7d00",isShowDVH:!1,isShowLine:!0,pickPointEnabled:!0});(l=new SuperMap3D.HypsometricSetting).DisplayMode=SuperMap3D.HypsometricSettingEnum.DisplayMode.LINE;var p=new SuperMap3D.ColorTable;l._lineColor=SuperMap3D.Color.fromCssColorString(d.contourColor),l.ColorTable=p,l.Opacity=.6,l.MaxVisibleValue=-100,l.MinVisibleValue=-100;var m=function(){setInterval((function(){console.log("now-state.pickPointEnabled:",d.pickPointEnabled)}),2e3),i=viewer.scene.layers.layerQueue,viewer.scene.globe.HypsometricSetting={hypsometricSetting:l,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_ALL},t.changeLayers&&h(),n=new SuperMap3D.MeasureHandler(viewer,SuperMap3D.MeasureMode.Distance,d.clampMode),r=new SuperMap3D.MeasureHandler(viewer,SuperMap3D.MeasureMode.Area,d.clampMode),a=new SuperMap3D.MeasureHandler(viewer,SuperMap3D.MeasureMode.DVH),n.activeEvt.addEventListener((function(e){1==e?(viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),viewer.scene.pickPointEnabled=d.pickPointEnabled):(viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur"),viewer.scene.pickPointEnabled=!1)})),n.measureEvt.addEventListener((function(e){var t=Number(e.distance),o=d.measureMode;"CGCS2000"!=o&&"XIAN80"!=o&&"WGS84"!=o||(t=Number(function(e){for(var t=[],o=0;o<e.length;o++){var i=SuperMap3D.Cartographic.fromCartesian(e[o]),n=SuperMap3D.Math.toDegrees(i.longitude),r=SuperMap3D.Math.toDegrees(i.latitude);t.push(n,r)}var a=new SuperMap3D.PolylineGeometry({positions:SuperMap3D.Cartesian3.fromDegreesArray(t)});return scene.globe.computeSurfaceDistance(a,d.Ellipsoid)}(e.positions)));var i=t>1e3?(t/1e3).toFixed(2)+"km":t.toFixed(2)+"m";n.disLabel.text="距离:"+i})),r.activeEvt.addEventListener((function(e){1==e?(viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),viewer.scene.pickPointEnabled=d.pickPointEnabled):(viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur"),viewer.scene.pickPointEnabled=!1)})),r.measureEvt.addEventListener((function(e){var t=Number(e.area),o=d.measureMode;"CGCS2000"==o||"XIAN80"==o||"WGS84"==o?t=Number(function(e){for(var t=[],o=0;o<e.length;o++){var i=SuperMap3D.Cartographic.fromCartesian(e[o]),n=SuperMap3D.Math.toDegrees(i.longitude),r=SuperMap3D.Math.toDegrees(i.latitude);t.push(n,r)}var a=new SuperMap3D.PolygonGeometry.fromPositions({positions:SuperMap3D.Cartesian3.fromDegreesArray(t)});return scene.globe.computeSurfaceArea(a,d.Ellipsoid)}(e.positions)):"6"==o&&(t=Number(function(e){for(var t=0,o=0;o<e.length;o++){var i=SuperMap3D.Cartographic.fromCartesian(e[o]);t+=SuperMap3D.Math.toDegrees(i.longitude)}for(var n=Math.round((t/e.length+6)/6),r=6*n-3,a=new SuperMap3D.CustomProjection({name:"tmerc",centralMeridian:r,primeMeridian:0,standardParallel_1:0,standardParallel_2:0,eastFalse:5e5,northFalse:0,semimajorAxis:6378137,inverseFlattening:298.257222101}),l=[],s=0;s<e.length;s++){var c=SuperMap3D.Cartographic.fromCartesian(e[s]),d=a.project(c);l.push(d)}return l.push(l[0]),SuperMap3D.getPreciseArea(l,"China2000",r,n,1)}(e.positions)));var i=t>1e6?(t/1e6).toFixed(2)+"km²":t.toFixed(2)+"㎡";r.areaLabel.text="面积:"+i})),a.measureEvt.addEventListener((function(e){var t=e.distance>1e3?(e.distance/1e3).toFixed(2)+"km":e.distance+"m",o=e.verticalHeight>1e3?(e.verticalHeight/1e3).toFixed(2)+"km":e.verticalHeight+"m",i=e.horizontalDistance>1e3?(e.horizontalDistance/1e3).toFixed(2)+"km":e.horizontalDistance+"m";a.disLabel.text="空间距离:"+t,a.vLabel.text="垂直高度:"+o,a.hLabel.text="水平距离:"+i,s=Number(e.endHeight),d.isShowLine&&y(s)})),a.activeEvt.addEventListener((function(e){1==e?(viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),viewer.scene.pickPointEnabled=d.pickPointEnabled):(viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur"),viewer.scene.pickPointEnabled=!1)}))};function h(){for(var e=0;e<i.length;e++)i[e].hypsometricSetting={hypsometricSetting:l,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_ALL};c=!0}function y(e){if(viewer.scene.globe.HypsometricSetting.hypsometricSetting.MaxVisibleValue=e,viewer.scene.globe.HypsometricSetting.hypsometricSetting.MinVisibleValue=e,c)for(var t=0;t<i.length;t++)i[t].hypsometricSetting.hypsometricSetting?(i[t].hypsometricSetting.hypsometricSetting.MaxVisibleValue=e,i[t].hypsometricSetting.hypsometricSetting.MinVisibleValue=e):h()}function f(e){var t=scene.pickPosition(e.message.position);ae.CartesiantoDegrees(t)[2]}function v(){y(-1e4),viewer.eventManager.removeEventListener("CLICK",f)}function w(){n&&n.deactivate(),r&&r.deactivate(),a&&a.deactivate(),d.isShowDVH=!1,d.Ellipsoid=null,s=-1e4}return t.isViewer&&m(),e.watch((function(){return t.isViewer}),(function(e){e&&m()})),e.watch((function(){return t.changeLayers}),(function(e){h()})),e.watch((function(){return d.isShowLine}),(function(e){y(e?s:-1e4)})),e.watch((function(){return d.pickPointEnabled}),(function(e){viewer.scene.pickPointEnabled=e})),e.watch((function(){return d.measureMode}),(function(e){"Space"==e?(d.clampMode=SuperMap3D.ClampMode.Space,r.clampMode=SuperMap3D.ClampMode.Space,n.clampMode=SuperMap3D.ClampMode.Space):(d.clampMode=SuperMap3D.ClampMode.Ground,r.clampMode=SuperMap3D.ClampMode.Ground,n.clampMode=SuperMap3D.ClampMode.Ground,d.Ellipsoid="XIAN80"==e?SuperMap3D.Ellipsoid.XIAN80:"CGCS2000"==e?SuperMap3D.Ellipsoid.CGCS2000:"WGS84"==e?SuperMap3D.Ellipsoid.WGS84:null)})),e.onBeforeUnmount((function(){l.destroy(),i=void 0})),u(u({},e.toRefs(d)),{},{distanceClk:function(){w(),n&&n.activate()},areaClk:function(){w(),r&&r.activate()},heightClk:function(){c||h(),v(),viewer.eventManager.addEventListener("CLICK",f,!0),w(),d.isShowDVH=!0,a&&a.activate()},clear:function(){w(),n&&n.clear(),r&&r.clear(),a&&a.clear(),v(),viewer.scene.pickPointEnabled=!1}})}qt.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Jt,[e.withDirectives(e.createVNode("div",$t,[e.createVNode("div",eo,[e.createVNode("label",to,e.toDisplayString(t.Resource.planeDirection),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.planeDirection=e})},[e.createVNode("option",oo,e.toDisplayString(t.Resource.verticalGround),1),e.createVNode("option",io,e.toDisplayString(t.Resource.parallelGround),1)],512),[[e.vModelSelect,n.planeDirection]])]),e.createVNode("div",no,[e.createVNode("label",ro,e.toDisplayString(t.Resource.clipMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.clipMode=e})},[e.createVNode("option",ao,e.toDisplayString(t.Resource.clipInside),1),e.createVNode("option",lo,e.toDisplayString(t.Resource.clipOutside),1)],512),[[e.vModelSelect,n.clipMode]])]),e.createVNode("div",so,[e.createVNode("button",{onClick:o[3]||(o[3]=function(){return n.clipPlaneStart&&n.clipPlaneStart.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.clip),1),e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.clearClipPlane&&n.clearClipPlane.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[l]])],512)),[[s]])},qt.__file="src/components/clip/clip-plane-new/clip-plane-new.vue",qt.install=function(e){e.component(qt.name,qt)};var uo={name:"Sm3dMeasure",setup:function(e){var t=co();return{measureMode:t.measureMode,isShowDVH:t.isShowDVH,interval:t.interval,isShowLine:t.isShowLine,distanceClk:t.distanceClk,areaClk:t.areaClk,heightClk:t.heightClk,clear:t.clear}}},po={id:"measure-panel",class:"sm-panel"},mo={class:"sm-function-module-sub-section",style:{margin:"0"}},ho={class:"sm-half-L"},yo={class:"label-S"},fo={selected:"",value:"Space"},vo={value:"Ground"},wo=e.createVNode("option",{selected:"",value:"CGCS2000"},"CGCS2000",-1),go=e.createVNode("option",{value:"XIAN80"},"XIAN80",-1),bo=e.createVNode("option",{value:"WGS84"},"WGS84",-1),So={value:"null"},Vo=e.createVNode("span",{class:"iconfont iconkongjianjuli"},null,-1),Do=e.createVNode("span",{class:"iconfont icongaoduceliang"},null,-1),No=e.createVNode("span",{class:"iconfont iconkongjianmianji"},null,-1),Co=e.createVNode("span",{class:"iconfont iconqingchu"},null,-1),Mo={class:"sm-half-L flex-start",style:{"margin-top":"6px"}},xo={style:{"margin-left":"10%"}};function Ro(t){var n=e.reactive({skylineRadius:1e4,lineWidth:3,skylineColor:"rgb(200, 0, 0)",skyBodyColor:"rgba(44,149,197,0.6)",barrierColor:"rgba(255, 186, 1, 1)",skylineMode:0,highlightBarrier:!1,getSkyline2d:!0,skylineSpatialAnalysisUrl:null,observerInformation:null,ignoreGlobe:!0,isClear:!0});if(t)for(var r in t)n.hasOwnProperty(r)?n[r]=t[r]:ae.Message.errorMsg(te.AttributeError+r);var a,l,s,c,d=!0,p=e.ref(null);function m(){window.echarts?(a||(a=window.echarts.init(p.value),window.onresize=function(){a.resize()}),a.setOption({title:{text:"二维天际线",textStyle:{fontSize:14}},grid:{left:30,right:0,top:30,bottom:8},tooltip:{},xAxis:{show:!1},yAxis:{show:!1},series:[{type:"bar",data:[]}]})):ae.Message.warnMsg(te.EchartsErr)}function h(){s.build(),b();var e=viewer.scene.camera.positionCartographic;f({longitude:SuperMap3D.Math.toDegrees(e.longitude),latitude:SuperMap3D.Math.toDegrees(e.latitude),height:e.height,pitch:SuperMap3D.Math.toDegrees(c.camera.pitch),direction:SuperMap3D.Math.toDegrees(c.camera.heading)}),n.isClear=!1}function y(){var e=viewer.camera.position,t=viewer.scene.globe.ellipsoid.cartesianToCartographic(e).height/200;viewer.camera.moveBackward(t)}function f(e){s.viewPosition=[e.longitude,e.latitude,e.height],s.pitch=e.pitch,s.direction=e.direction,s.radius=Number(n.skylineRadius),s.lineWidth=Number(n.lineWidth),s.color=SuperMap3D.Color.fromCssColorString(n.skylineColor),s.displayStyle=Number(n.skylineMode>1?0:n.skylineMode),setTimeout((function(){n.highlightBarrier&&v(SuperMap3D.Color.fromCssColorString(n.barrierColor));2==n.skylineMode&&(n.skylineSpatialAnalysisUrl?w():g(e)),function(e){if(n.observerInformation&&a){var t={tooltip:{trigger:"axis",formatter:function(e){var t=Number(e[0].axisValue),o=e[0].data;return["X: "+t.toFixed(6)+"<br/>","Y: "+o.toFixed(6)].join("")}},grid:{left:40,right:0,top:35,bottom:8,borderColor:"#333333"},color:"red",xAxis:[{type:"category",boundaryGap:!1,data:null==e?void 0:e.x,show:!1}],yAxis:{min:function(e){return(e.min-.05).toFixed(2)},show:!0,axisLine:{show:!0}},dataZoom:[{type:"inside",xAxisIndex:0,filterMode:"filter",start:0,end:100}],series:[{symbolSize:8,symbol:"circle",smooth:!0,type:"line",data:null==e?void 0:e.y,lineStyle:{width:2,shadowColor:"rgba(145, 146, 148,0.7)",shadowBlur:10,shadowOffsetY:8}}]};a.setOption(t)}}(s.getSkyline2D())}),300),n.observerInformation=e,1===s.displayStyle&&y()}function v(e){var t=s.getObjectIds();console.log(t);var o=viewer.scene.layers._layerQueue,i=function(i){o.forEach((function(o){o._id===Number(i)&&o.setObjsColor(t[i],e)}))};for(var n in t)i(n)}function w(){var e=s.getSkylineSectorParameter(),t={viewerPoint:e.viewPos,line3D:e.geoLine3D,height:0,lonlat:!0},r=n.skylineSpatialAnalysisUrl,a=JSON.stringify(t);axios.post(r,a).then((function(e){axios.get(e.data.newResourceLocation+".json").then((function(e){var t=e.data;if(null!==t.geometry){var r=new Uint8Array(t.geometry.model).buffer;l.add("SkyLineBody",{id:1,position:SuperMap3D.Cartesian3.fromDegrees(t.geometry.position.x,t.geometry.position.y,t.geometry.position.z),hpr:new SuperMap3D.HeadingPitchRoll(0,0,0),color:SuperMap3D.Color.fromCssColorString(n.skyBodyColor)},r,!1),t.geometry.model=[4,0,0,0].concat(t.geometry.model),t.geometry.name=te.SkyLineBody,i.geometrys.SkyLineBody=t.geometry,o.setGeometrys()}})).catch((function(e){console.log(e),ae.Message.errorMsg("获取天际线体数据失败",e)}))})).catch((function(e){console.log(e),ae.Message.errorMsg("获取天际线体数据失败",e)}))}function g(e){var t=s.getSkyline3D(),o=new Array,i=SuperMap3D.Cartesian3.fromDegrees(e.longitude,e.latitude,e.height);o.push(i);for(var r=0;r<t.x.length;r++){var a=SuperMap3D.Cartesian3.fromDegrees(t.x[r],t.y[r],t.z[r]);o.push(a)}viewer.entities.add({id:"SkyLineBody",polygon:{extrudedHeight:10,hierarchy:o,perPositionHeight:!0,material:SuperMap3D.Color.fromCssColorString(n.skyBodyColor)}})}function b(){if(ce(),tooltip.setVisible(!1),n.observerInformation){viewer.entities.removeById("SkyLineBody"),s&&s.clear();for(var e=0;e<c.layers._layerQueue.length;e++){c.layers.findByIndex(e).removeAllObjsColor()}n.observerInformation=null,a.clear(),m(),l.removeCollection("SkyLineBody"),i.geometrys.SkyLineBody&&(delete i.geometrys.SkyLineBody,o.setGeometrys()),n.isClear=!0}}return e.onMounted((function(){m()})),c=viewer.scene,l=new SuperMap3D.S3MInstanceCollection(viewer.scene._context),viewer.scene.primitives.add(l),(s=new SuperMap3D.Skyline(viewer.scene)).ignoreGlobe=n.ignoreGlobe,n.observerInformation&&f(n.observerInformation),window.tooltip||(window.tooltip=createTooltip(viewer._element)),e.watch((function(){return n.skylineRadius}),(function(e){n.observerInformation&&(s.radius=parseFloat(e),s.pitch=parseFloat(n.observerInformation.pitch))})),e.watch((function(){return n.lineWidth}),(function(e){n.isClear||(h(),s.lineWidth=Number(e))})),e.watch((function(){return n.skylineColor}),(function(e){if(n.observerInformation&&""!=e){var t=SuperMap3D.Color.fromCssColorString(e);s.color=t,s.pitch=parseFloat(n.observerInformation.pitch)}})),e.watch((function(){return n.barrierColor}),(function(e){!n.observerInformation&&n.highlightBarrier||v(SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return n.ignoreGlobe}),(function(e){s&&(s.ignoreGlobe=e),h()})),e.watch((function(){return n.highlightBarrier}),(function(e){if(e&&n.observerInformation)v(SuperMap3D.Color.fromCssColorString(n.barrierColor));else for(var t=0;t<c.layers._layerQueue.length;t++){c.layers.findByIndex(t).removeAllObjsColor()}})),e.watch((function(){return n.skyBodyColor}),(function(e){if(n.observerInformation&&""!=e){var t=SuperMap3D.Color.fromCssColorString(e);n.skylineSpatialAnalysisUrl?l.getInstance("SkyLineBody",1).updateColor(t):viewer.entities.getById("SkyLineBody").polygon.material=t}})),e.watch((function(){return n.getSkyline2d}),(function(e){e&&a?setTimeout((function(){a.resize()}),200):n.getSkyline2d=!1})),e.watch((function(){return n.skylineMode}),(function(e){0==e?(s.displayStyle=0,viewer.entities.removeById("SkyLineBody"),l.removeCollection("SkyLineBody"),i.geometrys.SkyLineBody&&(delete i.geometrys.SkyLineBody,o.setGeometrys())):1==e?(s.displayStyle=1,viewer.entities.removeById("SkyLineBody"),l.removeCollection("SkyLineBody"),i.geometrys.SkyLineBody&&(delete i.geometrys.SkyLineBody,o.setGeometrys()),y()):2==e&&(s.displayStyle=0,n.observerInformation&&(n.skylineSpatialAnalysisUrl?w(n.observerInformation):g(n.observerInformation)))})),e.onBeforeUnmount((function(){b(),s=void 0,a=void 0,l=void 0})),u(u({},e.toRefs(n)),{},{skyLineAnalysis:h,setLimitBody:function(){window.handlerPolygon||le("Polygon"),tooltip.setVisible(!1),d&&(window.tooltip.showAt(" <p>点击鼠标左键绘制区域</p><p>点击鼠标右键结束绘制</p>","450px"),d=!1),se("Polygon").then((function(e){s.removeLimitbody("limitBody");for(var t=window.handlerPolygon,o=e.result.object.positions,i=[],n=0,r=o.length;n<r;n++){var a=SuperMap3D.Cartographic.fromCartesian(o[n]),l=SuperMap3D.Math.toDegrees(a.longitude),c=SuperMap3D.Math.toDegrees(a.latitude);i.push([l,c])}for(var d=[],u=0,p=ae.unique(i).length;u<p;u++)d.push(i[u][0]),d.push(i[u][1]);s.addLimitbody({position:d,name:"limitBody"}),t.polygon.show=!1,t.polyline.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate()},echarts_box:p,clear:b})}uo.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",po,[e.withDirectives(e.createVNode("div",mo,[e.createVNode("div",ho,[e.createVNode("label",yo,e.toDisplayString(t.Resource.selectMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.measureMode=e})},[e.createVNode("option",fo,e.toDisplayString(t.Resource.measureSpace),1),e.createVNode("option",vo,e.toDisplayString(t.Resource.measureGround),1),wo,go,bo,e.createVNode("option",So,e.toDisplayString(t.Resource.planeProjection),1),e.createCommentVNode(' <option value="2">+ Resource.skylinesectorbody +</option> // 需要iServer910支持 ')],512),[[e.vModelSelect,n.measureMode]])]),e.createVNode("button",{onClick:o[2]||(o[2]=function(){return n.distanceClk&&n.distanceClk.apply(n,arguments)}),class:["sm-btn","null"===n.measureMode?"pointer-events":""],id:"distance",title:t.Resource.measureDistance,type:"button",disabled:"null"===n.measureMode},[Vo],10,["title","disabled"]),e.createVNode("button",{onClick:o[3]||(o[3]=function(){return n.heightClk&&n.heightClk.apply(n,arguments)}),class:["sm-btn","Space"!=n.measureMode&&"Ground"!=n.measureMode?"pointer-events":""],id:"height",title:t.Resource.measureHeight,type:"button",disabled:"Space"!=n.measureMode&&"Ground"!=n.measureMode},[Do],10,["title","disabled"]),e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.areaClk&&n.areaClk.apply(n,arguments)}),class:"sm-btn",id:"area",title:t.Resource.measureSurface,type:"button"},[No],8,["title"]),e.createVNode("button",{onClick:o[5]||(o[5]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"sm-btn",id:"clear",title:t.Resource.clear,type:"button"},[Co],8,["title"]),e.withDirectives(e.createVNode("div",Mo,[e.withDirectives(e.createVNode("input",{checked:"",id:"showLine",style:{"margin-left":"6px"},type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.isShowLine=e})},null,512),[[e.vModelCheckbox,n.isShowLine]]),e.createVNode("span",xo,e.toDisplayString(t.Resource.showContour),1)],512),[[e.vShow,n.isShowDVH]])],512),[[l]])],512)),[[s]])},uo.__file="src/components/analysis_3d/measure/measure.vue",uo.install=function(e){e.component(uo.name,uo)};var ko={name:"Sm3dSkyline",props:{skylineSpatialAnalysisUrl:{type:String},observerInformation:{type:Object},skylineRadius:{type:Number},lineWidth:{type:Number},skylineColor:{type:String},skyBodyColor:{type:String},highlightBarrierColor:{type:String},highlightBarrier:{type:Boolean,default:!1},skylineMode:{type:Number},getSkyline2d:{type:Boolean,default:!1},ignoreGlobe:{type:Boolean,default:!0}},setup:function(e){var t=Ro(e);return{skylineRadius:t.skylineRadius,lineWidth:t.lineWidth,skylineColor:t.skylineColor,skyBodyColor:t.skyBodyColor,barrierColor:t.barrierColor,highlightBarrier:t.highlightBarrier,getSkyline2d:t.getSkyline2d,skyLineAnalysis:t.skyLineAnalysis,setLimitBody:t.setLimitBody,clear:t.clear,echarts_box:t.echarts_box,skylineMode:t.skylineMode,ignoreGlobe:t.ignoreGlobe}}},Lo={id:"skyLine-panel",class:"sm-panel"},Po={class:"sm-function-module-sub-section",style:{margin:"0"}},Bo={class:"sm-half-L"},To={style:{width:"35%"}},Eo={selected:"",value:"0"},Ao={value:"1"},Io={value:"2"},Fo={class:"sm-half-L"},Uo={style:{width:"35%"}},_o={class:"sm-half-L"},Oo={style:{width:"35%"}},Ho={class:"sm-half-L"},zo={style:{width:"35%"}},Go={class:"sm-half-L"},jo={style:{width:"35%"}},Wo={class:"sm-half-L"},Ko={style:{width:"35%"}},Qo={class:"sm-half-L"},Xo={style:{width:"auto"}},Yo={style:{width:"auto"}},Zo={class:"sm-half-L flex-start"},qo={class:"boxchild"},Jo={ref:"echarts_box",id:"echarts_box"};ko.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveComponent("el-color-picker"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",Lo,[e.withDirectives(e.createVNode("div",Po,[e.createVNode("div",Bo,[e.createVNode("label",To,e.toDisplayString(t.Resource.displayMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.skylineMode=e})},[e.createVNode("option",Eo,e.toDisplayString(t.Resource.polylineShow),1),e.createVNode("option",Ao,e.toDisplayString(t.Resource.polygonShow),1),e.createVNode("option",Io,e.toDisplayString(t.Resource.bodyShow),1)],512),[[e.vModelSelect,n.skylineMode]])]),e.createVNode("div",Fo,[e.createVNode("label",Uo,e.toDisplayString(t.Resource.skylineRadius),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.skylineRadius=e})},null,512),[[e.vModelText,n.skylineRadius]])]),e.createVNode("div",_o,[e.createVNode("label",Oo,e.toDisplayString(t.Resource.lineWidth),1),e.createVNode(l,{modelValue:n.lineWidth,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.lineWidth=e}),min:1,step:1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Ho,[e.createVNode("label",zo,e.toDisplayString(t.Resource.skylineColor),1),e.createVNode(s,{modelValue:n.skylineColor,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.skylineColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Go,[e.createVNode("label",jo,e.toDisplayString(t.Resource.skyBodyColor),1),e.createVNode(s,{modelValue:n.skyBodyColor,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.skyBodyColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Wo,[e.createVNode("label",Ko,e.toDisplayString(t.Resource.barrierColor),1),e.createVNode(s,{modelValue:n.barrierColor,"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.barrierColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Qo,[e.createVNode("label",Xo,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[7]||(o[7]=function(e){return n.getSkyline2d=e})},null,512),[[e.vModelCheckbox,n.getSkyline2d]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.graphDisplay),1)]),e.createVNode("label",Yo,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=function(e){return n.highlightBarrier=e})},null,512),[[e.vModelCheckbox,n.highlightBarrier]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.highlightBarrier),1)])]),e.createVNode("div",Zo,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=function(e){return n.ignoreGlobe=e})},null,512),[[e.vModelCheckbox,n.ignoreGlobe]]),e.createVNode("label",null,e.toDisplayString(t.Resource.ignoreGlobe),1)]),e.createVNode("div",qo,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[10]||(o[10]=function(){return n.skyLineAnalysis&&n.skyLineAnalysis.apply(n,arguments)})},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[11]||(o[11]=function(){return n.setLimitBody&&n.setLimitBody.apply(n,arguments)})},e.toDisplayString(t.Resource.limitBody),1),e.createVNode("button",{onClick:o[12]||(o[12]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[c]])],512),[[d]]),e.withDirectives(e.createVNode("div",Jo,null,512),[[e.vShow,n.getSkyline2d]])],64)},ko.__file="src/components/analysis_3d/sky-line/sky-line.vue",ko.install=function(e){e.component(ko.name,ko)};var $o={name:"Sm3dShadowQuery",props:{timeValue:{type:Array},currentDate:{type:Object},shadowShow:{type:Boolean,default:!0},timeInterval:{type:Number},spacing:{type:Number},bottomHeight:{type:Number},extrudeHeight:{type:Number},shadowQueryRegion:{type:Array},layerShadowType:{type:Number},terrainShadows:{type:Number},showStartImgForTime:{type:Boolean,default:!0},showStartImgForDate:{type:Boolean,default:!0},dockFontShow:{type:Boolean,default:!0},legendShow:{type:Boolean,default:!1},shadowBodyShow:{type:Boolean,default:!1},shadowBodyFilter:{type:Array}},methods:{formatTooltip2:function(e){return"采光率："+e+"%"},formatTooltip3:function(e){return e+"米"}},setup:function(o){var i=function(o){var i=e.reactive({timeValue:[24,64],currentDate:new Date,shadowShow:!0,marks:{0:"0:00",8:"",16:"",24:"6:00",32:"",40:"",48:"12:00",56:"",64:"",72:"18:00",80:"",88:"",96:"24:00"},timeInterval:60,spacing:10,bottomHeight:1,extrudeHeight:30,shadowQueryRegion:[],layerShadowType:SuperMap3D.ShadowType.ALL,terrainShadows:SuperMap3D.ShadowMode.RECEIVE_ONLY,showStartImgForTime:!0,showStartImgForDate:!0,shadowRadio:{shadowRadio:"",longitude:"",latitude:"",height:"",isShow:!1},dockFontShow:!0,legendShow:!1,shadowBodyShow:!1,shadowBodyFilter:[0,100]});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);o&&o.shadowQueryRegion&&M(o.shadowQueryRegion);var r,a,l,s,c,d,p,m=!0,h=f(i.timeValue),y=e.ref(null),v="public/data/s3m/box.s3m",w=[],g=ae.gradientColors,b=["#0000ff"];function S(){var e=viewer.scene;viewer.shadows=i.shadowShow,viewer.terrainShadows=i.terrainShadows,a=viewer.scene.layers.layerQueue,e.globe.enableLighting=!0,e.skyBox.show=!0,viewer.clock.multiplier=1,viewer.clock.shouldAnimate=!0,r=new SuperMap3D.ShadowQueryPoints(e),(c=new SuperMap3D.S3MInstanceCollection(e._context)).setCullEnabled(v,!0),e.primitives.add(c),r.queryPointsEvent.addEventListener((function(e){w=e,i.shadowBodyShow&&L()})),t.changeLayers&&V()}function V(){for(var e=0;e<a.length;e++)a[e].shadowType=i.layerShadowType,d=!0}function D(e){var t;t=h[0]===e[0]?N(e[1]):N(e[0]),viewer.clock.currentTime=SuperMap3D.JulianDate.fromDate(t),h=e}function N(e){var t=parseInt(e/4),o=parseInt(e%4*15),n=i.currentDate;return n.setHours(t),n.setMinutes(o),n}function C(e){i.shadowShow&&(r.startTime=SuperMap3D.JulianDate.fromDate(N(e[0])),r.endTime=SuperMap3D.JulianDate.fromDate(N(e[1]))),i.showStartImgForTime&&i.shadowQueryRegion.length>0&&r.build()}function M(e){C(i.timeValue);var t=[];r.spacing=Number(i.spacing),r.timeInterval=Number(i.timeInterval);for(var o=Number(i.bottomHeight),n=Number(i.extrudeHeight),a=0,l=SuperMap3D.arrayRemoveDuplicates(e,SuperMap3D.Cartesian3.equalsEpsilon).length;a<l;a++){var s=SuperMap3D.Cartographic.fromCartesian(e[a]),c=SuperMap3D.Math.toDegrees(s.longitude),d=SuperMap3D.Math.toDegrees(s.latitude);t.push(c),t.push(d)}i.shadowQueryRegion=t,r.qureyRegion({position:t,bottom:o,extend:n}),r.build()}function x(e){if(i.shadowBodyShow){var t=scene.pick(e.message.position);if(t&&t.id){var o=w[t.id];if(!o)return;var n=100*o.shadowRatio;(n<i.shadowBodyFilter[0]||n>i.shadowBodyFilter[1])&&(i.shadowRadio.isShow=!1);var a=ae.CartesiantoDegrees(o.position);i.shadowRadio={shadowRadio:(100*o.shadowRatio).toFixed(0)+"%",longitude:a[0].toFixed(8),latitude:a[1].toFixed(8),height:a[2].toFixed(8),isShow:!0},y.value.style.top=e.message.position.y-160+"px",y.value.style.left=e.message.position.x+"px"}else i.shadowRadio.isShow=!1}else{var l=scene.pickPosition(e.message.position),s=SuperMap3D.Cartographic.fromCartesian(l),c=r.getShadowRadio(s);if(-1!=c){var d=SuperMap3D.Math.toDegrees(s.longitude),u=SuperMap3D.Math.toDegrees(s.latitude),p=s.height;i.shadowRadio={shadowRadio:(100*c).toFixed(0)+"%",longitude:d.toFixed(8),latitude:u.toFixed(8),height:p.toFixed(8),isShow:!0},y.value.style.top=e.message.position.y-160+"px",y.value.style.left=e.message.position.x+"px"}else i.shadowRadio.isShow=!1}}function R(){i.shadowRadio.isShow=!1}function k(){i.legendShow=!1,ce(),i.shadowQueryRegion.length=0,tooltip.setVisible(!1),R(),viewer.eventManager.removeEventListener("CLICK",x),r.clear(),w.length=0,c.removeCollection(v);for(var e=0;e<a.length;e++)a[e].shadowType=SuperMap3D.ShadowType.NONE}function L(){var e=[];if(!(r._bottom<0||0==w.length)){for(var t,o,n,a=Number(i.spacing-.5),l=0,s=w.length;l<s;l++)e.push({position:w[l].position,color:(t=w[l].shadowRatio,o=void 0,n=void 0,o=parseInt(100*t),n=b[o],SuperMap3D.Color.fromCssColorString(n)),scale:new SuperMap3D.Cartesian3(a,a,a)});e.length>0&&c.add(v,e),P(i.shadowBodyFilter)}}function P(e){if(!(r._bottom<=0||0==w.length))for(var t=0,o=w.length;t<o;t++){var i=100*w[t].shadowRatio;i<e[0]||i>e[1]?c.getInstance(v,t).visible=!1:c.getInstance(v,t).visible=!0}}function B(e){p&&clearTimeout(p),p=setTimeout((function(){e()}),500)}return b=b.concat(g("#0000ff","#00ffff",20)).concat(g("#00ffff","#00ff00",20)).concat(g("#00ff00","#ffff00",20)).concat(g("#ffff00","#ff7f00",20)).concat(g("#ff7f00","#ff0000",20)),t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),S()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),S())})),e.watch((function(){return t.changeLayers}),(function(e){V()})),e.watch((function(){return i.timeValue}),(function(e){D(e)})),e.watch((function(){return i.currentDate}),(function(e){D(h)})),e.watch((function(){return i.timeInterval}),(function(e){B((function(){r.timeInterval=Number(e)}))})),e.watch((function(){return i.spacing}),(function(e){B((function(){r.spacing=Number(e)}))})),e.watch((function(){return i.bottomHeight}),(function(e){0!==i.shadowQueryRegion.length&&B((function(){var t=Number(e),o=Number(i.extrudeHeight);r.qureyRegion({position:i.shadowQueryRegion,bottom:t,extend:o}),r.build()}))})),e.watch((function(){return i.extrudeHeight}),(function(e){0!==i.shadowQueryRegion.length&&B((function(){var t=Number(i.bottomHeight),o=Number(e);r.qureyRegion({position:i.shadowQueryRegion,bottom:t,extend:o}),r.build()}))})),e.watch((function(){return i.shadowShow}),(function(e){viewer.shadows=e;for(var t=0,o=a.length;t<o&&a[t].shadowType!=i.layerShadowType;t++)a[t].shadowType=i.layerShadowType})),e.watch((function(){return i.shadowBodyShow}),(function(e){e?(r.isPointsVisible=!1,L()):(r.isPointsVisible=!0,c.removeCollection(v))})),e.onBeforeUnmount((function(){k(),r.destroy(),r=void 0,viewer.shadows=!1,a=void 0})),u(u({},e.toRefs(i)),{},{timeChanged:C,filterChanged:function(e){P(e)},formatTooltip:function(e){return e===i.timeValue[0]?"开始时间:"+t(N(e).toLocaleTimeString()):"结束时间:"+t(N(e).toLocaleTimeString());function t(e){var t=e.split(":");return t[0]+":"+t[1]}},sunLightForTime:function(e){if(s&&(i.showStartImgForDate=!0,clearInterval(s)),!e)return i.showStartImgForTime=!0,void clearInterval(l);i.showStartImgForTime=!1;var t=f(h),o=t[0],n=t[1],r=o;l=setInterval((function(){r<n?(r+=.5,i.timeValue=[o,r]):(i.showStartImgForTime=!0,clearInterval(l))}),50)},sunLightForDate:function(e){if(l&&(clearInterval(l),i.showStartImgForTime=!0),!e)return i.showStartImgForDate=!0,void clearInterval(s);i.showStartImgForDate=!1;var t=N(h[1]),o=t.getMonth();s=setInterval((function(){o<11?o+=1:o=0,t.setMonth(o),i.currentDate=new Date(t)}),1e3)},analysis:function(){i.shadowShow?(tooltip.setVisible(!1),m&&(window.tooltip.showAt(" <p>点击鼠标左键绘制分析区域</p><p>点击鼠标右键结束绘制</p>","350px"),m=!1),d&&a[0].shadowType==i.layerShadowType||V(),window.handlerPolygon||le("Polygon"),se("Polygon").then((function(e){var t=window.handlerPolygon;M(e.result.object.positions),t.polygon.show=!1,t.polyline.show=!1,t.deactivate(),viewer.eventManager.addEventListener("CLICK",x,!0)}),(function(e){console.log(e)})),window.handlerPolygon.activate(),i.legendShow=!0):i.shadowShow=!0},clear:k,bubble:y,closeBubble:R,dockBubble:function(e){e?(y.value.classList.add("bubbleDock"),i.dockFontShow=!1):(y.value.classList.remove("bubbleDock"),i.dockFontShow=!0)}})}(o);return{marks:i.marks,timeValue:i.timeValue,currentDate:i.currentDate,shadowShow:i.shadowShow,timeChanged:i.timeChanged,formatTooltip:i.formatTooltip,sunLightForTime:i.sunLightForTime,sunLightForDate:i.sunLightForDate,analysis:i.analysis,clear:i.clear,showStartImgForTime:i.showStartImgForTime,showStartImgForDate:i.showStartImgForDate,shadowRadio:i.shadowRadio,bubble:i.bubble,closeBubble:i.closeBubble,dockBubble:i.dockBubble,dockFontShow:i.dockFontShow,legendShow:i.legendShow,shadowBodyShow:i.shadowBodyShow,shadowBodyFilter:i.shadowBodyFilter,filterChanged:i.filterChanged,extrudeHeight:i.extrudeHeight,spacing:i.spacing}}},ei="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAD2ElEQVRYR+2XTWwUZRjH/8+7UAxp8WCCdGbrhfoRTGrozkpE2sChGDxoIujFg+GwM0tQ8DMROYgkgkYsUiTsTG8mHlRqojGi9EBDiwT23RKbQPyoF7szKIkHKTFY2fcxs7vY3e3szBQ1jYlznPf5+M3/eZ/3fYawwA8tcH78twC6B6e6hBI9INoCZg2g9oqCfAlEHpiPKaFGxzMdE3GVjaVA96DXI5TaCdDmeIF5SAlxaDyjjUbZRwIYOXcAhGeqgQoEGmbiMwklJjHTUiy/b5lJloTqJKYHGNwHIFURBodlVt8RBhEKYNjF7wHqBPANQAelpTlRX+SvG7ZnAvwcgHsAnpRW8s5mfk0BDMcdA+NBANNKLFo3nrk9dl39ZN2DP3cJdX0MQBsIp6WprwuCCAQw7OLrAL3iO0hLjyxTmCqG7XJ1o+6TVnJ3o+2c4IYztQksPi8bKrVBbusYiSN7Mxvj6NR6CHGyvE7qYWl2HK+1nQOQdtxTzOhh5v2FbLKswt99UrniPiLaRYTRvKn3NgVI2T9uJCS+BHD+t+uLey9uX361MbnheCfB3AlQv7S0g3HgVh253Lp00R+nAKxmlB4qWHecuOFXp0Aq575FhBcBvCst/Ubr1eWYrWn59Rli2pvPal9EgRi2exjA08w4UMjqLwUCGLZ7GsBaYtqcz2ofBwVtAKiUFvRR3tKeCINI57zHmHgIwFfS0v3uqvrWeBm2NwnwygSLe89m2y/GBfjLToinZKb9vSC/NblLq0qkLgD0g7Q0/2wJBJgGuDXx+y23nt1x25V5A4SosWbgl2WlJdd+BeiqtLS2ZgBXAG77lwGmpaUta7YHvgVw102XgKi/dXH77pGtdK1RvdkS4Dtp6XcHA1RabD0Ij0pT/3QeJfggwWJvs33jxzEc9xEwPgHRiDS1Dc0U2O63IIHeyFvarhgAY4ISb54zV3wW1YZp29vP4Jf9VpSWfiQQoDpwfA3CxEwp0TexbcXlxsDVg2glgw4ULG0gKrG/3nX0p+UtidIwGF1KqPtqB5a5d4FdPOYPHnF6O05y3yZtex8y+HGAh6SV3FLrNwegMv2wf2yCmJ7NZ7VDcRMF2aVz3k4mfsdfU4J6G6ek4OvY8d4G8/O+0z92HRP1S1N7oREyZCCpdkQZff7Xcv01XL/zQ0tQu1g/D7KjhHDGM1ohrCTdg15KKGUCZJbtIubCyGnHsN1XAeyZTUrHifC+UHS+dihVglcz40mAN9UA7pGW/loYcCSA77ygY3kt/f05z1CkNoJEX/CPiRoWLE6cy2oybufEUiBusJux+x/gT7q4qzC8oWE0AAAAAElFTkSuQmCC",ti="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADfElEQVRYR9WXT2gUdxTHv++3YKSYWOjJmY0XEwsKFbOTFv9EzEHFHHpo1Yu9Zn8p1hRsCrY9qAf1oDaYKO5szl6MORTB0FyS+hfNb7dYULDGS7Mz4qGUxgpGyO/J7GxgdjOzM5pI6MAedt6f3+e933u/3xvCMj+0zOvj/wXQNjT9idCiA0T7wGwAtAYoB/Ec4OcMfQ0QYwVpFpNmNlEG2obcDqH1twB9mcwxj2ghzhe7jZtx+rEAVs4ZAOFwxVGRQGNMfDelxRReryiV3694nZ4TuoWYtjB4F4BM+T1jUPWYvfUg6gJYdukJQC2eAwL98M/sy/6p3tbZuKgs280C6AV4I8BTSqZbo2wiAay8cwuMbX4gfKAg08NxCwfln+WebZgjvlKGINxWWXN7mH0ogGWXTgL0o2egpBm7TVFgVRDgU0qmf6rVXeDcyk/vBYvrZUWtO9XXzRNvE3mtbnUmdJfKNo8GdRYAtOedG8zoADivZFouZvF5W78m2CbCzcmsuSMSIGP/tZuQ+rUcvCCr2G0UgsrzjgCSShr5pDJPz7Id5XUHY25PQa4dm7etykAm55whQh9Ao0oaXbXRW7ZzDMBx76ekeaIaIFpWARgE8A0zzhZ6zO9DASzbuQ1gKxF9NZk1Li8lQHvO/YKJRwDcUdIsd5ff3oHHst0pgNelWGy817Pm0VIC+MWoHwL0VEmjfLaEAbwAeFVqduXqe70fzSwpwMDfTXMNr/4F6D8ljcYogBmAG98zwAsljaaoGngMYP373QL8qaT5cThA3h0H886oo3dRXZB3PgfjFxBNqKzRGZWBQwAuEGh4UhoHlrIG2m33NIOPeq2opHkxFKAycDzwhIJ56/2e9N0gRMYu7SfQlbAM1ZO1DDxp+LDhgzsA2rTQm4rdzX+EAvgHRumqN3hEZaE2K0n+t9vuUQafBnhEyfS+oM2Cu8CffviGp8TgvoJMn0uySJTOfGY8uRa0o3ZKCr+O8+45MB/xjBZzHfsZddg/cehnlTW+qwWtM5D4HVHJxFsPJNal6Z0QYryyeFXl192CoDA4D3o1Qaz7awuzNqK2ITcjtM4C5I1lsXNh7LQT6P3KWjRKhMtC0+/BoVQL3syMgwDvDUAtuDUTb0FQcVnH8iDIpznX0qR3g8Su0A8T5t9SwLW4bUpcA4tpv6S2sTWQ1NG76i07wBsGL9kwcaf0IQAAAABJRU5ErkJggg==",oi={id:"shadowquery-panel",class:"sm-panel"},ii={class:"sm-function-module-sub-section",style:{margin:"0"}},ni={class:"sm-half-L"},ri={class:"sm-slider-input-box-M"},ai={class:"sm-half-L"},li={class:"sm-slider-input-box-M",style:{height:"34px"}},si={class:"sm-half-L"},ci={style:{width:"40%"}},di={class:"flex flex-start",style:{width:"35%","align-items":"center"}},ui={style:{width:"auto"}},pi={class:"sm-half-L"},mi={style:{width:"40%"}},hi={class:"boxchild flex-between",style:{padding:"0"}},yi={class:"flex flex-start",style:{width:"35%","align-items":"center"}},fi={style:{width:"auto"}},vi={class:"flex flex-end",style:{width:"auto"}},wi={id:"bubble",class:"bubble",ref:"bubble"},gi={class:"boxchild flex-between"},bi=e.createVNode("label",{style:{width:"auto"}},"分析结果",-1),Si={class:"flex flex-end",style:{width:"auto"}},Vi={class:"sm-half-L"},Di=e.createVNode("label",{class:"label-S"},"采光率",-1),Ni={class:"sm-half-L"},Ci=e.createVNode("label",{class:"label-S"},"经度",-1),Mi={class:"sm-half-L"},xi=e.createVNode("label",{class:"label-S"},"纬度",-1),Ri={class:"sm-half-L"},ki=e.createVNode("label",{class:"label-S"},"高程",-1),Li={class:"legend"},Pi=e.createVNode("img",{src:"public/img/other/legend_shadow.png",alt:""},null,-1);function Bi(n){var r,a,l,s,c,d=e.reactive({viewshedSpatialUrl:"http://www.supermapol.com/realspace/services/spatialAnalysis-data_all/restjsr/spatialanalyst/geometry/3d/viewshedbody.json",observerInformation:null,direction:1,pitch:1,addheight:1.8,distance:200,verticalFov:60,horizontalFov:90,hintLineColor:"rgb(212,202,45)",visibleAreaColor:"rgba(9,199,112,0.5)",hiddenAreaColor:"rgba(238,114,22,0.5)",visibleBodyColor:"rgba(9,199,112,0.7)",invisibleBodyColor:"rgba(238,114,22,0.7)",visibleBody:!1,invisibleBody:!1,viewshedAnimation:!1,DynamicLine:[],DynamicSpeed:10});if(n)for(var p in n)d.hasOwnProperty(p)?d[p]=n[p]:ae.Message.errorMsg(te.AttributeError+p);var m,h,y=!0,f=["public/data/s3m/car1.s3m"];function v(){console.log("可视域分析"),s=viewer.scene,r=new SuperMap3D.ViewShed3D(s),a=new SuperMap3D.ScreenSpaceEventHandler(s.canvas),r.hintLineColor=SuperMap3D.Color.fromCssColorString(d.hintLineColor),r.visibleAreaColor=SuperMap3D.Color.fromCssColorString(d.visibleAreaColor),r.hiddenAreaColor=SuperMap3D.Color.fromCssColorString(d.hiddenAreaColor),l=new SuperMap3D.S3MInstanceCollection(s._context),viewer.scene.primitives.add(l),(h=new SuperMap3D.DynamicLayer3D(s.context,f)).updateInterval=100,h.setCullEnabled(f[0],SuperMap3D.CullFace.BACK),h.maxVisibleAltitude=2e3,h.minVisibleAltitude=0,s.primitives.add(h)}t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),v()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),v())}));var w=null;function g(e){switch(e){case"LEFT_CLICK":a.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK);break;case"MOUSE_MOVE":a.removeInputAction(SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE);break;case"RIGHT_CLICK":a.removeInputAction(SuperMap3D.ScreenSpaceEventType.RIGHT_CLICK);break;case"ALL":default:a.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK),a.removeInputAction(SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),a.removeInputAction(SuperMap3D.ScreenSpaceEventType.RIGHT_CLICK)}}function b(){var e=r.getViewshedParameter(),t={viewerPoint:e.viewPosition,point3DsList:e.point3DList,radius:e.distance,lonlat:!0,viewShedType:"VISIBLEBODY"},n=JSON.stringify(t),a=SuperMap3D.Color.fromCssColorString(d.visibleBodyColor);window.axios.post(d.viewshedSpatialUrl,n).then((function(e){window.axios.get(e.data.newResourceLocation+".json").then((function(e){var t=e.data;if(null!=t.geometry){var n=new Uint8Array(t.geometry.model).buffer;l.add("VeiwshedBody",{id:1,position:SuperMap3D.Cartesian3.fromDegrees(t.geometry.position.x,t.geometry.position.y,t.geometry.position.z),hpr:new SuperMap3D.HeadingPitchRoll(0,0,0),color:a},n,!1),t.geometry.model=[4,0,0,0].concat(t.geometry.model),r.visibleAreaColor=SuperMap3D.Color.fromCssColorString("rgba(0,0,0,0)"),r.hiddenAreaColor=SuperMap3D.Color.fromCssColorString("rgba(0,0,0,0)"),t.geometry.name=te.VeiwshedBody,i.geometrys.VeiwshedBody=t.geometry,o.setGeometrys()}else ae.Message.errorMsg("获取geometry失败")})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}function S(){var e=r.getViewshedParameter(),t={viewerPoint:e.viewPosition,point3DsList:e.point3DList,radius:e.distance,lonlat:!0,viewShedType:"HIDDENBODY"},n=JSON.stringify(t),a=SuperMap3D.Color.fromCssColorString(d.invisibleBodyColor);window.axios.post(d.viewshedSpatialUrl,n).then((function(e){window.axios.get(e.data.newResourceLocation+".json").then((function(e){var t=e.data;if(null!=t.geometry){var n=new Uint8Array(t.geometry.model).buffer;l.add("VeiwshedBodyHidden",{id:1,position:SuperMap3D.Cartesian3.fromDegrees(t.geometry.position.x,t.geometry.position.y,t.geometry.position.z),hpr:new SuperMap3D.HeadingPitchRoll(0,0,0),color:a},n,!1),t.geometry.model=[4,0,0,0].concat(t.geometry.model),r.visibleAreaColor=SuperMap3D.Color.fromCssColorString("rgba(0,0,0,0)"),r.hiddenAreaColor=SuperMap3D.Color.fromCssColorString("rgba(0,0,0,0)"),t.geometry.name=te.VeiwshedBodyHidden,i.geometrys.VeiwshedBodyHidden=t.geometry,o.setGeometrys()}else ae.Message.errorMsg("获取geometry失败")})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}function V(){D(),h.clearState(f[0],[1]),clearInterval(m),m=null,d.viewshedAnimation=!1,ce("Polyline")}function D(){tooltip.setVisible(!1),viewer.entities.removeById("viewshedPoint"),document.body.classList.remove("measureCur"),r.distance=1e-5,r.viewPosition=[0,0,0],d.visibleBody=!1,d.invisibleBody=!1,d.observerInformation=null}function N(){r.distance=d.distance,r.build();for(var e=d.DynamicLine,t=[],o=1,i=e.length;o<i;o++)for(var n=e[o-1],a=e[o],l=SuperMap3D.Cartesian3.distance(n,a),s=parseInt(l/(.05*d.DynamicSpeed))+1,c=1,u=s;c<=u;c++)t.push(SuperMap3D.Cartesian3.lerp(n,a,c/s,new SuperMap3D.Cartesian3));var p=ae.CartesiantoDegreesObjs(t),y=new SuperMap3D.DynamicObjectState({id:1,longitude:p[0].longitude,latitude:p[0].latitude,altitude:p[0].height,scale:new SuperMap3D.Cartesian3(1,1,1)});h.updateObjectWithModel(f[0],[y]);var v=1;m=setInterval((function(){if(v>=p.length)clearInterval(m);else{y.longitude=p[v].longitude,y.latitude=p[v].latitude,y.altitude=p[v].height,h.updateObjectWithModel(f[0],[y]);var e=ae.getAngleAndRadian(t[v-1],t[v]);r.direction=e.angle,r.viewPosition=[y.longitude,y.latitude,y.altitude+Number(d.addheight)],v+=1}}),50)}function C(e){if(""!=e)return SuperMap3D.Color.fromCssColorString(e)}return e.watch((function(){return d.visibleBody}),(function(e){e&&d.observerInformation?b():(l.removeCollection("VeiwshedBody"),d.invisibleBody||(r.visibleAreaColor=SuperMap3D.Color.fromCssColorString(d.visibleAreaColor),r.hiddenAreaColor=SuperMap3D.Color.fromCssColorString(d.hiddenAreaColor)),i.geometrys.VeiwshedBody&&(delete i.geometrys.VeiwshedBody,o.setGeometrys()))})),e.watch((function(){return d.invisibleBody}),(function(e){e&&d.observerInformation?S():(l.removeCollection("VeiwshedBodyHidden"),d.visibleBody||(r.visibleAreaColor=SuperMap3D.Color.fromCssColorString(d.visibleAreaColor),r.hiddenAreaColor=SuperMap3D.Color.fromCssColorString(d.hiddenAreaColor)),i.geometrys.VeiwshedBodyHidden&&(delete i.geometrys.VeiwshedBodyHidden,o.setGeometrys()))})),e.watch((function(){return d.addheight}),(function(e){(""===e||e<0)&&(e=0),d.observerInformation&&(d.observerInformation[2]=w+parseFloat(e),r.viewPosition=d.observerInformation)})),e.watch((function(){return d.pitch}),(function(e){(""===e||e<0)&&(e=0),r.pitch=parseFloat(e)})),e.watch((function(){return d.direction}),(function(e){(""===e||e<0)&&(e=0),r.direction=parseFloat(e)})),e.watch((function(){return d.distance}),(function(e){(""===e||e<0)&&(e=0),r.distance=parseFloat(e)})),e.watch((function(){return d.verticalFov}),(function(e){(""===e||e<0)&&(e=0),r.verticalFov=parseFloat(e)})),e.watch((function(){return d.horizontalFov}),(function(e){(""===e||e<0)&&(e=0),r.horizontalFov=parseFloat(e)})),e.watch((function(){return d.hintLineColor}),(function(e){r.hintLineColor=C(e)})),e.watch((function(){return d.visibleAreaColor}),(function(e){r.visibleAreaColor=C(e)})),e.watch((function(){return d.visibleBodyColor}),(function(e){l.getInstance("VeiwshedBody",1).updateColor(C(e))})),e.watch((function(){return d.hiddenAreaColor}),(function(e){r.hiddenAreaColor=C(e)})),e.watch((function(){return d.invisibleBodyColor}),(function(e){l.getInstance("VeiwshedBodyHidden",1).updateColor(C(e))})),e.watch((function(){return d.viewshedAnimation}),(function(e){e?(D(),tooltip.showAt("<p>点击分析按钮激活事件</p><p>点击鼠标左键确认模型移动路线</p><p>单击右键结束分析</p>","450px"),setTimeout((function(){tooltip.setVisible(!1)}),3e3)):V()})),e.onBeforeUnmount((function(){V(),l.destroy(),r.destroy(),a.destroy(),DynamicLayer3D.destroy(),r=void 0,a=void 0,l=void 0})),u(u({},e.toRefs(d)),{},{analysis:function(){viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),d.viewshedAnimation?(m&&(V(),d.viewshedAnimation=!0,document.body.classList.add("measureCur")),function(){window.handlerPolyline||le("Polyline");if(n.DynamicLine)return void N();se("Polyline",SuperMap3D.ClampMode.Ground).then((function(e){var t=window.handlerPolyline;t.polyline.show=!1,window.polylineTransparent.show=!0,t.deactivate(),d.DynamicLine=e.result.object.positions,tooltip.setVisible(!1),d.DynamicLine.length<2?ae.Message.warnMsg("至少需要两个点！"):N()}),(function(e){console.log(e)})),window.handlerPolyline.activate()}()):(y&&(window.tooltip.showAt(" <p>点击鼠标左键确认观察者位置</p> <p>右键单击结束分析</p>","450px"),y=!1),l.removeCollection("VeiwshedBody"),l.removeCollection("VeiwshedBodyHidden"),r.distance=1e-5,r.visibleAreaColor=SuperMap3D.Color.fromCssColorString(d.visibleAreaColor),r.hiddenAreaColor=SuperMap3D.Color.fromCssColorString(d.hiddenAreaColor),a.setInputAction((function(e){w=null;var t=s.pickPosition(e.position);c=t;var o=ae.CartesiantoDegrees(t);w=o[2],o[2]+=Number(d.addheight),r.viewPosition=o,r.build(),d.observerInformation=o,document.body.classList.remove("measureCur"),g("LEFT_CLICK"),a.setInputAction((function(e){var t=e.endPosition,o=s.pickPosition(t);if(SuperMap3D.Cartesian3.distance(c,o)>0){var i=ae.CartesiantoDegrees(o);r.setDistDirByPoint(i)}}),SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),a.setInputAction((function(e){d.direction=r.direction.toFixed(2),d.pitch=r.pitch.toFixed(2),d.distance=r.distance.toFixed(2),d.horizontalFov=r.horizontalFov,d.verticalFov=r.verticalFov,d.visibleBody&&b(),d.invisibleBody&&S(),tooltip.setVisible(!1),g("MOUSE_MOVE"),g("RIGHT_CLICK")}),SuperMap3D.ScreenSpaceEventType.RIGHT_CLICK),function(e){viewer.entities.removeById("viewshedPoint"),viewer.entities.add(new SuperMap3D.Entity({id:"viewshedPoint",point:new SuperMap3D.PointGraphics({color:C(d.hiddenAreaColor),pixelSize:8}),position:e}))}(SuperMap3D.Cartesian3.fromDegrees(o[0],o[1],o[2]))}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK))},clear:V})}$o.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveComponent("el-date-picker"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",oi,[e.withDirectives(e.createVNode("div",ii,[e.createVNode("div",ni,[e.createVNode("div",ri,[e.createVNode(l,{modelValue:n.timeValue,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.timeValue=e}),max:96,step:.5,range:"",marks:n.marks,"tooltip-class":"tooltip-class","format-tooltip":n.formatTooltip,onChange:n.timeChanged},null,8,["modelValue","step","marks","format-tooltip","onChange"])]),e.withDirectives(e.createVNode("img",{src:ei,title:t.Resource.title1,style:{width:"36px",height:"36px","margin-top":"-20px"},onClick:o[2]||(o[2]=function(e){return n.sunLightForTime(!0)})},null,8,["title"]),[[e.vShow,n.showStartImgForTime]]),e.withDirectives(e.createVNode("img",{src:ti,title:t.Resource.title0,style:{width:"36px",height:"36px","margin-top":"-20px"},onClick:o[3]||(o[3]=function(e){return n.sunLightForTime(!1)})},null,8,["title"]),[[e.vShow,!n.showStartImgForTime]])]),e.createVNode("div",ai,[e.createVNode("div",li,[e.createVNode(s,{modelValue:n.currentDate,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.currentDate=e}),type:"date",size:"small",clearable:!1},null,8,["modelValue"])]),e.withDirectives(e.createVNode("img",{src:ei,title:t.Resource.title2,style:{width:"36px",height:"36px"},onClick:o[5]||(o[5]=function(e){return n.sunLightForDate(!0)})},null,8,["title"]),[[e.vShow,n.showStartImgForDate]]),e.withDirectives(e.createVNode("img",{src:ti,title:t.Resource.title0,style:{width:"36px",height:"36px"},onClick:o[6]||(o[6]=function(e){return n.sunLightForDate(!1)})},null,8,["title"]),[[e.vShow,!n.showStartImgForDate]])]),e.createVNode("div",si,[e.createVNode("label",ci,e.toDisplayString(t.Resource.stretchHeight),1),e.createVNode(l,{modelValue:n.extrudeHeight,"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.extrudeHeight=e}),min:0,max:150,step:1,"input-size":"mini",debounce:500,"format-tooltip":a.formatTooltip3,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","format-tooltip"]),e.createCommentVNode(' <input class="sm-input-S" min="1" step="1" type="number" v-model="clipWidth" /> ')]),e.createCommentVNode(' <div class="sm-half-L">\r\n        <label style="width: 40%;">分析间距</label>\r\n        <el-slider\r\n          v-model="spacing"\r\n          :min="0.5"\r\n          :max="50"\r\n          :step="0.5"\r\n          input-size="mini"\r\n          :debounce="500"\r\n          :format-tooltip="formatTooltip3"\r\n          tooltip-class="tooltip-class"\r\n          style="width:58%"\r\n        ></el-slider>\r\n      </div> '),e.createVNode("div",di,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox",style:{"margin-right":"10%"},"onUpdate:modelValue":o[8]||(o[8]=function(e){return n.shadowBodyShow=e})},null,512),[[e.vModelCheckbox,n.shadowBodyShow]]),e.createVNode("label",ui,e.toDisplayString(t.Resource.bodyShow),1)]),e.withDirectives(e.createVNode("div",pi,[e.createVNode("label",mi,e.toDisplayString(t.Resource.daylightFilter),1),e.createVNode(l,{modelValue:n.shadowBodyFilter,"onUpdate:modelValue":o[9]||(o[9]=function(e){return n.shadowBodyFilter=e}),min:0,max:100,range:"",step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",onChange:n.filterChanged,"format-tooltip":a.formatTooltip2,style:{width:"58%"}},null,8,["modelValue","onChange","format-tooltip"])],512),[[e.vShow,n.shadowBodyShow]]),e.createVNode("div",hi,[e.createVNode("div",yi,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox",style:{"margin-right":"10%"},"onUpdate:modelValue":o[10]||(o[10]=function(e){return n.shadowShow=e})},null,512),[[e.vModelCheckbox,n.shadowShow]]),e.createVNode("label",fi,e.toDisplayString(t.Resource.shadowShow),1)]),e.createVNode("div",vi,[e.createVNode("button",{onClick:o[11]||(o[11]=function(){return n.analysis&&n.analysis.apply(n,arguments)}),class:"tbtn tbtn-width",type:"button",style:""},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{onClick:o[12]||(o[12]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"tbtn tbtn-width tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])])],512),[[c]])],512),[[d]]),e.withDirectives(e.createVNode("div",wi,[e.createVNode("div",gi,[bi,e.createVNode("div",Si,[e.withDirectives(e.createVNode("i",{class:"el-icon-position",title:"停靠",style:{"margin-right":"8px"},onClick:o[13]||(o[13]=function(e){return n.dockBubble(!0)})},null,512),[[e.vShow,n.dockFontShow]]),e.withDirectives(e.createVNode("i",{class:"el-icon-chat-square",title:"悬浮",style:{"margin-right":"8px"},onClick:o[14]||(o[14]=function(e){return n.dockBubble(!1)})},null,512),[[e.vShow,!n.dockFontShow]]),e.createVNode("i",{class:"el-icon-close",title:"关闭",onClick:o[15]||(o[15]=function(){return n.closeBubble&&n.closeBubble.apply(n,arguments)})})])]),e.createVNode("div",Vi,[Di,e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[16]||(o[16]=function(e){return n.shadowRadio.shadowRadio=e})},null,512),[[e.vModelText,n.shadowRadio.shadowRadio]])]),e.createVNode("div",Ni,[Ci,e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[17]||(o[17]=function(e){return n.shadowRadio.longitude=e})},null,512),[[e.vModelText,n.shadowRadio.longitude]])]),e.createVNode("div",Mi,[xi,e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[18]||(o[18]=function(e){return n.shadowRadio.latitude=e})},null,512),[[e.vModelText,n.shadowRadio.latitude]])]),e.createVNode("div",Ri,[ki,e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[19]||(o[19]=function(e){return n.shadowRadio.height=e})},null,512),[[e.vModelText,n.shadowRadio.height]])])],512),[[e.vShow,n.shadowRadio.isShow]]),e.withDirectives(e.createVNode("div",Li,[Pi],512),[[e.vShow,n.legendShow]])],64)},$o.__file="src/components/analysis_3d/shadow-query/shadow-query.vue",$o.install=function(e){e.component($o.name,$o)};var Ti={name:"Sm3dViewshed",props:{viewshedSpatialUrl:{type:String},observerInformation:{type:Object},direction:{type:Number},pitch:{type:Number},addheight:{type:Number},distance:{type:Number},verticalFov:{type:Number},horizontalFov:{type:Number},hintLineColor:{type:String},visibleAreaColor:{type:String},hiddenAreaColor:{type:String},visibleBodyColor:{type:String},invisibleBodyColor:{type:String},visibleBody:{type:Boolean},invisibleBody:{type:Boolean},viewshedAnimation:{type:Boolean},DynamicLine:{type:Array},DynamicSpeed:{type:Number}},setup:function(e){var t=Bi(e),o=t.visibleBody,i=t.invisibleBody,n=t.viewshedAnimation,r=t.analysis,a=t.clear;return{addheight:t.addheight,verticalFov:t.verticalFov,horizontalFov:t.horizontalFov,hintLineColor:t.hintLineColor,visibleAreaColor:t.visibleAreaColor,hiddenAreaColor:t.hiddenAreaColor,visibleBodyColor:t.visibleBodyColor,invisibleBodyColor:t.invisibleBodyColor,visibleBody:o,invisibleBody:i,viewshedAnimation:n,analysis:r,clear:a}}},Ei={id:"viewshed",class:"sm-panel"},Ai={class:"sm-function-module-sub-section",style:{margin:"0"}},Ii={class:"sm-half-L"},Fi={style:{width:"35%"}},Ui={class:"sm-half-L"},_i={style:{width:"35%"}},Oi={class:"sm-half-L"},Hi={style:{width:"35%"}},zi={class:"sm-half-L"},Gi={style:{width:"35%"}},ji={class:"sm-half-L"},Wi={style:{width:"35%"}},Ki={class:"sm-half-L"},Qi={style:{width:"35%"}},Xi={class:"sm-half-L"},Yi={style:{width:"35%"}},Zi={class:"sm-half-L"},qi={style:{width:"35%"}},Ji={class:"sm-half-L"},$i={style:{width:"auto"}},en={style:{width:"auto"}},tn={style:{width:"auto"}},on={class:"boxchild"};function nn(o){var i,n,r,a=e.reactive({profile2d:!0,polylineColor:"rgb(250, 213, 6)",polylineWidth:5,initEchartsOption:null,updateEchartsOption:null});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);var s=!0,c=[],d=[],p=null,m=e.ref(null);function h(){window.echarts?(i||(i=window.echarts.init(m.value),window.onresize=function(){i.resize()}),a.initEchartsOption?i.setOption(a.initEchartsOption):i.setOption({title:{text:"剖面分析",textStyle:{fontSize:14}},grid:{left:30,right:0,top:30,bottom:8},tooltip:{},xAxis:{data:[]},yAxis:{data:[]},series:[{type:"bar",data:[]}]})):ae.Message.warnMsg(te.EchartsErr)}function y(e,t){a.profile2d=!0,i.clear(),i.showLoading(),c.length=0,d.length=0;for(var o=[],l=1,s=t.length;l<s;l++){var u=t[l-1],p=t[l],m=SuperMap3D.Cartesian3.distance(u,p);f(parseInt(m));for(var h=1,y=n;h<=y;h++)o.push(SuperMap3D.Cartesian3.lerp(u,p,h/n,new SuperMap3D.Cartesian3))}viewer.scene.clampToHeightMostDetailed(o).then((function(e){d=e,c=ae.CartesiantoDegreesObjs(d),function(){if(i.hideLoading(),i.clear(),a.updateEchartsOption)return void i.setOption(a.updateEchartsOption);var e={title:{text:"剖面信息",textStyle:{fontSize:14}},grid:{left:50,right:8,top:40,bottom:20},tooltip:{trigger:"axis",backgroundColor:"#ffffff",textStyle:{color:"#000"},formatter:function(e){var t=e[0].dataIndex;return r=d[t],['当前位置: <hr size=1 style="margin: 3px 0">',"经度: "+c[t].longitude.toFixed(6)+"<br/>","纬度: "+c[t].latitude.toFixed(6)+"<br/>","海拔: "+c[t].height.toFixed(2)+"米<br/>"].join("")}},xAxis:{data:c.map((function(e,t){return t})),show:!1},yAxis:{min:function(e){return e.min<20?0:Math.floor(e.min)},axisLabel:{interval:"auto",formatter:function(e,t){return e>999?(e/1e3).toFixed(2)+"km":e+"m"}},splitLine:{show:!0}},toolbox:{left:"right",feature:{saveAsImage:{}}},dataZoom:[{type:"inside",xAxisIndex:0,filterMode:"filter",start:0,end:100}],series:{name:"height",type:"line",data:c.map((function(e){return e.height})),areaStyle:{}}};i.setOption(e)}()}))}function f(e){n=e/1e4>1?parseInt(e/100):e/1e3>5?parseInt(e/10):e/1e3>2?parseInt(e/5):e/1e3>1?parseInt(e/2):e/100>5?parseInt(e/1.5):e/100>2?e:2*e}function v(){a.profile2d=!1,viewer.entities.removeById("location4"),viewer.entities.removeById("polyline-profile"),i.clear(),c.length=0,d.length=0,ce("Polyline"),ye(),h(),tooltip.setVisible(!1)}return e.onMounted((function(){h()})),t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element))),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)))})),e.watch((function(){return a.profile2d}),(function(e){e&&i?setTimeout((function(){i.resize()}),200):a.getSkyline2d=!1})),e.onBeforeUnmount((function(){v(),i.clear(),c.length=0,d.length=0})),u(u({},e.toRefs(a)),{},{echarts_box:m,myChart:i,Entypositions:r,LatAndLons:c,Cartesians:d,analysis:function(){s&&(tooltip.showAt(" <p>点击鼠标左键开始绘制</p> <p>单击右键结束分析</p><p>选中可进行编辑</p>","250px"),s=!1),window.handlerPolyline||le("Polyline"),se("Polyline").then((function(e){i.showLoading(),p=e.positions,function(e){viewer.entities.removeById("polyline-profile"),viewer.entities.removeById("location4");var t=SuperMap3D.Color.fromCssColorString(a.polylineColor);viewer.entities.add({id:"polyline-profile",polyline:{positions:SuperMap3D.Cartesian3.fromDegreesArrayHeights(e),width:a.polylineWidth,material:t,clampToGround:!0}}),function(){if(viewer.entities.getById("location4"))return;viewer.entities.add({id:"location4",position:new SuperMap3D.CallbackProperty((function(){return r}),!1),billboard:{image:"src/style/images/location4.png",width:30,height:40,scaleByDistance:new SuperMap3D.NearFarScalar(10,1,2e3,.6),eyeOffset:new SuperMap3D.Cartesian3(0,1,-5)}})}()}(e.positions);var t=window.handlerPolyline;t.polyline.show=!1,window.polylineTransparent.show=!1,t.deactivate(),y("",e.result.positions),he(p,!1,y),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()},clear:v})}Ti.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveComponent("el-color-picker"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Ei,[e.withDirectives(e.createVNode("div",Ai,[e.createVNode("div",Ii,[e.createVNode("label",Fi,e.toDisplayString(t.Resource.addheight),1),e.createVNode(l,{modelValue:n.addheight,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.addheight=e}),min:1,step:.1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",Ui,[e.createVNode("label",_i,e.toDisplayString(t.Resource.verticalFov),1),e.createVNode(l,{modelValue:n.verticalFov,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.verticalFov=e}),min:1,max:179,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Oi,[e.createVNode("label",Hi,e.toDisplayString(t.Resource.horizontalFov),1),e.createVNode(l,{modelValue:n.horizontalFov,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.horizontalFov=e}),min:1,max:179,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",zi,[e.createVNode("label",Gi,e.toDisplayString(t.Resource.hintLineColor),1),e.createVNode(s,{modelValue:n.hintLineColor,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.hintLineColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.withDirectives(e.createVNode("div",ji,[e.createVNode("label",Wi,e.toDisplayString(t.Resource.visibleAreaColor),1),e.createVNode(s,{modelValue:n.visibleAreaColor,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.visibleAreaColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,!n.visibleBody&&!n.invisibleBody]]),e.withDirectives(e.createVNode("div",Ki,[e.createVNode("label",Qi,e.toDisplayString(t.Resource.hiddenAreaColor),1),e.createVNode(s,{modelValue:n.hiddenAreaColor,"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.hiddenAreaColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,!n.visibleBody&&!n.invisibleBody]]),e.withDirectives(e.createVNode("div",Xi,[e.createVNode("label",Yi,e.toDisplayString(t.Resource.visibleBodyColor),1),e.createVNode(s,{modelValue:n.visibleBodyColor,"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.visibleBodyColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,n.visibleBody]]),e.withDirectives(e.createVNode("div",Zi,[e.createVNode("label",qi,e.toDisplayString(t.Resource.invisibleBodyColor),1),e.createVNode(s,{modelValue:n.invisibleBodyColor,"onUpdate:modelValue":o[8]||(o[8]=function(e){return n.invisibleBodyColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,n.invisibleBody]]),e.createVNode("div",Ji,[e.createVNode("label",$i,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=function(e){return n.visibleBody=e})},null,512),[[e.vModelCheckbox,n.visibleBody]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.displayVisualsBody),1)]),e.createVNode("label",en,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[10]||(o[10]=function(e){return n.invisibleBody=e})},null,512),[[e.vModelCheckbox,n.invisibleBody]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.displayInvisibleBody),1)]),e.createVNode("label",tn,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=function(e){return n.viewshedAnimation=e})},null,512),[[e.vModelCheckbox,n.viewshedAnimation]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.viewshedAnimation),1)])]),e.createVNode("div",on,[e.createVNode("button",{type:"button",class:"tbtn",onClick:o[12]||(o[12]=function(){return n.analysis&&n.analysis.apply(n,arguments)})},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:o[13]||(o[13]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[c]])],512)),[[d]])},Ti.__file="src/components/analysis_3d/viewshed/viewshed.vue",Ti.install=function(e){e.component(Ti.name,Ti)};var rn={name:"Sm3dProfile",props:{profile2d:{type:Boolean,default:!0},polylineColor:{type:String},polylineWidth:{type:Number},initEchartsOption:{type:Object},updateEchartsOption:{type:Object}},setup:function(e){var t=nn(e);return{profile2d:t.profile2d,analysis:t.analysis,clear:t.clear,echarts_box:t.echarts_box}}},an={id:"profile",class:"sm-panel"},ln={class:"sm-function-module-sub-section",style:{margin:"0"}},sn={class:"sm-half-L"},cn={style:{width:"80%"}},dn={class:"boxchild flex-between"},un={ref:"echarts_box",id:"echarts_box"};rn.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",an,[e.withDirectives(e.createVNode("div",ln,[e.createVNode("div",sn,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.profile2d=e})},null,512),[[e.vModelCheckbox,n.profile2d]]),e.createVNode("label",cn,e.toDisplayString(t.Resource.profileInformation),1)]),e.createVNode("div",dn,[e.createVNode("button",{type:"button",class:"tbtn",onClick:o[2]||(o[2]=function(){return n.analysis&&n.analysis.apply(n,arguments)})},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:o[3]||(o[3]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[l]])],512),[[s]]),e.withDirectives(e.createVNode("div",un,null,512),[[e.vShow,n.profile2d]])],64)},rn.__file="src/components/analysis_3d/profile/profile.vue",rn.install=function(e){e.component(rn.name,rn)};var pn=function(){function e(t,o,i,n){a(this,e),this.viewer=t,this.id_type=o,this.pickedEntity=null,this.leftDownFlag=!1,this.moveEndCallBack=i||void 0,this.leftUpCallBack=n||void 0,this.movePickedEntity=null,this.layers=t.scene.layers.layerQueue}return s(e,[{key:"addEventListener",value:function(){for(var e=this,t=0;t<e.layers.length;t++)e.layers[t].selectEnabled=!1;e.viewer.screenSpaceEventHandler.setInputAction((function(t){var o=e.viewer.scene.pick(t.position);if(e.leftDownFlag=!0,o){var i=SuperMap3D.defaultValue(o.id,o.primitive.id);i.id&&i.id.includes(e.id_type)&&(e.pickedEntity=i,e.viewer.scene.screenSpaceCameraController.enableRotate=!1)}}),SuperMap3D.ScreenSpaceEventType.LEFT_DOWN),e.viewer.screenSpaceEventHandler.setInputAction((function(t){e.leftDownFlag=!1,e.viewer.scene.screenSpaceCameraController.enableRotate=!0,e.leftUpCallBack&&e.pickedEntity&&e.leftUpCallBack(e.pickedEntity);e.pickedEntity=null}),SuperMap3D.ScreenSpaceEventType.LEFT_UP),e.viewer.screenSpaceEventHandler.setInputAction((function(t){if(e.leftDownFlag){if(e.pickedEntity){var o=e.viewer.scene.pickPosition(t.endPosition);e.pickedEntity.position=o,e.moveEndCallBack&&e.moveEndCallBack(e.pickedEntity)}}else{var i=e.viewer.scene.pick(t.endPosition);if(i){var n=SuperMap3D.defaultValue(i.id,i.primitive.id);n.id&&n.id.includes(e.id_type)?(e.movePickedEntity=n,n.point.pixelSize=20):e.movePickedEntity&&(e.movePickedEntity.point.pixelSize=10)}else e.movePickedEntity&&(e.movePickedEntity.point.pixelSize=10)}}),SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE)}},{key:"removeEventListener",value:function(){this.viewer.screenSpaceEventHandler.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_DOWN),this.viewer.screenSpaceEventHandler.removeInputAction(SuperMap3D.ScreenSpaceEventType.MOUSE_MOVE),this.viewer.screenSpaceEventHandler.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_UP)}}]),e}();function mn(o){var i,n,r,a=e.reactive({viewPosition:null,visibleColor:"rgb(0, 200, 0)",hiddenColor:"rgb(200, 0, 0)",barrierColor:"rgba(255, 186, 1, 1)",highlightBarrier:!1,lineWidth:3,showBarrierPoints:!0});if(o)for(var l in o)a.hasOwnProperty(l)?null!=o[l]&&(a[l]=o[l]):ae.Message.errorMsg(te.AttributeError+l);var s,c,d=!0,p=!1,m=[],h=0,y=[],f=[],v=[];function w(){i=viewer.scene,(n=new SuperMap3D.Sightline(i)).visibleColor=SuperMap3D.Color.fromCssColorString(a.visibleColor),n.hiddenColor=SuperMap3D.Color.fromCssColorString(a.hiddenColor),n.lineWidth=Number(a.lineWidth),r=new pn(viewer,"sightPoint_",N,C)}function b(e){p=!0,clearTimeout(s),s=setTimeout((function(){p=!1}),20);var t=i.pickPosition(e.message.position),o=ae.CartesiantoDegrees(t);o[2]<0&&(o[2]=0,t=SuperMap3D.Cartesian3.fromDegrees(o[0],o[1],o[2])),a.viewPosition?(n.addTargetPoint({position:o,name:"sightPoint_Target"+h}),y.push(t),requestAnimationFrame((function(){requestAnimationFrame((function(){n.getBarrierPoint("sightPoint_Target"+h,(function(e){var t;if(t=h,viewer.entities.add(new SuperMap3D.Entity({id:"sightPoint_Target"+t,point:new SuperMap3D.PointGraphics({color:new SuperMap3D.CallbackProperty((function(){return SuperMap3D.Color.fromCssColorString(v[t])}),!1),pixelSize:10}),position:new SuperMap3D.CallbackProperty((function(){return y[t]}),!1)})),e&&e.position){e.position.height+=2;var o=SuperMap3D.Cartographic.toCartesian(e.position);f.push(o);var i=n.getObjectIds();m.push(i),v.push(a.hiddenColor)}else f.push({x:6378137,y:0,z:0}),v.push(a.visibleColor);!function(e){var t=viewer.entities.add({name:"Point_Barrier"+e,position:new SuperMap3D.CallbackProperty((function(){return f[e]}),!1),cylinder:{length:3,topRadius:2,bottomRadius:0,material:SuperMap3D.Color.fromCssColorString("#d60000")}});S.push(t)}(h),h+=1}))}))}))):(n.viewPosition=o,a.viewPosition=o,n.build(),viewer.entities.add(new SuperMap3D.Entity({id:"sightPoint_view",point:new SuperMap3D.PointGraphics({color:SuperMap3D.Color.fromCssColorString(a.barrierColor),pixelSize:10}),position:new SuperMap3D.CallbackProperty((function(){return c}),!1)})),c=t)}t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),w()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),w())}));var S=[];function V(e){if(a.viewPosition&&!p){var t=i.pickPosition(e.message.endPosition),o=ae.CartesiantoDegrees(t);n.addTargetPoint({position:o,name:"point"})}}function D(){window.tooltip.setVisible(!1),document.body.classList.remove("measureCur"),a.highlightBarrier&&M(),n.removeTargetPoint("point"),n.build(),r.addEventListener(),viewer.eventManager.removeEventListener("CLICK",b),viewer.eventManager.removeEventListener("MOUSE_MOVE",V),viewer.eventManager.removeEventListener("RIGHT_CLICK",D)}function N(e){if(e.id)if(e.id.includes("sightPoint_Target")){var t=ae.CartesiantoDegrees(e.position._value);n.addTargetPoint({position:t,name:e.id})}else if(e.id.includes("sightPoint_view")){var o=ae.CartesiantoDegrees(e.position._value);n.viewPosition=o}}function C(e){requestAnimationFrame((function(){requestAnimationFrame((function(){if(e.id)if(e.id.includes("sightPoint_view"))for(var t=0,o=f.length;t<o;t++)r("sightPoint_Target"+t,!0);else e.id.includes("sightPoint_Target")&&r(e.id);function r(t,o){n.getBarrierPoint(t,(function(r){var l=t.charAt(t.length-1);if(r&&r.position){r.position.height+=2;var s,c=SuperMap3D.Cartographic.toCartesian(r.position);if(o){var d=n._targetPoints.values[l],u=SuperMap3D.Cartesian3.fromDegrees(d[0],d[1],d[2]);s=SuperMap3D.Cartesian3.distance(u,c)}else s=SuperMap3D.Cartesian3.distance(e.position._value,c);s>=2.5?(f[l]=c,v[l]=a.hiddenColor):(f[l]={x:6378137,y:0,z:0},v[l]=a.visibleColor);var p=n.getObjectIds();if(m.splice(l,1,p),a.highlightBarrier){var h,y=g(i.layers.layerQueue);try{for(y.s();!(h=y.n()).done;){h.value.removeAllObjsColor()}}catch(e){y.e(e)}finally{y.f()}M()}}else f[l]={x:6378137,y:0,z:0},v[l]=a.visibleColor}))}}))}))}function M(e){var t=SuperMap3D.defaultValue(e,SuperMap3D.Color.fromCssColorString(a.barrierColor)),o=viewer.scene.layers.layerQueue,i=m[m.length-1],n=i[String(Object.keys(i))];console.log("barrierIds:",n),o.forEach((function(e){"Building@CBD"===e._name&&e.setObjsColor(n,t)}))}function x(){n.removeAllTargetPoint();var e,t=g(i.layers.layerQueue);try{for(t.s();!(e=t.n()).done;){e.value.removeAllObjsColor()}}catch(e){t.e(e)}finally{t.f()}h=0,m.length=0,y.length=0,f.length=0,v.length=0,r.removeEventListener(),viewer.entities.removeAll(),document.body.classList.remove("measureCur"),window.tooltip.setVisible(!1),a.viewPosition=null,S.length=0,viewer.eventManager.removeEventListener("CLICK",b),viewer.eventManager.removeEventListener("MOUSE_MOVE",V),viewer.eventManager.removeEventListener("RIGHT_CLICK",D)}return e.watch((function(){return a.lineWidth}),(function(e){n&&(n.lineWidth=Number(e))})),e.watch((function(){return a.visibleColor}),(function(e){n&&(n.visibleColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.hiddenColor}),(function(e){n&&(n.hiddenColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.barrierColor}),(function(e){0!==m.length&&M(SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.highlightBarrier}),(function(e){if(e)M();else{var t,o=g(i.layers.layerQueue);try{for(o.s();!(t=o.n()).done;){t.value.removeAllObjsColor()}}catch(e){o.e(e)}finally{o.f()}}})),e.watch((function(){return a.showBarrierPoints}),(function(e){0!==S.length&&S.forEach((function(t){t.show=e}))})),e.onBeforeUnmount((function(){x(),n=void 0})),u(u({},e.toRefs(a)),{},{analysis:function(){viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),d&&(window.tooltip.showAt(" <p>点击鼠标左键确认观察者位置</p><p>再点击左键确认目标位置</p> <p>右键单击结束分析</p>","400px"),d=!1),r.removeEventListener(),viewer.eventManager.addEventListener("CLICK",b,!0),viewer.eventManager.addEventListener("MOUSE_MOVE",V),viewer.eventManager.addEventListener("RIGHT_CLICK",D,!0)},clear:x})}var hn={name:"Sm3dSightline",props:{viewPosition:{type:Array},visibleColor:{type:String,default:"rgb(0, 200, 0)"},hiddenColor:{type:String,default:"rgb(200, 0, 0)"},barrierColor:{type:String,default:"rgba(255, 186, 1, 1)"},highlightBarrier:{type:Boolean,default:!1},lineWidth:{type:Number,default:3},showBarrierPoints:{type:Boolean,default:!0}},setup:function(e){var t=mn(e);return{lineWidth:t.lineWidth,visibleColor:t.visibleColor,hiddenColor:t.hiddenColor,barrierColor:t.barrierColor,highlightBarrier:t.highlightBarrier,showBarrierPoints:t.showBarrierPoints,analysis:t.analysis,clear:t.clear}}},yn={id:"sight-line",class:"sm-panel"},fn={class:"sm-function-module-sub-section",style:{margin:"0"}},vn={class:"sm-half-L"},wn={style:{width:"35%"}},gn={class:"sm-half-L"},bn={style:{width:"35%"}},Sn={class:"sm-half-L"},Vn={style:{width:"35%"}},Dn={class:"sm-half-L"},Nn={style:{width:"35%"}},Cn={class:"sm-half-L"},Mn={style:{width:"auto"}},xn={style:{width:"auto"}},Rn={class:"boxchild "};function kn(o){var i=e.reactive({addHeight:1,viewPosition:null,viewDomeRadius:100,domeType:"ALLDOME",isClosed:!1,visibleAreaColor:"rgba(9,199,112,0.5)",hiddenAreaColor:"rgba(238,114,22,0.5)",startAngle:0,endAngle:360});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r,a,l,s=!0;function c(){r=viewer.scene,(a=new SuperMap3D.ViewDome(r)).viewPosition=[0,0,0],a.distance=Number(i.viewDomeRadius),a.domeType=SuperMap3D.ViewDomeType[i.domeType],a.visibleAreaColor=SuperMap3D.Color.fromCssColorString(i.visibleAreaColor),a.hiddenAreaColor=SuperMap3D.Color.fromCssColorString(i.hiddenAreaColor),a.startAngle=Number(i.startAngle),a.endAngle=Number(i.endAngle),a.isClosed=i.isClosed,a.build()}function d(e){viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur");var t=r.pickPosition(e.message.position),o=ae.CartesiantoDegrees(t);o[2]+=Number(i.addHeight),i.viewPosition={longitude:o[0].toFixed(6),latitude:o[1].toFixed(6),height:o[2].toFixed(2)},a.viewPosition=o,a.build(),window.tooltip.setVisible(!1),viewer.eventManager.removeEventListener("CLICK",d),viewer.eventManager.removeEventListener("MOUSE_MOVE",p),a.startAngle=Number(i.startAngle)}function p(e){l=r.pickPosition(e.message.endPosition)}function m(){viewer.entities.removeById("opennessPoint"),document.body.classList.remove("measureCur"),window.tooltip.setVisible(!1),i.viewPosition=null,a.viewPosition=[0,0,0],a.startAngle=Number(i.startAngle)}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),c()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),c())})),e.watch((function(){return i.viewDomeRadius}),(function(e){""!=e&&(a.distance=Number(e))})),e.watch((function(){return i.domeType}),(function(e){""!=e&&(a.domeType=SuperMap3D.ViewDomeType[e])})),e.watch((function(){return i.isClosed}),(function(e){""!=e&&(a.isClosed=e)})),e.watch((function(){return i.startAngle}),(function(e){""!=e&&(a.startAngle=Number(e))})),e.watch((function(){return i.endAngle}),(function(e){""!=e&&(a.endAngle=Number(e))})),e.watch((function(){return i.visibleAreaColor}),(function(e){if(""!=e){var t=SuperMap3D.Color.fromCssColorString(e);a.visibleAreaColor=t}})),e.watch((function(){return i.hiddenAreaColor}),(function(e){if(""!=e){var t=SuperMap3D.Color.fromCssColorString(e);a.hiddenAreaColor=t}})),e.watch((function(){return i.addHeight}),(function(e,t){var o=e-t;o=SuperMap3D.defaultValue(o,0),a.viewPosition[2]+=Number(o),l=SuperMap3D.Cartesian3.fromDegrees(a.viewPosition[0],a.viewPosition[1],a.viewPosition[2]),a.startAngle=Number(i.startAngle)})),e.onBeforeUnmount((function(){m(),a.destroy(),a=void 0})),u(u({},e.toRefs(i)),{},{analysis:function(){viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),s&&(window.tooltip.showAt(" <p>点击鼠标左键确认分析位置</p>","250px"),s=!1),viewer.entities.removeById("opennessPoint"),viewer.entities.add(new SuperMap3D.Entity({id:"opennessPoint",point:new SuperMap3D.PointGraphics({color:SuperMap3D.Color.fromCssColorString("rgba(238,114,22,1)"),pixelSize:8}),position:new SuperMap3D.CallbackProperty((function(){return l}),!1)})),viewer.eventManager.addEventListener("CLICK",d,!0),viewer.eventManager.addEventListener("MOUSE_MOVE",p,!0)},clear:m})}hn.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveComponent("el-color-picker"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",yn,[e.withDirectives(e.createVNode("div",fn,[e.createVNode("div",vn,[e.createVNode("label",wn,e.toDisplayString(t.Resource.lineWidth),1),e.createVNode(l,{modelValue:n.lineWidth,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.lineWidth=e}),min:1,step:1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",gn,[e.createVNode("label",bn,e.toDisplayString(t.Resource.visibleColor),1),e.createVNode(s,{modelValue:n.visibleColor,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.visibleColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Sn,[e.createVNode("label",Vn,e.toDisplayString(t.Resource.hiddenColor),1),e.createVNode(s,{modelValue:n.hiddenColor,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.hiddenColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Dn,[e.createVNode("label",Nn,e.toDisplayString(t.Resource.barrierColor),1),e.createVNode(s,{modelValue:n.barrierColor,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.barrierColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Cn,[e.createVNode("label",Mn,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.showBarrierPoints=e})},null,512),[[e.vModelCheckbox,n.showBarrierPoints]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.showBarrierPoints),1)]),e.createVNode("label",xn,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.highlightBarrier=e})},null,512),[[e.vModelCheckbox,n.highlightBarrier]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.highlightBarrier),1)])]),e.createVNode("div",Rn,[e.createVNode("button",{type:"button",class:"tbtn",onClick:o[7]||(o[7]=function(){return n.analysis&&n.analysis.apply(n,arguments)})},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:o[8]||(o[8]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[c]])],512)),[[d]])},hn.__file="src/components/analysis_3d/sight-line/sight-line.vue",hn.install=function(e){e.component(hn.name,hn)};var Ln={name:"Sm3dOpenness",props:{addHeight:{type:Number},viewPosition:{type:Array},viewDomeRadius:{type:Number},domeType:{type:String},isClosed:{type:Boolean},visibleAreaColor:{type:String},hiddenAreaColor:{type:String},startAngle:{type:Number},endAngle:{type:Number}},methods:{formatTooltip:function(e){return e+"米"}},setup:function(e){var t=kn(e);return{addHeight:t.addHeight,viewDomeRadius:t.viewDomeRadius,domeType:t.domeType,isClosed:t.isClosed,visibleAreaColor:t.visibleAreaColor,hiddenAreaColor:t.hiddenAreaColor,startAngle:t.startAngle,endAngle:t.endAngle,analysis:t.analysis,clear:t.clear}}},Pn=e.withScopeId("data-v-8f58fc18");e.pushScopeId("data-v-8f58fc18");var Bn={id:"openness-panel",class:"sm-panel"},Tn={class:"sm-function-module-sub-section",style:{margin:"0"}},En={class:"sm-half-L"},An={style:{width:"35%"}},In={class:"sm-half-L"},Fn={style:{width:"35%"}},Un={class:"sm-half-L"},_n={style:{width:"35%"}},On={class:"sm-half-L"},Hn={style:{width:"35%"}},zn={class:"sm-half-L"},Gn={style:{width:"35%"}},jn={class:"sm-half-L"},Wn={style:{width:"35%"}},Kn={class:"sm-half-L"},Qn={style:{width:"35%"}},Xn={value:"ALLDOME"},Yn={value:"VISIBLEDOME"},Zn={value:"HIDDENDOME"},qn={class:"sm-half-L"},Jn={style:{width:"auto"}},$n={class:"boxchild"};e.popScopeId();var er=Pn((function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveComponent("el-color-picker"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Bn,[e.withDirectives(e.createVNode("div",Tn,[e.createVNode("div",En,[e.createVNode("label",An,e.toDisplayString(t.Resource.addheight),1),e.createVNode(l,{modelValue:n.addHeight,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.addHeight=e}),min:0,step:.1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",In,[e.createVNode("label",Fn,e.toDisplayString(t.Resource.startAngle),1),e.createVNode(l,{modelValue:n.startAngle,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.startAngle=e}),min:0,max:360,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Un,[e.createVNode("label",_n,e.toDisplayString(t.Resource.endAngle),1),e.createVNode(l,{modelValue:n.endAngle,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.endAngle=e}),min:0,max:360,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",On,[e.createVNode("label",Hn,e.toDisplayString(t.Resource.observeRadius),1),e.createVNode(l,{modelValue:n.viewDomeRadius,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.viewDomeRadius=e}),min:1,step:1,max:1e3,"input-size":"mini",debounce:500,"format-tooltip":a.formatTooltip,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","format-tooltip"]),e.createCommentVNode(' <input class="sm-input-S" min="1" step="1" type="number" v-model="clipWidth" /> ')]),e.createVNode("div",zn,[e.createVNode("label",Gn,e.toDisplayString(t.Resource.visibleAreaColor),1),e.createVNode(s,{modelValue:n.visibleAreaColor,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.visibleAreaColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",jn,[e.createVNode("label",Wn,e.toDisplayString(t.Resource.hiddenAreaColor),1),e.createVNode(s,{modelValue:n.hiddenAreaColor,"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.hiddenAreaColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Kn,[e.createVNode("label",Qn,e.toDisplayString(t.Resource.displayMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.domeType=e})},[e.createVNode("option",Xn,e.toDisplayString(t.Resource.allShow),1),e.createVNode("option",Yn,e.toDisplayString(t.Resource.visibleShow),1),e.createVNode("option",Zn,e.toDisplayString(t.Resource.hiddenShow),1)],512),[[e.vModelSelect,n.domeType]])]),e.createVNode("div",qn,[e.createVNode("label",Jn,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=function(e){return n.isClosed=e})},null,512),[[e.vModelCheckbox,n.isClosed]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.isClosed),1)])]),e.createVNode("div",$n,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[9]||(o[9]=function(){return n.analysis&&n.analysis.apply(n,arguments)})},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{onClick:o[10]||(o[10]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"tbtn",style:{"margin-left":"4px"},type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[c]])],512)),[[d]])}));function tr(o){var n=e.reactive({layerNames:[],selectedLayerName:null,scale:3,positionMode:"intersects",Xpitch:0,Yroll:0,Zheading:0,geometryType:"box",drawType:"Fill_And_WireFrame",FillColor:"rgba(192,211,25,0.5)",WireFrameColor:"rgba(89,129,228,0.8)",searchColor:"rgba(255, 186, 1, 1)",GeometryBodyNames:[],boxParameters:[100,100,100],sphereParameters:[100],coneParameters:[100,200],cylinderParameters:[100,100,200],ellicpseParameters:[100,50,50],rotateOrigin:null});if(o)for(var r in o)n.hasOwnProperty(r)?n[r]=o[r]:ae.Message.errorMsg(te.AttributeError+r);var a,l,s,c,d,p=!0,m=[];function h(){if(n.GeometryBodyNames=[],m=[],i.geometrys)for(var e in i.geometrys){m.push(e);var t=i.geometrys[e].name;n.GeometryBodyNames.includes(t)||n.GeometryBodyNames.push(t)}0===n.GeometryBodyNames.length&&(o&&o.geometryType?n.geometryType=o.geometryType:n.geometryType="box")}function y(){a=viewer.scene,l=viewer.scene.layers.layerQueue,(s=new SuperMap3D.SpatialQuery3D(a)).outlineColor=SuperMap3D.Color.fromCssColorString(n.WireFrameColor),s.fillColor=SuperMap3D.Color.fromCssColorString(n.FillColor),s.fillStyle=SuperMap3D.FillStyle[n.drawType],g(n.geometryType),b(n.positionMode),s.build(),setTimeout((function(){0===n.layerNames.length&&f()}),1e3),d=new SuperMap3D.S3MInstanceCollection(a._context),viewer.scene.primitives.add(d)}function f(){var e=w(n.selectedLayerName);s&&s.layers&&(s.layers=e?[e]:[]),n.layerNames.length=0,l&&l.length>0&&(l.forEach((function(e,t){n.layerNames.includes(e._name)||n.layerNames.push(e._name)})),n.selectedLayerName||(n.selectedLayerName=n.layerNames[0]))}function v(e){document.body.classList.remove("measureCur");var t=a.pickPosition(e.message.position);S(ae.CartesiantoDegrees(t)),tooltip.setVisible(!1),viewer.eventManager.removeEventListener("CLICK",v)}function w(e){return l.find((function(t,o){return t._name===e}))}function g(e){switch(e){case"box":var t=n.boxParameters;c=new SuperMap3D.GeoBox(t[0],t[1],t[2]);break;case"sphere":var o=n.sphereParameters;c=new SuperMap3D.GeoSphere(o[0]);break;case"cone":var r=n.coneParameters;c=new SuperMap3D.GeoCone(r[0],r[1]),n.rotateOrigin&&(c.rotateOrigin="APEX"==n.rotateOrigin?SuperMap3D.RotationOrigin.APEX:SuperMap3D.RotationOrigin.CENTER);break;case"cylinder":var a=n.cylinderParameters;c=new SuperMap3D.GeoCylinder(a[0],a[1],a[2]);break;case"ellicpse":var l=n.ellicpseParameters;c=new SuperMap3D.GeoEllipsoid(l[0],l[1],l[2]);break;default:(c=new SuperMap3D.GeoModel3D).geoModel=i.geometrys.SkyLineBody,s.clear()}s.geometry=c}function b(e){var t;switch(e){case"intersects":t=SuperMap3D.PositionMode.Intersects;break;case"disjoint":t=SuperMap3D.PositionMode.Disjoint;break;case"contains":t=SuperMap3D.PositionMode.Contains;break;default:t=SuperMap3D.PositionMode.Intersects}s.positionMode=t}function S(e){s&&s.geometry&&(s.geometry.geoPosition=new SuperMap3D.Point3D(e[0],e[1],e[2]))}function V(){var e=w(n.selectedLayerName);e&&(e.selectedColor=new SuperMap3D.Color(.7,.7,1,1),e.setSelection([]),e.selectColorType=SuperMap3D.SelectColorType.MIX),s.clear(),tooltip.setVisible(!1),document.body.classList.remove("measureCur"),s.geometry.geoPosition=new SuperMap3D.Point3D(0,0,0),viewer.eventManager.removeEventListener("CLICK",v)}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),y()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),y())})),e.watch((function(){return t.changeLayers}),(function(e){f()})),t.changeGeometrys&&h(),e.watch((function(){return t.changeGeometrys}),(function(e){h()})),e.watch((function(){return n.Xpitch}),(function(e){""!=e&&(c.geoRotationX=parseFloat(e))})),e.watch((function(){return n.Yroll}),(function(e){""!=e&&(c.geoRotationY=parseFloat(e))})),e.watch((function(){return n.Zheading}),(function(e){""!=e&&(c.geoRotationZ=parseFloat(e))})),e.watch((function(){return n.scale}),(function(e){""!=e&&(c.geoScaleX=parseFloat(e),c.geoScaleY=parseFloat(e),c.geoScaleZ=parseFloat(e))})),e.watch((function(){return n.positionMode}),(function(e){""!=e&&b(e)})),e.watch((function(){return n.geometryType}),(function(e){""!==e&&g(e)})),e.watch((function(){return n.drawType}),(function(e){""!=e&&(s.fillStyle=SuperMap3D.FillStyle[e])})),e.watch((function(){return n.FillColor}),(function(e){""!=e&&(s.fillColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return n.WireFrameColor}),(function(e){""!=e&&(s.outlineColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return n.searchColor}),(function(e){""!=e&&(w(n.selectedLayerName).selectedColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return n.selectedLayerName}),(function(e,t){var o=w(t);o&&(o.selectedColor=new SuperMap3D.Color(.7,.7,1,1),o.setSelection([]),o.selectColorType=SuperMap3D.SelectColorType.MIX),V()})),e.onBeforeUnmount((function(){s.destroy(),s=void 0,l=void 0,c=void 0})),u(u({},e.toRefs(n)),{},{setPosition:S,getQueryIDs:function(){return s.getQueryIDs()},analysis:function(){try{var e=w(n.selectedLayerName);if(!e)return void ae.Message.warnMsg("请选择需要查询的图层！");if(s.layers=[e],tooltip.setVisible(!1),e.selectedColor=SuperMap3D.Color.fromCssColorString(n.searchColor),e.selectColorType=SuperMap3D.SelectColorType.REPLACE,e.selectEnabled=!1,s.geometry){var t=s.getQueryIDs();console.log(t)}if("number"==typeof n.geometryType)return g(n.geometryType),void s.build();s.build(),viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),p&&(window.tooltip.showAt(" <p>点击鼠标左键确认查询位置</p>","300px"),p=!1),viewer.eventManager.addEventListener("CLICK",v,!0)}catch(e){console.error(e)}},clear:V})}Ln.render=er,Ln.__scopeId="data-v-8f58fc18",Ln.__file="src/components/analysis_3d/openness/openness.vue",Ln.install=function(e){e.component(Ln.name,Ln)};var or={name:"Sm3dSpatialQuery3d",props:{selectedLayerName:{type:String},Xpitch:{type:Number},Yroll:{type:Number},Zheading:{type:Number},scale:{type:Number},positionMode:{type:String},geometryType:{type:String},drawType:{type:String},FillColor:{type:String},WireFrameColor:{type:String},searchColor:{type:String},boxParameters:{type:Array},sphereParameters:{type:Array},coneParameters:{type:Array},cylinderParameters:{type:Array},ellicpseParameters:{type:Array},rotateOrigin:{type:String}},setup:function(e){var t=tr(e);return{scale:t.scale,selectedLayerName:t.selectedLayerName,layerNames:t.layerNames,positionMode:t.positionMode,GeometryBodyNames:t.GeometryBodyNames,geometryType:t.geometryType,analysis:t.analysis,clear:t.clear}}},ir={id:"openness-panel",class:"sm-panel"},nr={class:"sm-function-module-sub-section",style:{margin:"0"}},rr={class:"sm-half-L"},ar={style:{width:"40%"}},lr={class:"sm-half-L"},sr={style:{width:"40%"}},cr={class:"sm-half-L"},dr={style:{width:"40%"}},ur={value:"intersects"},pr={value:"disjoint"},mr={value:"contains"},hr={class:"sm-half-L"},yr={style:{width:"40%"}},fr={value:"box"},vr={class:"boxchild"};function wr(o){var i,n,r,a=e.reactive({multiViewport:"NONE",selectedViewport:"0",TreeDatas:[]});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);var s=e.ref(null),c={KeysViewport1:[],KeysViewport2:[],KeysViewport3:[],KeysViewport4:[]};function d(){i=viewer.scene.layers.layerQueue,n=viewer.imageryLayers._layers,r=viewer.scene._vectorTileMaps._layerQueue,viewer.terrainProvider,a.TreeDatas.length=0,function(){if(0==i.length)return;var e={id:"s3m",label:"S3M图层",children:[]};i.forEach((function(t,o){var i={id:"s3m-"+o,label:t._name};e.children.push(i)})),a.TreeDatas[0]=e}(),function(){if(1==n.length)return;var e={id:"img",label:"IMG图层",children:[]};n.forEach((function(t,o){var i=t._imageryProvider instanceof SuperMap3D.MvtProviderGL;if(0===o||i)return!0;var n={id:"img-"+o,label:te.BaseMapImg};t._imageryProvider.tablename&&(n.label=t._imageryProvider.tablename),e.children.unshift(n)})),e.children.length>0&&(a.TreeDatas[1]=e)}(),function(){if(console.log(r),0==r.length)return;var e={id:"mvt",label:"MVT图层",children:[]};r.forEach((function(t,o){var i={id:"mvt-"+o,label:t.name};e.children.unshift(i)})),a.TreeDatas[2]=e}(),setTimeout((function(){s.value.setCheckedNodes(a.TreeDatas);var e=s.value.getCheckedKeys(!0);c.KeysViewport1=f(e),c.KeysViewport2=f(e),c.KeysViewport3=f(e),c.KeysViewport4=f(e)}),500)}return e.onMounted((function(){setTimeout((function(){d()}),500)})),e.watch((function(){return t.changeLayers}),(function(e){d()})),e.watch((function(){return a.multiViewport}),(function(e){viewer.scene.multiViewportMode=SuperMap3D.MultiViewportMode[e]})),e.watch((function(){return a.selectedViewport}),(function(e,t){var o=s.value.getCheckedKeys(!0);c["KeysViewport"+t]=o,s.value.setCheckedKeys(c["KeysViewport"+e],!0)})),e.onBeforeUnmount((function(){i=null,n=null,r=null,c=null})),u(u({},e.toRefs(a)),{},{tree:s,checkNode:function(e){var t=s.value.getNode(e);!function(e,t){var o=e[0],l=e[1];switch(o){case"s3m":if(!l){for(var s=0;s<i.length;s++)i[s].setVisibleInViewport(Number(a.selectedViewport),t);return}i[l].setVisibleInViewport(Number(a.selectedViewport),t);break;case"img":if(!l){for(var c=0;c<n.length;c++)n[c].setVisibleInViewport(Number(a.selectedViewport),t);return}n[l].setVisibleInViewport(Number(a.selectedViewport),t);break;case"mvt":if(!l){for(var d=0;d<r.length;d++)r[d].setVisibleInViewport(Number(a.selectedViewport),t);return}r[l].setVisibleInViewport(Number(a.selectedViewport),t)}}(e.id.split("-"),t.checked)}})}or.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",ir,[e.withDirectives(e.createVNode("div",nr,[e.createVNode("div",rr,[e.createVNode("label",ar,e.toDisplayString(t.Resource.scale),1),e.createVNode(l,{modelValue:n.scale,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.scale=e}),min:.2,max:10,step:.2,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","min","step"]),e.createCommentVNode(' <input class="sm-input-S" min="1" step="1" type="number" v-model="clipWidth" /> ')]),e.createVNode("div",lr,[e.createVNode("label",sr,e.toDisplayString(t.Resource.searchLayers),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",cr,[e.createVNode("label",dr,e.toDisplayString(t.Resource.positionMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.positionMode=e})},[e.createVNode("option",ur,e.toDisplayString(t.Resource.intersects),1),e.createVNode("option",pr,e.toDisplayString(t.Resource.disjoint),1),e.createVNode("option",mr,e.toDisplayString(t.Resource.contains),1)],512),[[e.vModelSelect,n.positionMode]])]),e.withDirectives(e.createVNode("div",hr,[e.createVNode("label",yr,e.toDisplayString(t.Resource.geometryType),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.geometryType=e})},[e.createVNode("option",fr,e.toDisplayString(t.Resource.box),1),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.GeometryBodyNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:o},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.geometryType]])],512),[[e.vShow,n.GeometryBodyNames.length>0]]),e.createVNode("div",vr,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[5]||(o[5]=function(){return n.analysis&&n.analysis.apply(n,arguments)})},e.toDisplayString(t.Resource.search),1),e.createVNode("button",{onClick:o[6]||(o[6]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"tbtn",style:{"margin-left":"4px"},type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},or.__file="src/components/space-search/spatial-query3d/spatial-query3d.vue",or.install=function(e){e.component(or.name,or)};var gr={name:"Sm3dSplitScreen",setup:function(e){var t=wr(e);return{multiViewport:t.multiViewport,selectedViewport:t.selectedViewport,TreeDatas:t.TreeDatas,tree:t.tree,checkNode:t.checkNode}}},br={id:"split-screen-panel",class:"sm-panel"},Sr={class:"sm-function-module-sub-section",style:{margin:"0"}},Vr={class:"sm-half-L"},Dr={style:{width:"40%"}},Nr={value:"NONE"},Cr={value:"HORIZONTAL"},Mr={value:"VERTICAL"},xr={value:"TRIPLE"},Rr={value:"QUAD"},kr={class:"sm-half-L flex-start"},Lr={style:{width:"40%"}},Pr={style:{width:"auto"}},Br={class:"sm-half-L flex-start"},Tr={style:{width:"40%"}},Er={style:{width:"auto"}},Ar={class:"sm-half-L"};function Ir(o){var i,n,r,a=e.reactive({useRoller:!1,rollerMode:"lrRoller",lrRoller:"1",tbRoller:"4",TreeDatas:[]});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);var s=document.getElementById("SuperMap3DContainer"),c=document.body.clientWidth-s.clientWidth,d=document.body.clientHeight-s.clientHeight,p=s.clientWidth,m=s.clientHeight,h=e.ref(null),y=e.ref(null),f=e.ref(null),v=e.ref(null),w=e.ref(null),g=new SuperMap3D.BoundingRectangle,b={startX:.33,startY:.33,endX:.66,endY:.66,index:1,mode:1};function S(){var e,t;i=viewer.scene.layers.layerQueue,n=viewer.imageryLayers._layers,r=viewer.scene._vectorTileMaps._layerQueue,viewer.terrainProvider,a.TreeDatas.length=0,function(){if(0==i.length)return;var e={id:"s3m",label:"S3M图层",children:[]};i.forEach((function(t,o){var i={id:"s3m-"+o,label:t._name};e.children.push(i)})),a.TreeDatas[0]=e}(),function(){if(1==n.length)return;var e={id:"img",label:"IMG图层",children:[]};n.forEach((function(t,o){if(0===o)return!0;if(t._imageryProvider instanceof SuperMap3D.MvtProviderGL)return!0;var i={id:"img-"+o,label:te.BaseMapImg};t._imageryProvider.tablename&&(i.label=t._imageryProvider.tablename),e.children.unshift(i)})),e.children.length>0&&(a.TreeDatas[1]=e)}(),function(){if(0==r.length)return;var e={id:"mvt",label:"MVT图层",children:[]};r.forEach((function(t,o){var i={id:"mvt-"+o,label:t.name};e.children.unshift(i)})),a.TreeDatas[2]=e}(),t={id:"globe-0",label:"地表"},(e={id:"globe",label:"地球",children:[]}).children.push(t),a.TreeDatas[4]=e,setTimeout((function(){h.value.setCheckedNodes(a.TreeDatas)}),500)}function V(){var e=b.startX,t=b.startY,o=b.endX,i=b.endY;switch(b.mode){case 1:SuperMap3D.BoundingRectangle.unpack([e,0,1,1],0,g);break;case 2:SuperMap3D.BoundingRectangle.unpack([0,0,e,1],0,g);break;case 4:SuperMap3D.BoundingRectangle.unpack([0,t,1,1],0,g);break;case 8:SuperMap3D.BoundingRectangle.unpack([0,0,1,t],0,g);break;case 15:SuperMap3D.BoundingRectangle.unpack([e,t,o-e,i-t],0,g);break;default:SuperMap3D.BoundingRectangle.unpack([0,0,1,1],0,g)}h.value.getCheckedKeys(!0).forEach((function(e){D(e.split("-"),!0)}))}function D(e,t){var o=e[0],a=e[1];switch(o){case"s3m":if(!a){for(var l=0;l<i.length;l++)i[l].swipeEnabled=t,i[l].swipeRegion=g;return}i[a].swipeEnabled=t,i[a].swipeRegion=g;break;case"img":if(!a){for(var s=1;s<n.length;s++)n[s].swipeEnabled=t,n[s].swipeRegion=g;return}n[a].swipeEnabled=t,n[a].swipeRegion=g;break;case"mvt":if(!a){for(var c=0;c<r.length;c++)r[c].swipeEnabled=t,r[c].swipeRegion=g;return}r[a].swipeEnabled=t,r[a].swipeRegion=g;break;case"globe":viewer.scene.globe.swipeEnabled=t,viewer.scene.globe.swipeRegion=g}}function N(e){y.value.style.display="none",f.value.style.display="none",v.value.style.display="none",w.value.style.display="none",1&e&&(y.value.style.display="block"),2&e&&(f.value.style.display="block"),4&e&&(v.value.style.display="block"),8&e&&(w.value.style.display="block")}return e.watch((function(){return t.changeLayers}),(function(e){S()})),e.onMounted((function(){!function(){function e(e){document.removeEventListener("mousemove",o,!1)}function t(e,t){b.index=t,document.addEventListener("mousemove",o,!1)}function o(e){switch(e.preventDefault?e.preventDefault():e.returnValue=!1,b.index){case 1:y.value.style.left=e.clientX-c+"px",b.startX=(e.clientX-c)/p;break;case 2:v.value.style.top=e.clientY-d+"px",b.startY=(e.clientY-d)/m;break;case 3:f.value.style.left=e.clientX-c+"px",b.endX=(e.clientX-c)/p;break;case 4:w.value.style.top=e.clientY-d+"px",b.endY=(e.clientY-d)/m}V()}y.value.addEventListener("mousedown",(function(e){t(e,1)}),!1),f.value.onmousedown=function(e){t(e,3)},v.value.onmousedown=function(e){t(e,2)},w.value.onmousedown=function(e){t(e,4)},window.addEventListener("resize",(function(){p=document.body.clientWidth-c,m=document.body.clientHeight-d})),document.addEventListener("mouseup",e,!1)}(),setTimeout((function(){S()}),500)})),e.watch((function(){return a.multiViewport}),(function(e){viewer.scene.multiViewportMode=SuperMap3D.MultiViewportMode[e]})),e.watch((function(){return a.selectedViewport}),(function(e,t){var o=h.value.getCheckedKeys(!0);a["KeysViewport"+t]=o,h.value.setCheckedKeys(a["KeysViewport"+e],!0)})),e.watch((function(){return a.useRoller}),(function(e){e?(1!=b.mode&&2!=b.mode||N(1),4!=b.mode&&8!=b.mode||N(4),15==b.mode&&N(15),V()):(N(0),D(["s3m"],!1),D(["img"],!1),D(["mvt"],!1),D(["globe"],!1))})),e.watch((function(){return a.rollerMode}),(function(e){switch(e){case"lrRoller":a.useRoller&&N(1),b.mode=Number(a.lrRoller);break;case"tbRoller":a.useRoller&&N(4),b.mode=Number(a.tbRoller);break;case"customRoller":a.useRoller&&N(15),b.mode=15}a.useRoller&&V()})),e.watch((function(){return a.lrRoller}),(function(e){a.useRoller&&(b.mode=Number(e),V())})),e.watch((function(){return a.tbRoller}),(function(e){a.useRoller&&(b.mode=Number(e),V())})),e.onBeforeUnmount((function(){i=void 0,n=void 0,r=void 0})),u(u({},e.toRefs(a)),{},{tree:h,checkNode:function(e){var t=h.value.getNode(e);D(e.id.split("-"),t.checked)},verticalSliderLeft:y,verticalSliderRight:f,horizontalSliderTop:v,horizontalSliderBottom:w})}gr.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-tree"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",br,[e.withDirectives(e.createVNode("div",Sr,[e.createVNode("div",Vr,[e.createVNode("label",Dr,e.toDisplayString(t.Resource.multiViewport),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"60%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.multiViewport=e})},[e.createVNode("option",Nr,e.toDisplayString(t.Resource.onePort),1),e.createVNode("option",Cr,e.toDisplayString(t.Resource.horizontalSnap),1),e.createVNode("option",Mr,e.toDisplayString(t.Resource.verticalSnap),1),e.createVNode("option",xr,e.toDisplayString(t.Resource.tripeSnap),1),e.createVNode("option",Rr,e.toDisplayString(t.Resource.quadSnap),1)],512),[[e.vModelSelect,n.multiViewport]])]),e.withDirectives(e.createVNode("div",kr,[e.createVNode("label",Lr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"0","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.selectedViewport=e})},null,512),[[e.vModelRadio,n.selectedViewport]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.viewportOne),1)]),e.createVNode("label",Pr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"1","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.selectedViewport=e})},null,512),[[e.vModelRadio,n.selectedViewport]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.viewportTwo),1)])],512),[[e.vShow,"NONE"!=n.multiViewport]]),e.withDirectives(e.createVNode("div",Br,[e.createVNode("label",Tr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"2","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.selectedViewport=e})},null,512),[[e.vModelRadio,n.selectedViewport]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.viewportThree),1)]),e.withDirectives(e.createVNode("label",Er,[e.withDirectives(e.createVNode("input",{type:"radio",value:"3","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.selectedViewport=e})},null,512),[[e.vModelRadio,n.selectedViewport]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.viewportFour),1)],512),[[e.vShow,"QUAD"==n.multiViewport]])],512),[[e.vShow,"TRIPLE"==n.multiViewport||"QUAD"==n.multiViewport]]),e.withDirectives(e.createVNode("div",Ar,[e.createVNode(l,{data:n.TreeDatas,"show-checkbox":"","node-key":"id",accordion:"",ref:"tree",onCheck:n.checkNode},null,8,["data","onCheck"])],512),[[e.vShow,"NONE"!=n.multiViewport]])],512),[[s]])],512)),[[c]])},gr.__file="src/components/scene/split-screen/split-screen.vue",gr.install=function(e){e.component(gr.name,gr)};var Fr={name:"Sm3dRoller",props:{rollerMode:{type:String}},setup:function(e){var t=Ir(e);return{useRoller:t.useRoller,rollerMode:t.rollerMode,lrRoller:t.lrRoller,tbRoller:t.tbRoller,TreeDatas:t.TreeDatas,tree:t.tree,checkNode:t.checkNode,verticalSliderLeft:t.verticalSliderLeft,verticalSliderRight:t.verticalSliderRight,horizontalSliderTop:t.horizontalSliderTop,horizontalSliderBottom:t.horizontalSliderBottom}}},Ur={id:"split-screen-panel",class:"sm-panel"},_r={class:"sm-function-module-sub-section",style:{margin:"0"}},Or={class:"sm-half-L"},Hr={style:{width:"40%"}},zr={value:"lrRoller"},Gr={value:"tbRoller"},jr={value:"customRoller"},Wr={class:"sm-half-L"},Kr={style:{width:"auto"}},Qr={class:"sm-half-L"},Xr={style:{width:"auto"}},Yr={style:{width:"auto"}},Zr={class:"sm-half-L"},qr={style:{width:"auto"}},Jr={style:{width:"auto"}},$r={class:"sm-half-L"},ea={id:"verticalSliderLeft",ref:"verticalSliderLeft"},ta={id:"verticalSliderRight",ref:"verticalSliderRight"},oa={id:"horizontalSliderTop",ref:"horizontalSliderTop"},ia={id:"horizontalSliderBottom",ref:"horizontalSliderBottom"};Fr.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-tree"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",Ur,[e.withDirectives(e.createVNode("div",_r,[e.createVNode("div",Or,[e.createVNode("label",Hr,e.toDisplayString(t.Resource.rollerMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"60%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.rollerMode=e})},[e.createVNode("option",zr,e.toDisplayString(t.Resource.lrRoller),1),e.createVNode("option",Gr,e.toDisplayString(t.Resource.tbRoller),1),e.createVNode("option",jr,e.toDisplayString(t.Resource.customRoller),1)],512),[[e.vModelSelect,n.rollerMode]])]),e.createVNode("div",Wr,[e.createVNode("label",Kr,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.useRoller=e})},null,512),[[e.vModelCheckbox,n.useRoller]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.useRoller),1)])]),e.withDirectives(e.createVNode("div",Qr,[e.createVNode("label",Xr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"1","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.lrRoller=e})},null,512),[[e.vModelRadio,n.lrRoller]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.shieldLeft),1)]),e.createVNode("label",Yr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"2","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.lrRoller=e})},null,512),[[e.vModelRadio,n.lrRoller]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.shieldRight),1)])],512),[[e.vShow,"lrRoller"==n.rollerMode&&n.useRoller]]),e.withDirectives(e.createVNode("div",Zr,[e.createVNode("label",qr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"4","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.tbRoller=e})},null,512),[[e.vModelRadio,n.tbRoller]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.shieldTop),1)]),e.createVNode("label",Jr,[e.withDirectives(e.createVNode("input",{type:"radio",value:"8","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.tbRoller=e})},null,512),[[e.vModelRadio,n.tbRoller]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.shieldBottom),1)])],512),[[e.vShow,"tbRoller"==n.rollerMode&&n.useRoller]]),e.withDirectives(e.createVNode("div",$r,[e.createVNode(l,{data:n.TreeDatas,"show-checkbox":"","node-key":"id",accordion:"",ref:"tree",onCheck:n.checkNode},null,8,["data","onCheck"])],512),[[e.vShow,n.useRoller]])],512),[[s]])],512),[[c]]),e.createVNode("div",ea,null,512),e.createVNode("div",ta,null,512),e.createVNode("div",oa,null,512),e.createVNode("div",ia,null,512)],64)},Fr.__file="src/components/scene/roller/roller.vue",Fr.install=function(e){e.component(Fr.name,Fr)};var na={name:"Sm3dCustomService",props:{addCallback:{type:Function},clearCallback:{type:Function},getLayerName:{type:Function}},setup:function(t){var o=e.reactive({layersType:"SCENE",layerURL:null,layerName:null,isAddToken:!1,token:null,isSct:!1}),i=function(){},n=function(){},r=function(){};function a(){return o.layerURL&&""!==o.layerURL?"SCENE"==o.layersType||o.layerName&&""!==o.layerName?!(o.isAddToken&&!o.token)||(ae.Message.warnMsg("勾选token后请填写token"),!1):(ae.Message.warnMsg("请补充图层名称"),!1):(ae.Message.warnMsg("请填写正确的URL"),!1)}function l(){o.layerURL=null,o.layerName=null,o.isAddToken=!1,o.token=null,o.isSct=!1}return t&&t.clearCallback&&(n=t.clearCallback),t&&t.addCallback&&(i=t.addCallback),t&&t.getLayerName&&(r=t.getLayerName),u(u({},e.toRefs(o)),{},{addLayer:function(){if(e=o.layerURL.split("/"),"realspace"===(t=e[e.length-1])&&"SCENE"!=o.layersType||"config"===t&&"S3M"!=o.layersType||"image"===t&&"IMG"!=o.layersType)ae.Message.warnMsg("请检查添加类型是否正常？");else{var e,t;switch(r(o.layerName),o.layersType){case"SCENE":if(a()){var n={};o.isAddToken&&(n.SceneToken=token),H.addScene(o.layerURL,n,i)}break;case"S3M":if(a()){var s=[{url:o.layerURL,options:{name:o.layerName}}];H.addS3mLayers(s,i)}break;case"IMG":if(a()){var c=H.addImageLayer(o.layerURL);i(c,"IMG")}break;case"TERRAIN":a()&&(H.addTerrainLayer(o.layerURL,o.isSct),i(viewer.terrainProvider,"TERRAIN"));break;case"MVT":if(a()){var d=H.addMvtLayer(o.layerURL,o.layerName);i(d,"MVT")}}l()}},clear:function(){l(),n()}})}},ra={id:"CustomService-panel",class:"sm-panel"},aa={class:"sm-function-module-sub-section",style:{margin:"0"}},la={class:"sm-half-L"},sa=e.createVNode("label",{style:{width:"40%"}},"打开图层",-1),ca=e.createStaticVNode('<option value="SCENE">场景</option><option value="S3M">S3M</option><option value="IMG">影像</option><option value="TERRAIN">地形</option><option value="MVT">矢量瓦片</option>',5),da={class:"sm-half-L flex-start"},ua=e.createVNode("label",{class:"label-S"},"添加token",-1),pa={class:"sm-half-L flex-start"},ma=e.createVNode("label",{class:"label-S"},"isSct",-1),ha={class:"boxchild"};function ya(i){var n,r,a,l,s,c,d=e.reactive({TreeDatas:[],expandedKeys:[]}),p=e.ref(null),m=e.ref(null),h=function(){},y=document.getElementById("SuperMap3DContainer"),f=document.body.clientWidth-y.clientWidth,v=document.body.clientHeight-y.clientHeight;function w(){n=viewer.scene.layers.layerQueue,r=viewer.imageryLayers._layers,l=viewer.scene._vectorTileMaps._layerQueue,a=viewer.terrainProvider,d.TreeDatas.length=0,g(),b(),S(),function(){if(!a.tablename)return;var e={id:"terrain",label:"地形图层",children:[]},t={id:"terrain-0",label:a.tablename};e.children.push(t),d.TreeDatas[3]=e}(),setTimeout((function(){p.value.setCheckedNodes(d.TreeDatas)}),500),console.log(l)}function g(){if(0!=n.length){var e={id:"s3m",label:"S3M图层",children:[]};n.forEach((function(t,o){var i={id:"s3m-"+o,label:t._name};e.children.push(i)})),d.TreeDatas[0]=e}else d.TreeDatas[0]&&p.value.remove(d.TreeDatas[0])}function b(){if(1!=r.length){var e={id:"img",label:"IMG图层",children:[]};r.forEach((function(t,o){var i=t._imageryProvider instanceof SuperMap3D.MvtProviderGL;if(0===o||i)return!0;var n={id:"img-"+o,label:te.BaseMapImg};t._imageryProvider.tablename&&(n.label=t._imageryProvider.tablename),e.children.unshift(n)})),e.children.length>0&&(d.TreeDatas[1]=e)}else d.TreeDatas[1]&&p.value.remove(d.TreeDatas[1])}function S(){if(0!=l.length){var e={id:"mvt",label:"MVT图层",children:[]};l.forEach((function(t,o){var i={id:"mvt-"+o,label:t.name};e.children.unshift(i)})),d.TreeDatas[2]=e}else d.TreeDatas[2]&&p.value.remove(d.TreeDatas[2])}return i&&i.deleteCallback&&(h=i.deleteCallback),e.watch((function(){return t.changeLayers}),(function(e){w()})),e.onMounted((function(){setTimeout((function(){w()}),500)})),document.onclick=function(e){e.stopPropagation(),m.value.style.display="none"},e.onBeforeUnmount((function(){document.onclick=function(){}})),u(u({},e.toRefs(d)),{},{tree:p,domContextmenu:m,checkNode:function(e){var t=p.value.getNode(e);!function(e,t){var o=e[0],i=e[1];switch(o){case"s3m":if(!i){for(var a=0;a<n.length;a++)n[a].visible=t;return}n[i].visible=t;break;case"img":if(!i){for(var c=1;c<r.length;c++)r[c].show=t;return}r[i].show=t;break;case"mvt":if(!i){for(var d=0;d<l.length;d++)l[d].show=t;return}l[i].show=t;break;case"terrain":t?viewer.terrainProvider=s:(s=viewer.terrainProvider,viewer.terrainProvider=new SuperMap3D.EllipsoidTerrainProvider)}}(e.id.split("-"),t.checked)},nodeContextmenu:function(e,t){t.id.split("-")[1]&&(c=t,m.value.style.left=e.clientX+30-f+"px",e.clientX>=1810&&(m.value.style.left=e.clientX-80-f+"px"),m.value.style.top=e.clientY-v+"px",m.value.style.display="block")},nodeClick:function(e){!function(e){var t,o=e[0],i=e[1];switch(o){case"s3m":i&&(t=n[i]);break;case"img":i&&(t=r[i]);break;case"mvt":i&&(t=l[i])}t&&viewer.flyTo(t)}(e.id.split("-"))},deleteLayer:function(){m.value.style.display="none";var e=c.id.split("-"),t=e[0],i=e[1];switch(t){case"s3m":i&&(viewer.scene.layers.remove(n[i]._name),g(),setTimeout((function(){d.expandedKeys=["s3m"],p.value.setCheckedNodes(d.TreeDatas)}),50));break;case"img":i&&(viewer.imageryLayers.remove(r[i]),b(),setTimeout((function(){p.value.setCheckedNodes(d.TreeDatas)}),50));break;case"mvt":i&&(viewer.scene.removeVectorTilesMap(l[i].name),S(),setTimeout((function(){p.value.setCheckedNodes(d.TreeDatas)}),100));break;case"terrain":viewer.terrainProvider=new SuperMap3D.EllipsoidTerrainProvider,s=null;var a=p.value.getNode(t);p.value.remove(a)}o.setChangeLayers(),h(c)}})}na.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",ra,[e.withDirectives(e.createVNode("div",aa,[e.createVNode("div",la,[sa,e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return t.layersType=e})},[ca],512),[[e.vModelSelect,t.layersType]])]),e.createVNode("div",da,[e.withDirectives(e.createVNode("input",{type:"text",class:"sm-input sm-margin-M",style:{width:"100%"},placeholder:"URL","onUpdate:modelValue":o[2]||(o[2]=function(e){return t.layerURL=e})},null,512),[[e.vModelText,t.layerURL]]),e.withDirectives(e.createVNode("input",{type:"text",class:"sm-input sm-margin-M",style:{width:"100%"},placeholder:"自定义名称","onUpdate:modelValue":o[3]||(o[3]=function(e){return t.layerName=e})},null,512),[[e.vModelText,t.layerName]]),e.createCommentVNode(" v-show=\"layersType === 'S3M'\" "),ua,e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=function(e){return t.isAddToken=e})},null,512),[[e.vModelCheckbox,t.isAddToken]]),e.withDirectives(e.createVNode("input",{type:"text",class:"sm-input sm-margin-M",style:{width:"100%"},placeholder:"token","onUpdate:modelValue":o[5]||(o[5]=function(e){return t.token=e})},null,512),[[e.vModelText,t.token],[e.vShow,t.isAddToken]])]),e.withDirectives(e.createVNode("div",pa,[ma,e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return t.isSct=e})},null,512),[[e.vModelCheckbox,t.isSct]])],512),[[e.vShow,"TERRAIN"===t.layersType]]),e.createVNode("div",ha,[e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button",onClick:o[7]||(o[7]=function(){return n.addLayer&&n.addLayer.apply(n,arguments)})},"添加"),e.createVNode("button",{onClick:o[8]||(o[8]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},"取消")])],512),[[l]])],512)),[[s]])},na.__file="src/components/layer/custom-service/custom-service.vue",na.install=function(e){e.component(na.name,na)};var fa={name:"Sm3dLayerManage",props:{deleteCallback:{type:Function}},setup:function(e){var t=ya(e);return{nodeContextmenu:t.nodeContextmenu,nodeClick:t.nodeClick,TreeDatas:t.TreeDatas,tree:t.tree,domContextmenu:t.domContextmenu,checkNode:t.checkNode,deleteLayer:t.deleteLayer,expandedKeys:t.expandedKeys}}},va={id:"layer-manage-panel",class:"sm-panel"},wa={class:"sm-function-module-sub-section",style:{margin:"0"}},ga={class:"sm-half-L"},ba={id:"contextmenu",ref:"domContextmenu"};function Sa(o){var i,n,r,a,l=e.reactive({layerNames:[],selectedLayerIndex:"none",childLayerNames:[],selectedChildLayerIndex:"none",mvtAlpha:1,showLayer:!0,textAvoidance:!0,openFilter:!1,propertyKeys:[],symbols:[],clickGetFeature:{layer:{id:null},id:null},isClickShowProperty:!0,dockFontShow:!0,bubbleShow:!1,selectedPropertyKeys:[""],selectedSymbols:[""],inputPropertys:[""],inputSymbols:[""],inputValues:[""]}),s=[],c=!1,d=e.ref(null);function p(){(i=viewer.scene._vectorTileMaps._layerQueue)&&i.length>0?(i.forEach((function(e,t){l.layerNames.includes(e.name)||l.layerNames.push(e.name)})),console.log("init"),(l.selectedLayerIndex="none")&&(l.selectedLayerIndex=0)):l.selectedLayerIndex="none",viewer.eventManager.addEventListener("CLICK",y,!0)}function m(e){return e.slice(0,e.length-1)}function h(){if(""==l.inputPropertys[0])return!1;var e=["any"];return l.inputPropertys.forEach((function(t,o){var i=[];i[0]=l.inputSymbols[o],i[1]=t,i[2]=l.inputValues[o],"number"==typeof Number(i[2])&&(i[2]=Number(i[2])),e.push(i)})),!(e.length<2)&&e}function y(e){var t=viewer.scene.pick(e.message.position)||viewer.selectedEntity;if(SuperMap3D.defined(t)&&SuperMap3D.defined(t.pickResult)){var o=document.body.clientWidth-e.message.position.x;d.value.style.left=o>=300?e.message.position.x+"px":e.message.position.x-250+"px",d.value.style.top=e.message.position.y-220+"px",l.bubbleShow=!0;var i=null;for(var n in t.pickResult){i=t.pickResult[n];break}var r=i[0].feature;r&&(l.clickGetFeature=r),console.log(r)}else l.bubbleShow=!1}function f(){a&&(n.removeLayer(a.id),a=null)}return l.symbols=["!","!=",">",">=","<","<=","==","in","like","!like","left","right"],t.isViewer&&setTimeout((function(){return p()}),500),e.watch((function(){return t.isViewer}),(function(e){p()})),e.watch((function(){return t.changeLayers}),(function(e){p()})),e.watch((function(){return l.selectedLayerIndex}),(function(e){"none"!==e&&(s.length=0,n=i[e],l.showLayer=n.show,n.readyPromise.then((function(e){e&&(n.mapboxStyle.layers.forEach((function(e,t){l.childLayerNames.includes(e.id)||l.childLayerNames.push(e.id);var o=n.getLayoutProperty(e.id,"visibility");s.push(o)})),l.selectedChildLayerIndex=0)})))})),e.watch((function(){return l.selectedChildLayerIndex}),(function(e){r=n.mapboxStyle.layers[e];var t=n.querySourceFeatures({sourceLayer:r.id,filter:["<","$id",10]});0==t.length?l.propertyKeys=[]:l.propertyKeys=t[0]._keys.length>0?t[0]._keys:[]})),e.watch((function(){return l.mvtAlpha}),(function(e){n&&(n.alpha=Number(e))})),e.watch((function(){return l.showLayer}),(function(e){n&&(n.show=e)})),e.watch((function(){return l.textAvoidance}),(function(e){if(n)for(var t=n.mapboxStyle.layers,o=0;o<t.length;o++)t[o].isOverlapDisplayed=e})),e.watch((function(){return l.isClickShowProperty}),(function(e){if(e)return viewer.eventManager.addEventListener("CLICK",y,!0),void(l.bubbleShow=!0);viewer.eventManager.removeEventListener("CLICK",y),l.bubbleShow=!1})),e.watch((function(){return l.selectedPropertyKeys}),(function(e,t){e.length===t.length&&e.forEach((function(e,t){l.inputPropertys[t]=e}))}),{deep:!0}),e.watch((function(){return l.selectedSymbols}),(function(e,t){e.length===t.length&&e.forEach((function(e,t){if("left"===e||"right"===e)return""===l.inputPropertys[t]||l.inputPropertys[t].includes("left(")||l.inputPropertys[t].includes("right(")?void(l.inputPropertys[t]=e+"()"):void(l.inputPropertys[t]=e+"("+l.inputPropertys[t]+",2)");l.inputSymbols[t]=e}))}),{deep:!0}),e.onBeforeUnmount((function(){i=null,n=null,r=null})),u(u({},e.toRefs(l)),{},{addCondition:function(e){if(!e)return l.selectedPropertyKeys=m(l.selectedPropertyKeys),l.selectedSymbols=m(l.selectedSymbols),l.inputSymbols=m(l.inputSymbols),l.inputPropertys=m(l.inputPropertys),void(l.inputValues=m(l.inputValues));l.selectedPropertyKeys=l.selectedPropertyKeys.concat([""]),l.selectedSymbols=l.selectedSymbols.concat([""]),l.inputSymbols=l.inputSymbols.concat([""]),l.inputPropertys=l.inputPropertys.concat([""]),l.inputValues=l.inputValues.concat([""])},propertySearch:function(){var e=h();e&&function(e){a&&f();if(!r)return;var t=r.id+"_highlight";a||((a=SuperMap3D.clone(r,!0)).id=t,"line"==r.type?a.paint["line-color"]="rgba(0,255,255,1.00)":"fill"==r.type?a.paint["fill-color"]="rgba(0,255,255,1.00)":a.paint["text-color"]="rgba(255,0,0,1.00)",a.layout.visibility="visible",a.minzoom=3,n.addLayer(a),n.setFilter(a.id,e))}(e)},propertyFilter:function(){var e=h();c=!0,n&&(n.mapboxStyle.layers.forEach((function(e){n.setLayoutProperty(e.id,"visibility","none")})),n.setLayoutProperty(r.id,"visibility","visible"),e&&n.setFilter(r.id,e))},clear:function(){f(),c&&(n.mapboxStyle.layers.forEach((function(e,t){n.setLayoutProperty(e.id,"visibility",s[t])})),n.setFilter(r.id,null),n.refresh(),c=!1)},bubble:d,closeBubble:function(){l.bubbleShow=!1},dockBubble:function(e){e?(d.value.classList.add("bubbleDock"),l.dockFontShow=!1):(d.value.classList.remove("bubbleDock"),l.dockFontShow=!0)}})}fa.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-tree"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",va,[e.withDirectives(e.createVNode("div",wa,[e.createVNode("div",ga,[e.createVNode(l,{data:n.TreeDatas,"show-checkbox":"","node-key":"id",accordion:"",ref:"tree","default-expanded-keys":n.expandedKeys,"highlight-current":!0,onCheck:n.checkNode,onNodeContextmenu:n.nodeContextmenu,onNodeClick:n.nodeClick},null,8,["data","default-expanded-keys","onCheck","onNodeContextmenu","onNodeClick"])])],512),[[s]])],512),[[c]]),e.createVNode("div",ba,[e.createCommentVNode(" <span>图层属性</span><br>\r\n          <span>图层风格</span><br>\r\n    <span>图层操作</span><br>"),e.createVNode("span",{onClick:o[1]||(o[1]=function(){return n.deleteLayer&&n.deleteLayer.apply(n,arguments)}),style:{color:"red"}},e.toDisplayString(t.Resource.delete),1)],512)],64)},fa.__file="src/components/layer/layer-manage/layer-manage.vue",fa.install=function(e){e.component(fa.name,fa)};var Va={name:"Sm3dMvtlayerStyle",setup:function(e){var t=Sa();return{layerNames:t.layerNames,selectedLayerIndex:t.selectedLayerIndex,childLayerNames:t.childLayerNames,selectedChildLayerIndex:t.selectedChildLayerIndex,mvtAlpha:t.mvtAlpha,showLayer:t.showLayer,textAvoidance:t.textAvoidance,propertyKeys:t.propertyKeys,symbols:t.symbols,openFilter:t.openFilter,propertySearch:t.propertySearch,propertyFilter:t.propertyFilter,clear:t.clear,isClickShowProperty:t.isClickShowProperty,clickGetFeature:t.clickGetFeature,bubble:t.bubble,closeBubble:t.closeBubble,dockBubble:t.dockBubble,dockFontShow:t.dockFontShow,bubbleShow:t.bubbleShow,selectedPropertyKeys:t.selectedPropertyKeys,selectedSymbols:t.selectedSymbols,inputPropertys:t.inputPropertys,inputSymbols:t.inputSymbols,inputValues:t.inputValues,addCondition:t.addCondition}}},Da={id:"mvtlayer-panel",class:"sm-panel"},Na={class:"sm-function-module-sub-section",style:{margin:"0"}},Ca={class:"sm-half-L"},Ma=e.createVNode("label",{style:{width:"28%"}},"选择图层",-1),xa={value:"none"},Ra={class:"sm-half-L"},ka=e.createVNode("label",{style:{width:"28%"}},"透明度",-1),La={class:"sm-half-L"},Pa={style:{width:"auto"}},Ba=e.createTextVNode("图层显隐 "),Ta={style:{width:"auto"}},Ea=e.createTextVNode("文字避让 "),Aa={style:{width:"auto"}},Ia=e.createTextVNode("图层属性 "),Fa={style:{width:"auto"}},Ua=e.createTextVNode("查询过滤 "),_a={style:{width:"100%"}},Oa={class:"sm-half-L",style:{"margin-top":"5px"}},Ha=e.createVNode("label",{style:{width:"28%"}},"选择子图层",-1),za={class:"sm-half-L",style:{padding:"6px 0 6px 0"}},Ga=e.createVNode("label",{style:{width:"28%"}},"设置条件",-1),ja={class:"sm-half-L"},Wa={class:"tab tab2"},Ka=e.createVNode("tr",null,[e.createVNode("th",null,"属性"),e.createVNode("th",null,"条件"),e.createVNode("th",null,"值")],-1),Qa={style:{position:"relative"}},Xa={style:{position:"relative"}},Ya={class:"boxchild"},Za={id:"mvtlayer-drop-left-panel",class:"sm-panel"},qa={id:"bubble",class:"bubble-tabel",ref:"bubble"},Ja={class:"boxchild flex-between"},$a=e.createVNode("label",{style:{width:"auto"}},"对象属性",-1),el={class:"flex flex-end",style:{width:"auto"}},tl={class:"tab"},ol=e.createVNode("tr",null,[e.createVNode("th",null,"属性"),e.createVNode("th",null,"值")],-1),il=e.createVNode("td",null,"图层",-1),nl=e.createVNode("td",null,"$id",-1);Va.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",Da,[e.withDirectives(e.createVNode("div",Na,[e.createVNode("div",Ca,[Ma,e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"70%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:o},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",xa,"暂无mvt图层",512),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerIndex]])]),e.createVNode("div",Ra,[ka,e.createVNode(l,{modelValue:n.mvtAlpha,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.mvtAlpha=e}),min:0,max:1,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"70%"}},null,8,["modelValue","step"])]),e.createVNode("div",La,[e.createVNode("label",Pa,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.showLayer=e})},null,512),[[e.vModelCheckbox,n.showLayer]]),Ba]),e.createVNode("label",Ta,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.textAvoidance=e})},null,512),[[e.vModelCheckbox,n.textAvoidance]]),Ea]),e.createVNode("label",Aa,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.isClickShowProperty=e})},null,512),[[e.vModelCheckbox,n.isClickShowProperty]]),Ia]),e.createVNode("label",Fa,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.openFilter=e})},null,512),[[e.vModelCheckbox,n.openFilter]]),Ua])]),e.withDirectives(e.createVNode("div",_a,[e.createVNode("div",Oa,[Ha,e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"70%"},"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.selectedChildLayerIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.childLayerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:o},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedChildLayerIndex]])]),e.createVNode("div",za,[Ga,e.createVNode("div",null,[e.createVNode("button",{class:"tbtn",type:"button",style:{width:"auto"},onClick:o[8]||(o[8]=function(e){return n.addCondition(!0)})},"增行"),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button",style:{width:"auto"},onClick:o[9]||(o[9]=function(e){return n.addCondition(!1)})},"删行")])]),e.createVNode("div",ja,[e.createVNode("table",Wa,[e.createVNode("tbody",null,[Ka,(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.selectedPropertyKeys,(function(t,o){return e.openBlock(),e.createBlock("tr",{key:o},[e.createVNode("td",Qa,[e.withDirectives(e.createVNode("select",{class:"sm-select","onUpdate:modelValue":function(e){return n.selectedPropertyKeys[o]=e}},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.propertyKeys,(function(t){return e.openBlock(),e.createBlock("option",{key:t,value:t},e.toDisplayString(t),9,["value"])})),128))],8,["onUpdate:modelValue"]),[[e.vModelSelect,n.selectedPropertyKeys[o]]]),e.withDirectives(e.createVNode("input",{type:"text",class:"input","onUpdate:modelValue":function(e){return n.inputPropertys[o]=e}},null,8,["onUpdate:modelValue"]),[[e.vModelText,n.inputPropertys[o]]])]),e.createVNode("td",Xa,[e.withDirectives(e.createVNode("select",{class:"sm-select","onUpdate:modelValue":function(e){return n.selectedSymbols[o]=e}},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.symbols,(function(t){return e.openBlock(),e.createBlock("option",{key:t,value:t},e.toDisplayString(t),9,["value"])})),128))],8,["onUpdate:modelValue"]),[[e.vModelSelect,n.selectedSymbols[o]]]),e.withDirectives(e.createVNode("input",{type:"text",class:"input","onUpdate:modelValue":function(e){return n.inputSymbols[o]=e}},null,8,["onUpdate:modelValue"]),[[e.vModelText,n.inputSymbols[o]]])]),e.createVNode("td",null,[e.withDirectives(e.createVNode("input",{type:"text",class:"input2","onUpdate:modelValue":function(e){return n.inputValues[o]=e}},null,8,["onUpdate:modelValue"]),[[e.vModelText,n.inputValues[o]]])])])})),128))])])]),e.createVNode("div",Ya,[e.createVNode("button",{class:"tbtn",type:"button",style:{width:"auto"},onClick:o[10]||(o[10]=function(){return n.propertySearch&&n.propertySearch.apply(n,arguments)})},"查询"),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button",style:{width:"auto"},onClick:o[11]||(o[11]=function(){return n.propertyFilter&&n.propertyFilter.apply(n,arguments)})},"过滤"),e.createVNode("button",{class:"tbtn tbtn-margin-left",style:{width:"auto"},type:"button ",onClick:o[12]||(o[12]=function(){return n.clear&&n.clear.apply(n,arguments)})},"清除")])],512),[[e.vShow,n.openFilter]])],512),[[s]])],512),[[c]]),e.withDirectives(e.createVNode("div",Za,null,512),[[e.vShow,t.isShowproPerties&&n.propertyKeys.length>0],[c]]),e.withDirectives(e.createVNode("div",qa,[e.createVNode("div",Ja,[$a,e.createVNode("div",el,[e.withDirectives(e.createVNode("i",{class:"el-icon-position",title:"停靠",style:{"margin-right":"8px"},onClick:o[13]||(o[13]=function(e){return n.dockBubble(!0)})},null,512),[[e.vShow,n.dockFontShow]]),e.withDirectives(e.createVNode("i",{class:"el-icon-chat-square",title:"悬浮",style:{"margin-right":"8px"},onClick:o[14]||(o[14]=function(e){return n.dockBubble(!1)})},null,512),[[e.vShow,!n.dockFontShow]]),e.createVNode("i",{class:"el-icon-close",title:"关闭",onClick:o[15]||(o[15]=function(){return n.closeBubble&&n.closeBubble.apply(n,arguments)})})])]),e.createVNode("table",tl,[e.createVNode("tbody",null,[ol,e.createVNode("tr",null,[il,e.createVNode("td",null,e.toDisplayString(n.clickGetFeature.layer.id),1)]),e.createVNode("tr",null,[nl,e.createVNode("td",null,e.toDisplayString(n.clickGetFeature.id),1)]),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.clickGetFeature.properties,(function(t,o,i){return e.openBlock(),e.createBlock("tr",{key:i},[e.createVNode("td",null,e.toDisplayString(o),1),e.createVNode("td",null,e.toDisplayString(t),1)])})),128))])])],512),[[c],[e.vShow,n.bubbleShow]])],64)},Va.__file="src/components/layer/mvtlayer-style/mvtlayer-style.vue",Va.install=function(e){e.component(Va.name,Va)};var rl={name:"Sm3dS3mlayerAttribute",props:{selectedLayerName:{type:String},brightness:{type:Number},contrast:{type:Number},hue:{type:Number},saturation:{type:Number},gamma:{type:Number},shadowMode:{type:String},shadowDarkness:{type:Number},multiChoose:{type:Boolean},cullEnabled:{type:Boolean},visibility:{type:String}},setup:function(o){var i=function(o){var i,n,r=e.reactive({layerNames:[],selectedLayerName:"none",brightness:1,contrast:1,hue:0,saturation:1,gamma:1,shadowMode:"noShadow",shadowDarkness:.3,selectEnabled:!0,multiChoose:!1,cullEnabled:!1,visibility:"showAll"});if(o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);function l(){viewer.scene,(i=viewer.scene.layers.layerQueue)&&i.length>0?(i.forEach((function(e,t){r.layerNames.includes(e._name)||r.layerNames.push(e._name)})),(r.selectedLayerName="none")&&(r.selectedLayerName=r.layerNames[0],n=i[0])):r.layerNames=[]}return t.isViewer&&l(),e.watch((function(){return t.isViewer}),(function(e){e&&l()})),e.watch((function(){return t.changeLayers}),(function(e){l()})),e.onBeforeUnmount((function(){i=null})),e.watch((function(){return r.selectedLayerName}),(function(e){var t=r.layerNames.indexOf(e);-1!=t&&(n=i[t])})),e.watch((function(){return r.brightness}),(function(e){n&&(n.brightness=Number(e))})),e.watch((function(){return r.contrast}),(function(e){n&&(n.contrast=Number(e))})),e.watch((function(){return r.hue}),(function(e){n&&(n.hue=Number(e))})),e.watch((function(){return r.saturation}),(function(e){n&&(n.saturation=Number(e))})),e.watch((function(){return r.gamma}),(function(e){n&&(n.gamma=Number(e))})),e.watch((function(){return r.shadowMode}),(function(e){if(n)switch(e){case"noShadow":viewer.shadows=!1,n.shadowType=SuperMap3D.ShadowType.NONE;break;case"chooseShadow":viewer.shadows=!0,n.shadowType=SuperMap3D.ShadowType.SELECTION,n.refresh();break;case"allShadow":viewer.shadows=!0,n.shadowType=SuperMap3D.ShadowType.ALL,n.refresh()}})),e.watch((function(){return r.shadowDarkness}),(function(e){viewer.scene.shadowMap.darkness=Number(e)})),e.watch((function(){return r.multiChoose}),(function(e){n&&(n.multiChoose=e)})),e.watch((function(){return r.selectEnabled}),(function(e){n&&(n.selectEnabled=e)})),e.watch((function(){return r.cullEnabled}),(function(e){n&&(n.cullEnabled=e)})),e.watch((function(){return r.visibility}),(function(e){if(n)switch(e){case"showAll":n.setObjsVisible([],!1);break;case"onlyHideSlection":var t=n.getSelection();n.setObjsVisible(t,!1);break;case"onlyShowSlection":var o=n.getSelection();n.setObjsVisible(o,!0)}})),u({},e.toRefs(r))}(o);return{layerNames:i.layerNames,selectedLayerName:i.selectedLayerName,brightness:i.brightness,contrast:i.contrast,hue:i.hue,saturation:i.saturation,gamma:i.gamma,shadowMode:i.shadowMode,shadowDarkness:i.shadowDarkness,selectEnabled:i.selectEnabled,multiChoose:i.multiChoose,cullEnabled:i.cullEnabled,visibility:i.visibility}}},al={id:"s3mlayer-attribute-panel",class:"sm-panel"},ll={class:"sm-function-module-sub-section",style:{margin:"0"}},sl={class:"sm-half-L"},cl={style:{width:"35%"}},dl={class:"sm-half-L"},ul={style:{width:"35%"}},pl={class:"sm-half-L"},ml={style:{width:"35%"}},hl={class:"sm-half-L"},yl={style:{width:"35%"}},fl={class:"sm-half-L"},vl={style:{width:"35%"}},wl={class:"sm-half-L"},gl={style:{width:"35%"}},bl={class:"sm-half-L",style:{"margin-top":"6px"}},Sl={style:{width:"35%"}},Vl={style:{width:"auto"}},Dl={class:"sm-half-L"},Nl={style:{width:"35%"}},Cl={class:"sm-half-L"},Ml={style:{width:"auto"}},xl={style:{width:"auto"}},Rl={style:{width:"auto"}},kl={class:"sm-half-L"},Ll={style:{width:"35%"}},Pl={value:"onlyShowSlection"},Bl={value:"onlyHideSlection"},Tl={value:"showAll"};rl.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",al,[e.withDirectives(e.createVNode("div",ll,[e.createVNode("div",sl,[e.createVNode("label",cl,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noS3mLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",dl,[e.createVNode("label",ul,e.toDisplayString(t.Resource.brightness),1),e.createVNode(l,{modelValue:n.brightness,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.brightness=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",pl,[e.createVNode("label",ml,e.toDisplayString(t.Resource.contrast),1),e.createVNode(l,{modelValue:n.contrast,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.contrast=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",hl,[e.createVNode("label",yl,e.toDisplayString(t.Resource.hue),1),e.createVNode(l,{modelValue:n.hue,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.hue=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",fl,[e.createVNode("label",vl,e.toDisplayString(t.Resource.saturation),1),e.createVNode(l,{modelValue:n.saturation,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.saturation=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",wl,[e.createVNode("label",gl,e.toDisplayString(t.Resource.gamma),1),e.createVNode(l,{modelValue:n.gamma,"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.gamma=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",bl,[e.createVNode("label",Sl,[e.withDirectives(e.createVNode("input",{type:"radio",value:"noShadow","onUpdate:modelValue":o[7]||(o[7]=function(e){return n.shadowMode=e})},null,512),[[e.vModelRadio,n.shadowMode]]),e.createTextVNode(e.toDisplayString(t.Resource.closeShadow),1)]),e.createVNode("label",Vl,[e.withDirectives(e.createVNode("input",{type:"radio",value:"allShadow","onUpdate:modelValue":o[8]||(o[8]=function(e){return n.shadowMode=e})},null,512),[[e.vModelRadio,n.shadowMode]]),e.createTextVNode(e.toDisplayString(t.Resource.openShadow),1)])]),e.createVNode("div",Dl,[e.createVNode("label",Nl,e.toDisplayString(t.Resource.shadowDarkness),1),e.createVNode(l,{modelValue:n.shadowDarkness,"onUpdate:modelValue":o[9]||(o[9]=function(e){return n.shadowDarkness=e}),min:0,max:1,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",Cl,[e.createVNode("label",Ml,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[10]||(o[10]=function(e){return n.selectEnabled=e})},null,512),[[e.vModelCheckbox,n.selectEnabled]]),e.createTextVNode(e.toDisplayString(t.Resource.selectEnabled),1)]),e.withDirectives(e.createVNode("label",xl,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=function(e){return n.multiChoose=e})},null,512),[[e.vModelCheckbox,n.multiChoose]]),e.createTextVNode(e.toDisplayString(t.Resource.multiChoose),1)],512),[[e.vShow,n.selectEnabled]]),e.createVNode("label",Rl,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[12]||(o[12]=function(e){return n.cullEnabled=e})},null,512),[[e.vModelCheckbox,n.cullEnabled]]),e.createTextVNode(e.toDisplayString(t.Resource.cullEnabled),1)])]),e.createVNode("div",kl,[e.createVNode("label",Ll,e.toDisplayString(t.Resource.visibility),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[13]||(o[13]=function(e){return n.visibility=e})},[e.createVNode("option",Pl,e.toDisplayString(t.Resource.onlyShowSlection),1),e.createVNode("option",Bl,e.toDisplayString(t.Resource.onlyHideSlection),1),e.createVNode("option",Tl,e.toDisplayString(t.Resource.showAll),1)],512),[[e.vModelSelect,n.visibility]])])],512),[[s]])],512)),[[c]])},rl.__file="src/components/layer/s3mlayer-attribute/s3mlayer-attribute.vue",rl.install=function(e){e.component(rl.name,rl)};var El={name:"Sm3dS3mlayerStyle",props:{selectedLayerName:{type:String},foreColor:{type:String},lineColor:{type:String},selectedColor:{type:String},selectColorMode:{type:String},bottomAltitude:{type:Number},LODScale:{type:Number},layerTrans:{type:Number},fillStyle:{type:String},visibleDistanceMin:{type:Number},visibleDistanceMax:{type:Number}},setup:function(o){var i=function(o){var i,n,r=this,a=e.reactive({layerNames:[],selectedLayerName:"none",foreColor:"#ffffff",lineColor:"rgba(27, 27, 27, 1)",selectedColor:"#A40FF4",selectColorMode:"mix",bottomAltitude:0,LODScale:5,layerTrans:1,fillStyle:"fill-and-wireframe",visibleDistanceMin:0,visibleDistanceMax:1e4});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);function s(){viewer.scene,(i=viewer.scene.layers.layerQueue)&&i.length>0?(i.forEach((function(e,t){a.layerNames.includes(e._name)||a.layerNames.push(e._name)})),(a.selectedLayerName="none")&&(a.selectedLayerName=a.layerNames[0],n=i[0])):a.layerNames=[]}return t.isViewer&&s(),e.watch((function(){return t.isViewer}),(function(e){e&&s()})),e.watch((function(){return t.changeLayers}),(function(e){s()})),e.onBeforeUnmount((function(){i=null})),e.watch((function(){return a.selectedLayerName}),(function(e){var t=a.layerNames.indexOf(e);-1!=t&&(n=i[t])})),e.watch((function(){return a.foreColor}),(function(e){n&&(n.style3D.fillForeColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.lineColor}),(function(e){n&&(n.style3D.lineColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.selectedColor}),(function(e){n&&(n.selectedColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.selectColorMode}),(function(e){n&&(n.selectColorType="mix"===e?0:1)})),e.watch((function(){return a.bottomAltitude}),(function(e){n&&(n.style3D.bottomAltitude=Number(e)),n.refresh()})),e.watch((function(){return a.fillStyle}),(function(e){if(n)switch(e){case"fill":n.style3D.fillStyle=SuperMap3D.FillStyle.Fill;break;case"wireframe":n.style3D.fillStyle=SuperMap3D.FillStyle.WireFrame,n.style3D.lineColor=SuperMap3D.Color.fromCssColorString(a.lineColor);break;case"fill-and-wireframe":n.style3D.fillStyle=SuperMap3D.FillStyle.Fill_And_WireFrame,n.style3D.lineColor=SuperMap3D.Color.fromCssColorString(a.lineColor)}n.refresh()})),e.watch((function(){return a.LODScale}),(function(e){n&&(n.lodRangeScale=Number(e))})),e.watch((function(){return a.layerTrans}),(function(e){n&&(n.style3D.fillForeColor.alpha=Number(e))})),e.watch((function(){return a.visibleDistanceMin}),(function(e){""==e&&(e=0),n&&(n.visibleDistanceMin=Number(e))})),e.watch((function(){return a.visibleDistanceMax}),(function(e){""==e&&(e=r.maxNumber),n&&(n.cullEnabled=e),n.visibleDistanceMax=Number(e)})),u({},e.toRefs(a))}(o);return{layerNames:i.layerNames,selectedLayerName:i.selectedLayerName,foreColor:i.foreColor,lineColor:i.lineColor,selectedColor:i.selectedColor,selectColorMode:i.selectColorMode,bottomAltitude:i.bottomAltitude,LODScale:i.LODScale,layerTrans:i.layerTrans,fillStyle:i.fillStyle,visibleDistanceMin:i.visibleDistanceMin,visibleDistanceMax:i.visibleDistanceMax}}},Al={id:"s3mlayer-attribute-panel",class:"sm-panel"},Il={class:"sm-function-module-sub-section",style:{margin:"0"}},Fl={class:"sm-half-L"},Ul={style:{width:"35%"}},_l={class:"sm-half-L"},Ol={style:{width:"35%"}},Hl={class:"sm-half-L"},zl={style:{width:"35%"}},Gl={class:"sm-half-L"},jl={style:{width:"35%"}},Wl={class:"sm-half-L"},Kl={style:{width:"35%"}},Ql={class:"sm-half",style:{width:"63%"}},Xl={style:{width:"auto"}},Yl={style:{width:"auto"}},Zl={class:"sm-half-L"},ql={style:{width:"35%"}},Jl={class:"sm-half-L"},$l=e.createVNode("label",{style:{width:"35%"}},"LOD",-1),es={class:"sm-half-L"},ts={style:{width:"35%"}},os={class:"sm-half-L"},is={style:{width:"35%"}},ns={value:"fill"},rs={value:"wireframe"},as={value:"fill-and-wireframe"},ls={class:"sm-half-L"},ss={style:{width:"35%"}},cs={class:"sm-half-L"},ds={style:{width:"35%"}};El.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-color-picker"),s=e.resolveComponent("el-slider"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Al,[e.withDirectives(e.createVNode("div",Il,[e.createVNode("div",Fl,[e.createVNode("label",Ul,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noS3mLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",_l,[e.createVNode("label",Ol,e.toDisplayString(t.Resource.foreColor),1),e.createVNode(l,{modelValue:n.foreColor,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.foreColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Hl,[e.createVNode("label",zl,e.toDisplayString(t.Resource.lineColor),1),e.createVNode(l,{modelValue:n.lineColor,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.lineColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Gl,[e.createVNode("label",jl,e.toDisplayString(t.Resource.selectedColor),1),e.createVNode(l,{modelValue:n.selectedColor,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.selectedColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Wl,[e.createVNode("label",Kl,e.toDisplayString(t.Resource.selectColorMode),1),e.createVNode("div",Ql,[e.createVNode("label",Xl,[e.withDirectives(e.createVNode("input",{type:"radio",value:"mix","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.selectColorMode=e})},null,512),[[e.vModelRadio,n.selectColorMode]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.mix),1)]),e.createVNode("label",Yl,[e.withDirectives(e.createVNode("input",{type:"radio",value:"replace","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.selectColorMode=e})},null,512),[[e.vModelRadio,n.selectColorMode]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.replace),1)])])]),e.createVNode("div",Zl,[e.createVNode("label",ql,e.toDisplayString(t.Resource.bottomAltitude),1),e.createVNode(s,{modelValue:n.bottomAltitude,"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.bottomAltitude=e}),min:0,step:1,max:1e3,"input-size":"mini",debounce:1e3,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Jl,[$l,e.createVNode(s,{modelValue:n.LODScale,"onUpdate:modelValue":o[8]||(o[8]=function(e){return n.LODScale=e}),min:0,max:10,step:.5,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",es,[e.createVNode("label",ts,e.toDisplayString(t.Resource.layerTrans),1),e.createVNode(s,{modelValue:n.layerTrans,"onUpdate:modelValue":o[9]||(o[9]=function(e){return n.layerTrans=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",os,[e.createVNode("label",is,e.toDisplayString(t.Resource.fillStyle),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[10]||(o[10]=function(e){return n.fillStyle=e})},[e.createVNode("option",ns,e.toDisplayString(t.Resource.fillMode),1),e.createVNode("option",rs,e.toDisplayString(t.Resource.lineMode),1),e.createVNode("option",as,e.toDisplayString(t.Resource.fillAndLine),1)],512),[[e.vModelSelect,n.fillStyle]])]),e.createVNode("div",ls,[e.createVNode("label",ss,e.toDisplayString(t.Resource.visibleDistanceMin),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[11]||(o[11]=function(e){return n.visibleDistanceMin=e})},null,512),[[e.vModelText,n.visibleDistanceMin]])]),e.createVNode("div",cs,[e.createVNode("label",ds,e.toDisplayString(t.Resource.visibleDistanceMax),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[12]||(o[12]=function(e){return n.visibleDistanceMax=e})},null,512),[[e.vModelText,n.visibleDistanceMax]])])],512),[[c]])],512)),[[d]])},El.__file="src/components/layer/s3mlayer-style/s3mlayer-style.vue",El.install=function(e){e.component(El.name,El)};var us={name:"Sm3dS3mlayerOperation",props:{selectedLayerName:{type:String},selectedoffset:{type:Boolean},offsetX:{type:Number},offsetY:{type:Number},offsetZ:{type:Number},polygonOffset:{type:Boolean},polygonOffsetFactor:{type:Number},polygonOffsetUnit:{type:Number}},setup:function(o){var i=function(o){var i,n,r=e.reactive({layerNames:[],selectedLayerName:"none",selectedoffset:!1,offsetX:0,offsetY:0,offsetZ:0,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnit:0});if(o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);function l(){viewer.scene,(i=viewer.scene.layers.layerQueue)&&i.length>0?(i.forEach((function(e,t){r.layerNames.includes(e._name)||r.layerNames.push(e._name)})),(r.selectedLayerName="none")&&(r.selectedLayerName=r.layerNames[0],n=i[0])):r.layerNames=[]}function s(){var e=n.getSelection();n.removeAllObjsOffset(),e.length>0&&n.setObjsOffset(e)}return t.isViewer&&l(),e.watch((function(){return t.isViewer}),(function(e){e&&l()})),e.watch((function(){return t.changeLayers}),(function(e){l()})),e.onBeforeUnmount((function(){i=null})),e.watch((function(){return r.selectedLayerName}),(function(e){var t=r.layerNames.indexOf(e);-1!=t&&(n=i[t])})),e.watch((function(){return r.selectedoffset}),(function(e){if(n)if(e){var t=Number(r.offsetX),o=Number(r.offsetY),i=Number(r.offsetZ);n.selectedTranslate=new SuperMap3D.Cartesian3(t,o,i),viewer.eventManager.addEventListener("CLICK",s,!0),s()}else viewer.eventManager.removeEventListener("CLICK",s),n.selectedTranslate=new SuperMap3D.Cartesian3(0,0,0),n.removeAllObjsOffset(),n.releaseSelection()})),e.watch((function(){return r.offsetX}),(function(e){if(r.selectedoffset){var t=Number(e),o=Number(r.offsetY),i=Number(r.offsetZ);n.selectedTranslate=new SuperMap3D.Cartesian3(t,o,i)}})),e.watch((function(){return r.offsetY}),(function(e){if(r.selectedoffset){var t=Number(r.offsetX),o=Number(r.offsetY),i=Number(r.offsetZ);n.selectedTranslate=new SuperMap3D.Cartesian3(t,o,i)}})),e.watch((function(){return r.offsetZ}),(function(e){if(r.selectedoffset){var t=Number(r.offsetX),o=Number(r.offsetY),i=Number(r.offsetZ);n.selectedTranslate=new SuperMap3D.Cartesian3(t,o,i)}})),e.watch((function(){return r.polygonOffset}),(function(e){n&&(e?n.setPolygonoffset(Number(r.polygonOffsetFactor),Number(e)):n.setPolygonoffset(0,0))})),e.watch((function(){return r.polygonOffsetFactor}),(function(e){n&&r.polygonOffset&&n.setPolygonoffset(Number(e),Number(r.polygonOffsetUnit))})),e.watch((function(){return r.polygonOffsetUnit}),(function(e){n&&r.polygonOffset&&n.setPolygonoffset(Number(r.polygonOffsetFactor),Number(e))})),u({},e.toRefs(r))}(o);return{layerNames:i.layerNames,selectedLayerName:i.selectedLayerName,selectedoffset:i.selectedoffset,offsetX:i.offsetX,offsetY:i.offsetY,offsetZ:i.offsetZ,polygonOffset:i.polygonOffset,polygonOffsetFactor:i.polygonOffsetFactor,polygonOffsetUnit:i.polygonOffsetUnit}}},ps={id:"s3mlayer-attribute-panel",class:"sm-panel"},ms={class:"sm-function-module-sub-section",style:{margin:"0"}},hs={class:"sm-half-L"},ys={style:{width:"35%"}},fs={class:"sm-half-L"},vs={style:{width:"100%"}},ws={class:"sm-half-L"},gs={style:{width:"35%"}},bs={class:"sm-half-L"},Ss={style:{width:"35%"}},Vs={class:"sm-half-L"},Ds={style:{width:"35%"}};function Ns(o){var i,n,r=e.reactive({layerNames:[],selectedLayerName:"none",maxHeight:200,minHeight:0,floodHeight:[0,200],currentHeight:0,floodSpeed:1,floodTrans:.8,cheackedBand:"band1",colorBandShow:!1,floodPositions:[],lineVisible:!0});if(o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);var l,s=SuperMap3D.HypsometricSettingEnum.DisplayMode.FACE,c=new SuperMap3D.HypsometricSetting,d=new SuperMap3D.ColorTable;d.insert(500,new SuperMap3D.Color(0,39/255,148/255)),d.insert(0,new SuperMap3D.Color(149/255,232/255,249/255));var p=[];function m(){viewer.scene,(i=viewer.scene.layers.layerQueue)&&i.length>0&&(i.forEach((function(e,t){r.layerNames.includes(e._name)||r.layerNames.push(e._name)})),(r.selectedLayerName="none")&&(r.selectedLayerName=r.layerNames[0],n=i[0]))}function h(e){e&&(p=e),c.CoverageArea=e;var t=Number(r.minHeight);l=setInterval("ModelFlood()",100),window.ModelFlood=function(){if(t>r.maxHeight)return r.currentHeight=r.maxHeight,void clearInterval(l);r.currentHeight=Number(t.toFixed(2)),c.MaxVisibleValue=t;try{y()}catch(e){console.log(e),clearInterval(l)}t+=parseFloat(r.floodSpeed)/10}}function y(){0!=p.length&&(n.hypsometricSetting={hypsometricSetting:c,analysisMode:SuperMap3D.HypsometricSettingEnum.AnalysisRegionMode.ARM_REGION})}return t.isViewer&&m(),e.watch((function(){return t.isViewer}),(function(e){e&&m()})),e.watch((function(){return t.changeLayers}),(function(e){m()})),e.onBeforeUnmount((function(){i=null,c.destroy(),d.destroy(),c=void 0,d=void 0})),e.watch((function(){return r.selectedLayerName}),(function(e){var t=r.layerNames.indexOf(e);-1!=t&&(n=i[t])})),e.watch((function(){return r.maxHeight}),(function(e){c.MaxVisibleValue=parseInt(e),y()})),e.watch((function(){return r.minHeight}),(function(e){c.MinVisibleValue=parseInt(e),r.currentHeight=parseInt(e),y()})),e.watch((function(){return r.floodHeight}),(function(e){r.minHeight=e[0],r.maxHeight=e[1]})),e.watch((function(){return r.floodTrans}),(function(e){c.Opacity=parseFloat(e),y()})),e.watch((function(){return r.cheackedBand}),(function(e){d=function(e){var t=new SuperMap3D.ColorTable;switch(e){case"band1":t.insert(500,new SuperMap3D.Color(0,39/255,148/255)),t.insert(0,new SuperMap3D.Color(149/255,232/255,249/255));break;case"band2":t.insert(500,new SuperMap3D.Color(162/255,251/255,194/255)),t.insert(0,new SuperMap3D.Color(1,103/255,103/255));break;case"band3":t.insert(500,new SuperMap3D.Color(230/255,198/255,1)),t.insert(0,new SuperMap3D.Color(157/255,0,1));break;case"band4":t.insert(500,new SuperMap3D.Color(210/255,15/255,15/255)),t.insert(100,new SuperMap3D.Color(221/255,224/255,7/255)),t.insert(50,new SuperMap3D.Color(20/255,187/255,18/255)),t.insert(4e3,new SuperMap3D.Color(0,161/255,1)),t.insert(0,new SuperMap3D.Color(9/255,9/255,212/255));break;case"band5":t.insert(500,new SuperMap3D.Color(186/255,1,229/255)),t.insert(0,new SuperMap3D.Color(26/255,185/255,156/255));break;default:t.insert(500,new SuperMap3D.Color(0,39/255,148/255)),t.insert(0,new SuperMap3D.Color(149/255,232/255,249/255))}return t}(e),c.ColorTable=d,y()})),u(u({},e.toRefs(r)),{},{floodClear:function(e){e.preventDefault(),n.hypsometricSetting.hypsometricSetting.MaxVisibleValue=-1e3,clearInterval(l),p=[],r.currentHeight=Number(r.floodHeight[0]),window.handlerPolygon&&me("Polygon")},floodBegin:function(e){e.preventDefault(),c.DisplayMode=s,c._lineColor=new SuperMap3D.Color(1,0,0,1),c.MinVisibleValue=Number(r.floodHeight[0]),c.MaxVisibleValue=0,c.ColorTableMinKey=0,c.ColorTableMaxKey=200,c.ColorTable=d,c.Opacity=Number(r.floodTrans),c.LineInterval=10,window.handlerPolygon||ue("Polygon"),o&&o.floodPositions?h(o.floodPositions):(pe("Polygon",r.lineVisible).then((function(e){var t=window.handlerPolygon;h(e.positions),t.polygon.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate(),viewer.scene.pickPositionSupported||ae.Message.errorMsg(te.NoPickPositionSupported))},changeColor:function(e){r.colorBandShow=!1,r.cheackedBand=e},floodPosition:p})}us.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",ps,[e.withDirectives(e.createVNode("div",ms,[e.createVNode("div",hs,[e.createVNode("label",ys,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noS3mLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",fs,[e.createVNode("label",vs,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.selectedoffset=e})},null,512),[[e.vModelCheckbox,n.selectedoffset]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.selectedoffset),1)]),e.createVNode("div",ws,[e.createVNode("label",gs,e.toDisplayString(t.Resource.offsetX),1),e.createVNode(l,{modelValue:n.offsetX,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.offsetX=e}),min:-50,max:50,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",bs,[e.createVNode("label",Ss,e.toDisplayString(t.Resource.offsetY),1),e.createVNode(l,{modelValue:n.offsetY,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.offsetY=e}),min:-50,max:50,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Vs,[e.createVNode("label",Ds,e.toDisplayString(t.Resource.offsetZ),1),e.createVNode(l,{modelValue:n.offsetZ,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.offsetZ=e}),min:-50,max:50,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])])]),e.createCommentVNode(' <div class="sm-half-L">\r\n        <label style="width:100%">\r\n          <input type="checkbox" v-model="polygonOffset" />\r\n          {{Resource.polygonOffset}}\r\n        </label>\r\n        <div class="sm-half-L">\r\n          <label style="width: 35%;">{{Resource.polygonOffsetFactor}}</label>\r\n          <el-slider\r\n            v-model="polygonOffsetFactor "\r\n            :min="-20"\r\n            :max="20"\r\n            :step="1"\r\n            input-size="mini"\r\n            :debounce="500"\r\n            tooltip-class="tooltip-class"\r\n            style="width:63%"\r\n          ></el-slider>\r\n        </div>\r\n        <div class="sm-half-L">\r\n          <label style="width: 35%;">{{Resource.polygonOffsetUnit}}</label>\r\n          <el-slider\r\n            v-model="polygonOffsetUnit "\r\n            :min="0"\r\n            :max="20"\r\n            :step="1"\r\n            input-size="mini"\r\n            :debounce="500"\r\n            tooltip-class="tooltip-class"\r\n            style="width:63%"\r\n          ></el-slider>\r\n        </div>\r\n      </div> ')],512),[[s]])],512)),[[c]])},us.__file="src/components/layer/s3mlayer-operation/s3mlayer-operation.vue",us.install=function(e){e.component(us.name,us)};var Cs={name:"Sm3dModelFlood",methods:{formatTooltip:function(e){return e+Resource.meter},formatTooltip2:function(e){return e+Resource.meter_second}},setup:function(e){var t=Ns(e);return{layerNames:t.layerNames,selectedLayerName:t.selectedLayerName,floodHeight:t.floodHeight,currentHeight:t.currentHeight,floodSpeed:t.floodSpeed,floodClear:t.floodClear,floodBegin:t.floodBegin}}},Ms={id:"terrain-flood-panel",class:"sm-panel"},xs={class:"sm-function-module-sub-section",style:{margin:"0"}},Rs={class:"sm-half-L"},ks={style:{width:"40%"}},Ls={class:"sm-half-L"},Ps={style:{width:"40%"}},Bs={class:"sm-half-L"},Ts={style:{width:"40%"}},Es={class:"sm-half-L"},As={style:{width:"40%"}},Is={class:"boxchild"};Cs.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Ms,[e.withDirectives(e.createVNode("div",xs,[e.createVNode("div",Rs,[e.createVNode("label",ks,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noS3mLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",Ls,[e.createVNode("label",Ps,e.toDisplayString(t.Resource.visibleHeight),1),e.createVNode(l,{modelValue:n.floodHeight,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.floodHeight=e}),min:0,max:500,range:"",step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class","format-tooltip":a.formatTooltip,style:{width:"58%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",Bs,[e.createVNode("label",Ts,e.toDisplayString(t.Resource.currentHeight),1),e.withDirectives(e.createVNode("input",{class:"sm-input",disabled:"",type:"number",style:{width:"58%"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.currentHeight=e})},null,512),[[e.vModelText,n.currentHeight]])]),e.createVNode("div",Es,[e.createVNode("label",As,e.toDisplayString(t.Resource.floodSpeed),1),e.createVNode(l,{modelValue:n.floodSpeed,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.floodSpeed=e}),max:20,min:.1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class","format-tooltip":a.formatTooltip2,style:{width:"58%"}},null,8,["modelValue","min","format-tooltip"])]),e.createVNode("div",Is,[e.createVNode("button",{onClick:o[5]||(o[5]=function(){return n.floodBegin&&n.floodBegin.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.analyze),1),e.createVNode("button",{onClick:o[6]||(o[6]=function(){return n.floodClear&&n.floodClear.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},Cs.__file="src/components/layer/model-flood/model-flood.vue",Cs.install=function(e){e.component(Cs.name,Cs)};var Fs={name:"Sm3dObliquePhotography",props:{selectedLayerName:{type:String},operationType:{type:String},excavationPositions:{type:Array},flattenPositions:{type:Array},lineVisible:{type:Boolean,default:!0}},setup:function(o){var i=function(o){var i=e.reactive({layerNames:[],selectedLayerName:"none",operationType:"Excavation",lineVisible:!0});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r,a,l=[],s=[];function c(){viewer.scene,(r=viewer.scene.layers.layerQueue)&&r.length>0&&(r.forEach((function(e,t){i.layerNames.includes(e._name)||i.layerNames.push(e._name)})),(i.selectedLayerName="none")&&(i.selectedLayerName=i.layerNames[0],a=r[0]))}function d(e){e&&(l=e),a.addExcavationRegion({position:e,name:"excavation_"+Math.random()})}function p(e){e&&(s=e),a.addFlattenRegion({position:e,name:"flatten"+Math.random()})}return t.isViewer&&c(),e.watch((function(){return t.isViewer}),(function(e){e&&c()})),e.watch((function(){return t.changeLayers}),(function(e){c()})),e.watch((function(){return i.selectedLayerName}),(function(e){var t=i.layerNames.indexOf(e);-1!=t&&(a=r[t])})),e.onBeforeUnmount((function(){r=null})),u(u({},e.toRefs(i)),{},{startExcavation:function(e){e.preventDefault(),window.handlerPolygon||le("Polygon"),o&&o.excavationPositions?d(o.excavationPositions):(se("Polygon",i.lineVisible).then((function(e){var t=window.handlerPolygon;d(e.positions),t.polygon.show=!1,t.polyline.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate(),viewer.scene.pickPositionSupported||ae.Message&&ae.Message.errorMsg(te.NoPickPositionSupported))},clearExcavation:function(e){e.preventDefault(),l=[],window.handlerPolygon&&(a.removeAllExcavationRegion(),ce("Polygon"))},startFlatten:function(e){e.preventDefault(),window.handlerPolygon||le("Polygon"),o&&o.flattenPositions?p(o.flattenPositions):(se("Polygon",i.lineVisible).then((function(e){var t=window.handlerPolygon;p(e.positions),t.polygon.show=!1,t.polyline.show=!1}),(function(e){console.log(e)})),window.handlerPolygon.activate(),viewer.scene.pickPositionSupported||ae.Message&&ae.Message.errorMsg(te.NoPickPositionSupported))},clearFlatten:function(e){e.preventDefault(),window.handlerPolygon&&(a.removeAllFlattenRegion(),ce("Polygon"))},excavationPositions:l,flattenPositions:s})}(o);return{layerNames:i.layerNames,selectedLayerName:i.selectedLayerName,operationType:i.operationType,startExcavation:i.startExcavation,clearExcavation:i.clearExcavation,startFlatten:i.startFlatten,clearFlatten:i.clearFlatten}}},Us={id:"terrain-operation-panel",class:"sm-panel"},_s={class:"sm-function-module-sub-section",style:{margin:"0"}},Os={class:"sm-half-L"},Hs={style:{width:"40%"}},zs={class:"sm-half-L"},Gs={style:{width:"auto"}},js={style:{width:"auto"}},Ws={class:"boxchild"},Ks={class:"boxchild"};Fs.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Us,[e.withDirectives(e.createVNode("div",_s,[e.createVNode("div",Os,[e.createVNode("label",Hs,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"58%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noS3mLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",zs,[e.createVNode("label",Gs,[e.withDirectives(e.createVNode("input",{type:"radio",value:"Excavation","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.operationType=e})},null,512),[[e.vModelRadio,n.operationType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.excavation),1)]),e.createVNode("label",js,[e.withDirectives(e.createVNode("input",{type:"radio",value:"Flatten","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.operationType=e})},null,512),[[e.vModelRadio,n.operationType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.flatten),1)])]),e.withDirectives(e.createVNode("div",Ws,[e.createVNode("button",{onClick:o[4]||(o[4]=function(){return n.startExcavation&&n.startExcavation.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.excavation),1),e.createVNode("button",{onClick:o[5]||(o[5]=function(){return n.clearExcavation&&n.clearExcavation.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)],512),[[e.vShow,"Excavation"===n.operationType]]),e.withDirectives(e.createVNode("div",Ks,[e.createVNode("button",{onClick:o[6]||(o[6]=function(){return n.startFlatten&&n.startFlatten.apply(n,arguments)}),onTouchstart:o[7]||(o[7]=function(){return n.startFlatten&&n.startFlatten.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.flatten),33),e.createVNode("button",{onClick:o[8]||(o[8]=function(){return n.clearFlatten&&n.clearFlatten.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)],512),[[e.vShow,"Flatten"===n.operationType]])],512),[[l]])],512)),[[s]])},Fs.__file="src/components/layer/oblique-photography/oblique-photography.vue",Fs.install=function(e){e.component(Fs.name,Fs)};var Qs={name:"Sm3dImglayerAttribute",props:{selectedLayerName:{type:String},brightness:{type:Number},contrast:{type:Number},hue:{type:Number},saturation:{type:Number},gamma:{type:Number},alpha:{type:Number},transparentBackColor:{type:String},transparentBackColorTolerance:{type:Number}},setup:function(o){var i=function(o){var i,n,r=e.reactive({layerNames:[],selectedLayerName:"none",brightness:1,contrast:1,hue:0,saturation:1,gamma:1,alpha:1,transparentBackColor:"#eecccc",transparentBackColorTolerance:0});if(o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);function l(){viewer.scene,(i=viewer.imageryLayers._layers)&&i.length>1&&(i.forEach((function(e,t){var o=e._imageryProvider instanceof SuperMap3D.MvtProviderGL;if(0===t||o)return!0;r.layerNames.includes(e._imageryProvider.tablename)||r.layerNames.push(e._imageryProvider.tablename)})),(r.selectedLayerName="none")&&(r.selectedLayerName=r.layerNames[0],n=i[1]))}return t.isViewer&&l(),e.watch((function(){return t.isViewer}),(function(e){e&&l()})),e.watch((function(){return t.changeLayers}),(function(e){l()})),e.onBeforeUnmount((function(){i=null})),e.watch((function(){return r.selectedLayerName}),(function(e){var t=r.layerNames.indexOf(e);-1!=t&&(n=i[t+1])})),e.watch((function(){return r.brightness}),(function(e){n&&(n.brightness=Number(e))})),e.watch((function(){return r.contrast}),(function(e){n&&(n.contrast=Number(e))})),e.watch((function(){return r.hue}),(function(e){n&&(n.hue=Number(e))})),e.watch((function(){return r.saturation}),(function(e){n&&(n.saturation=Number(e))})),e.watch((function(){return r.gamma}),(function(e){n&&(n.gamma=Number(e))})),e.watch((function(){return r.alpha}),(function(e){n&&(n.alpha=Number(e))})),e.watch((function(){return r.transparentBackColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);n&&(n.transparentBackColor=t)})),e.watch((function(){return r.transparentBackColorTolerance}),(function(e){n&&(n.transparentBackColorTolerance=Number(e))})),u({},e.toRefs(r))}(o);return{layerNames:i.layerNames,selectedLayerName:i.selectedLayerName,brightness:i.brightness,contrast:i.contrast,hue:i.hue,saturation:i.saturation,gamma:i.gamma,alpha:i.alpha,transparentBackColor:i.transparentBackColor,transparentBackColorTolerance:i.transparentBackColorTolerance}}},Xs={id:"s3mlayer-attribute-panel",class:"sm-panel"},Ys={class:"sm-function-module-sub-section",style:{margin:"0"}},Zs={class:"sm-half-L"},qs={style:{width:"35%"}},Js={class:"sm-half-L"},$s={style:{width:"35%"}},ec={class:"sm-half-L"},tc={style:{width:"35%"}},oc={class:"sm-half-L"},ic={style:{width:"35%"}},nc={class:"sm-half-L"},rc={style:{width:"35%"}},ac={class:"sm-half-L"},lc={style:{width:"35%"}},sc={class:"sm-half-L"},cc={style:{width:"35%"}},dc={class:"sm-half-L"},uc={style:{width:"35%"}},pc={class:"sm-half-L"},mc={style:{width:"35%"}};Qs.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveComponent("el-color-picker"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Xs,[e.withDirectives(e.createVNode("div",Ys,[e.createVNode("div",Zs,[e.createVNode("label",qs,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noImgLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",Js,[e.createVNode("label",$s,e.toDisplayString(t.Resource.brightness),1),e.createVNode(l,{modelValue:n.brightness,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.brightness=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",ec,[e.createVNode("label",tc,e.toDisplayString(t.Resource.contrast),1),e.createVNode(l,{modelValue:n.contrast,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.contrast=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",oc,[e.createVNode("label",ic,e.toDisplayString(t.Resource.hue),1),e.createVNode(l,{modelValue:n.hue,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.hue=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",nc,[e.createVNode("label",rc,e.toDisplayString(t.Resource.saturation),1),e.createVNode(l,{modelValue:n.saturation,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.saturation=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",ac,[e.createVNode("label",lc,e.toDisplayString(t.Resource.gamma),1),e.createVNode(l,{modelValue:n.gamma,"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.gamma=e}),min:0,max:3,step:.05,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",sc,[e.createVNode("label",cc,e.toDisplayString(t.Resource.alpha),1),e.createVNode(l,{modelValue:n.alpha,"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.alpha=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.createVNode("div",dc,[e.createVNode("label",uc,e.toDisplayString(t.Resource.transparentColor),1),e.createVNode(s,{modelValue:n.transparentBackColor,"onUpdate:modelValue":o[8]||(o[8]=function(e){return n.transparentBackColor=e}),size:"mini",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",pc,[e.createVNode("label",mc,e.toDisplayString(t.Resource.transparentColorTolerance),1),e.createVNode(l,{modelValue:n.transparentBackColorTolerance,"onUpdate:modelValue":o[9]||(o[9]=function(e){return n.transparentBackColorTolerance=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])])],512),[[c]])],512)),[[d]])},Qs.__file="src/components/layer/imglayer-attribute/imglayer-attribute.vue",Qs.install=function(e){e.component(Qs.name,Qs)};var hc={name:"Sm3dSceneAttribute",props:{earthShow:{type:Boolean,default:!0},shadows:{type:Boolean,default:!1},cloud:{type:Boolean,default:!1},skyBox:{type:Boolean,default:!1},sunShow:{type:Boolean,default:!1},timeline:{type:Boolean,default:!1},depthAgainst:{type:Boolean,default:!0},atomsphereRender:{type:Boolean,default:!0},fogEffect:{type:Boolean,default:!0},underground:{type:Boolean,default:!0},frameRate:{type:Boolean,default:!0},skyboxSources:{type:Object},surfaceTransparency:{type:Number},cloudsUrl:{type:String},skyboxType:{type:String},uspeed:{type:Number},vspeed:{type:Number},wspeed:{type:Number},viewMode:{type:String},rainAngle:{type:Number},rainSpeed:{type:Number},snowDesity:{type:Number},snowSpeed:{type:Number},snowAngle:{type:Number},snowType:{type:String},isCompass:{type:Boolean},rain:{type:Boolean},snow:{type:Boolean}},setup:function(o){var i=function(o){var i=e.reactive({earthShow:!0,shadows:!1,cloud:!1,skyBox:!1,sunShow:!1,timeline:!1,depthAgainst:!0,atomsphereRender:!0,fogEffect:!0,underground:!0,frameRate:!1,rain:!1,snow:!1,surfaceTransparency:1,cloudsUrl:"public/img/skyboxs/clouds/clouds1.png",skyboxSources:null,skyboxType:"bluesky",uspeed:0,vspeed:0,wspeed:.5,viewMode:"3D",rainAngle:45,rainSpeed:8,snowDesity:10,snowSpeed:4,snowAngle:10,snowType:"0",compass:!1,isCompass:""});if(i.skyboxSources={bluesky:{positiveX:"public/img/skyboxs/bluesky/Right.jpg",negativeX:"public/img/skyboxs/bluesky/Left.jpg",positiveY:"public/img/skyboxs/bluesky/Front.jpg",negativeY:"public/img/skyboxs/bluesky/Back.jpg",positiveZ:"public/img/skyboxs/bluesky/Up.jpg",negativeZ:"public/img/skyboxs/bluesky/Down.jpg"},sunsetglow:{positiveX:"public/img/skyboxs/sunsetglow/Right.jpg",negativeX:"public/img/skyboxs/sunsetglow/Left.jpg",positiveY:"public/img/skyboxs/sunsetglow/Front.jpg",negativeY:"public/img/skyboxs/sunsetglow/Back.jpg",positiveZ:"public/img/skyboxs/sunsetglow/Up.jpg",negativeZ:"public/img/skyboxs/sunsetglow/Down.jpg"}},o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r,a=new SuperMap3D.CloudBox({url:i.cloudsUrl}),l={};for(var s in i.skyboxSources){var c=new SuperMap3D.SkyBox({sources:i.skyboxSources[s]});c.USpeed=i.uspeed,c.VSpeed=i.vspeed,c.WSpeed=i.wspeed,l[s]=c}function d(){if(viewer.scene.frameState.passes.render){for(var e in l)l[e].update(viewer.scene.frameState,!0),l[e].show=!1;viewer.scene.postRender.removeEventListener(d)}}function p(){i.skyBox&&(viewer.scene.camera.positionCartographic.height>22e4?(viewer.scene.skyBox.show=!1,i.atomsphereRender=!0):(viewer.scene.skyBox.show=!0,i.atomsphereRender=!1))}t.isViewer&&(r=viewer.scene.skyBox,viewer.scene.postRender.addEventListener(d),viewer.scene.postProcessStages.snow.uniforms.density=parseFloat(i.snowDesity),viewer.scene.postProcessStages.snow.uniforms.speed=parseFloat(i.snowSpeed),viewer.scene.postProcessStages.rain.uniforms.speed=parseFloat(i.rainSpeed),p());for(var m=viewer.scene.layers.layerQueue,h=0;h<m.length;h++)m[h].shadowType=2;return e.watch((function(){return t.isViewer}),(function(e){e&&(r=viewer.scene.skyBox,viewer.scene.postRender.addEventListener(d),viewer.scene.postProcessStages.snow.uniforms.density=parseFloat(i.snowDesity),viewer.scene.postProcessStages.snow.uniforms.speed=parseFloat(i.snowSpeed),viewer.scene.postProcessStages.rain.uniforms.speed=parseFloat(i.rainSpeed),p())})),e.onBeforeUnmount((function(){for(var e in a.destroy(),l)l[e].destroy();viewer.scene.skyBox=r})),e.watch((function(){return i.earthShow}),(function(e){viewer.scene.globe.show=e})),e.watch((function(){return i.shadows}),(function(e){e?(viewer.shadows=!0,viewer.pcss=!0,viewer.shadowQuality=0,viewer.scene.shadowMap.maximumDistance=2e3,viewer.shadowMap.darkness=.4,viewer.shadowMap.penumbraRatio=.1):viewer.shadows=!1})),e.watch((function(){return i.sunShow}),(function(e){viewer.scene.globe.enableLighting=e})),e.watch((function(){return i.timeline}),(function(e){var t=document.getElementsByClassName("supermap3d-viewer-timelineContainer")[0];e?(t.style.visibility="visible",t.style["z-index"]=99999999999):t.style.visibility="hidden"})),e.watch((function(){return i.depthAgainst}),(function(e){viewer.scene.globe.depthTestAgainstTerrain=e})),e.watch((function(){return i.atomsphereRender}),(function(e){viewer.scene.skyAtmosphere.show=e})),e.watch((function(){return i.fogEffect}),(function(e){viewer.scene.fog.enabled=e})),e.watch((function(){return i.surfaceTransparency}),(function(e){viewer.scene.globe.globeAlpha=parseFloat(e)})),e.watch((function(){return i.underground}),(function(e){viewer.scene.undergroundMode=e,e?(viewer.scene.screenSpaceCameraController.minimumZoomDistance=-1e3,viewer.scene.terrainProvider.isCreateSkirt=!1):(viewer.scene.screenSpaceCameraController.minimumZoomDistance=1,viewer.scene.terrainProvider.isCreateSkirt=!0)})),e.watch((function(){return i.frameRate}),(function(e){viewer.scene.debugShowFramesPerSecond=e})),e.watch((function(){return i.cloud}),(function(e){viewer.scene.cloudBox=e?a:null})),e.watch((function(){return i.cloudsUrl}),(function(e){viewer.scene.cloudBox.url=e})),e.watch((function(){return i.skyBox}),(function(e){if(e){var t=viewer.scene.camera.positionCartographic.height;viewer.scene.postRender.addEventListener(p),viewer.scene.skyBox=l[i.skyboxType],t<22e4?(viewer.scene.skyBox.show=!0,i.atomsphereRender=!1):i.atomsphereRender=!0}else i.atomsphereRender=!0,viewer.scene.skyBox.show=!1,viewer.scene.skyBox=r,viewer.scene.postRender.removeEventListener(p)})),e.watch((function(){return i.skyboxType}),(function(e){i.skyBox&&(l[e].show=!0,viewer.scene.skyBox=l[e])})),e.watch((function(){return i.uspeed}),(function(e){l[i.skyboxType].USpeed=Number(e),i.skyBox&&(viewer.scene.skyBox.USpeed=Number(e))})),e.watch((function(){return i.vspeed}),(function(e){l[i.skyboxType].VSpeed=Number(e),i.skyBox&&(viewer.scene.skyBox.VSpeed=Number(e))})),e.watch((function(){return i.wspeed}),(function(e){l[i.skyboxType].WSpeed=Number(e),i.skyBox&&(viewer.scene.skyBox.WSpeed=Number(e))})),e.watch((function(){return i.viewMode}),(function(e){viewer.scene.mode="2D"===e?SuperMap3D.SceneMode.SCENE2D:"3D"===e?SuperMap3D.SceneMode.SCENE3D:SuperMap3D.SceneMode.COLUMBUS_VIEW})),e.watch((function(){return i.rain}),(function(e){viewer.scene.postProcessStages.rain.enabled=e})),e.watch((function(){return i.snow}),(function(e){viewer.scene.postProcessStages.snow.enabled=e,console.log(viewer.scene.postProcessStages.snow.uniforms)})),e.watch((function(){return i.rainAngle}),(function(e){viewer.scene.postProcessStages.rain.uniforms.angle=parseFloat(e)})),e.watch((function(){return i.rainSpeed}),(function(e){viewer.scene.postProcessStages.rain.uniforms.speed=parseFloat(e)})),e.watch((function(){return i.snowDesity}),(function(e){viewer.scene.postProcessStages.snow.uniforms.density=parseFloat(e)})),e.watch((function(){return i.snowSpeed}),(function(e){viewer.scene.postProcessStages.snow.uniforms.speed=parseFloat(e)})),e.watch((function(){return i.snowAngle}),(function(e){viewer.scene.postProcessStages.snow.uniforms.angle=parseFloat(e)})),e.watch((function(){return i.snowType}),(function(e){switch(e){case"0":i.snowDesity=5,i.snowSpeed=2;break;case"1":i.snowDesity=10,i.snowSpeed=4;break;case"2":i.snowDesity=15,i.snowSpeed=6;break;case"3":i.snowDesity=20,i.snowSpeed=10;break;default:i.snowDesity=5,i.snowSpeed=2}})),e.watch((function(){return i.isCompass}),(function(e){i.compass=e?"Sm3dCompass":""})),u({},e.toRefs(i))}(o);return{earthShow:i.earthShow,shadows:i.shadows,cloud:i.cloud,skyBox:i.skyBox,sunShow:i.sunShow,timeline:i.timeline,depthAgainst:i.depthAgainst,atomsphereRender:i.atomsphereRender,fogEffect:i.fogEffect,underground:i.underground,frameRate:i.frameRate,Facade:i.Facade,surfaceTransparency:i.surfaceTransparency,viewMode:i.viewMode,rain:i.rain,snow:i.snow,snowType:i.snowType,isCompass:i.isCompass,compass:i.compass}}},yc={id:"s3mlayer-attribute-panel",class:"sm-panel"},fc={class:"sm-function-module-sub-section",style:{margin:"0"}},vc={class:"sm-half-L"},wc={style:{width:"28%"}},gc={style:{width:"33%"}},bc={style:{width:"33%"}},Sc={style:{width:"28%"}},Vc={style:{width:"33%"}},Dc={style:{width:"33%"}},Nc={style:{width:"28%"}},Cc={style:{width:"33%"}},Mc={style:{width:"33%"}},xc={style:{width:"28%"}},Rc={style:{width:"33%"}},kc={style:{width:"33%"}},Lc={style:{width:"28%"}},Pc={style:{width:"33%"}},Bc=e.createVNode("label",{style:{width:"33%"}},null,-1),Tc={class:"sm-half-L"},Ec={style:{width:"35%"}},Ac=e.createVNode("option",{value:"3D"},"3D",-1),Ic=e.createVNode("option",{value:"2.5D"},"2.5D",-1),Fc=e.createVNode("option",{value:"2D"},"2D",-1),Uc={class:"sm-half-L"},_c={style:{width:"35%"}},Oc={class:"sm-half-L"},Hc=e.createVNode("label",{style:{width:"35%"}},"下雪类型",-1),zc=e.createVNode("option",{value:"0"},"小雪",-1),Gc=e.createVNode("option",{value:"1"},"中雪",-1),jc=e.createVNode("option",{value:"2"},"大雪",-1),Wc=e.createVNode("option",{value:"3"},"暴雪",-1);function Kc(o){var i,n,r,a=e.reactive({maxDistance:200,maxHeight:100,setLodrange:!1,layerNames:[],selectedLayerName:"none",lodrange:.01});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);function s(){viewer.scene,(n=viewer.scene.layers.layerQueue)&&n.length>0&&(n.forEach((function(e,t){a.layerNames.includes(e._name)||a.layerNames.push(e._name)})),(a.selectedLayerName="none")&&(a.selectedLayerName=a.layerNames[0],r=n[0]))}function c(){i.clear(),ce("Polyline"),tooltip.setVisible(!1)}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),(i=new SuperMap3D.Facade(viewer.scene)).build(),s()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),(i=new SuperMap3D.Facade(viewer.scene)).build(),s())})),e.watch((function(){return t.changeLayers}),(function(e){s()})),e.onBeforeUnmount((function(){c(),i.destroy()})),e.watch((function(){return a.maxDistance}),(function(e){i.farDistance=Number(e)})),e.watch((function(){return a.maxHeight}),(function(e){i.maxHeight=Number(e)})),e.watch((function(){return a.selectedLayerName}),(function(e){var t=a.layerNames.indexOf(e);-1!=t&&(r=n[t])})),e.watch((function(){return a.lodrange}),(function(e){r&&r.setLodRangeScale(Number(e))})),e.watch((function(){return a.setLodrange}),(function(e){r&&(e?r.setLodRangeScale(Number(a.lodrange)):r.setLodRangeScale(1))})),u(u({},e.toRefs(a)),{},{setRegion:function(){tooltip.showAt(" <p>点击鼠标左键开始绘制起点</p><p>绘制两点确定区域宽度</p> <p>单击右键结束分析</p><p>设置模型精细度调整图片清晰度</p>","350px"),window.handlerPolyline||le("Polyline"),se("Polyline").then((function(e){var t=e.result.object.positions[0],o=e.result.object.positions[1];i.startPoint=t,i.endPoint=o;var n=window.handlerPolyline;n.polyline.show=!1,window.polylineTransparent.show=!1,n.deactivate(),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()},execute:function(){i.readyPromise.then((function(e){!function(e){var t=new Image;t.src=e,t.onload=function(){var e=function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}(t).toDataURL("image/jpeg"),o=document.createElement("a"),i=new MouseEvent("click");o.download=(new Date).getTime()+".jpg",o.href=e,o.dispatchEvent(i)}}(e)}))},clear:c})}hc.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",yc,[e.withDirectives(e.createVNode("div",fc,[e.createVNode("div",vc,[e.createVNode("label",wc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.earthShow=e})},null,512),[[e.vModelCheckbox,n.earthShow]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.earthShow),1)]),e.createVNode("label",gc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.timeline=e})},null,512),[[e.vModelCheckbox,n.timeline]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.timeline),1)]),e.createVNode("label",bc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.atomsphereRender=e})},null,512),[[e.vModelCheckbox,n.atomsphereRender]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.atomsphereRender),1)]),e.createVNode("label",Sc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.sunShow=e})},null,512),[[e.vModelCheckbox,n.sunShow]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.sunShow),1)]),e.createVNode("label",Vc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.fogEffect=e})},null,512),[[e.vModelCheckbox,n.fogEffect]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.fogEffect),1)]),e.createVNode("label",Dc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.depthAgainst=e})},null,512),[[e.vModelCheckbox,n.depthAgainst]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.depthAgainst),1)]),e.createVNode("label",Nc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[7]||(o[7]=function(e){return n.shadows=e})},null,512),[[e.vModelCheckbox,n.shadows]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.shadowMap),1)]),e.createVNode("label",Cc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=function(e){return n.underground=e})},null,512),[[e.vModelCheckbox,n.underground]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.underground),1)]),e.createVNode("label",Mc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=function(e){return n.frameRate=e})},null,512),[[e.vModelCheckbox,n.frameRate]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.frameRate),1)]),e.createVNode("label",xc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[10]||(o[10]=function(e){return n.cloud=e})},null,512),[[e.vModelCheckbox,n.cloud]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.cloud),1)]),e.createVNode("label",Rc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=function(e){return n.skyBox=e})},null,512),[[e.vModelCheckbox,n.skyBox]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.skyBox),1)]),e.createVNode("label",kc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[12]||(o[12]=function(e){return n.rain=e})},null,512),[[e.vModelCheckbox,n.rain]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.rain),1)]),e.createVNode("label",Lc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[13]||(o[13]=function(e){return n.snow=e})},null,512),[[e.vModelCheckbox,n.snow]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.snow),1)]),e.createVNode("label",Pc,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[14]||(o[14]=function(e){return n.isCompass=e})},null,512),[[e.vModelCheckbox,n.isCompass]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.compass),1)]),Bc]),e.createVNode("div",Tc,[e.createVNode("label",Ec,e.toDisplayString(t.Resource.viewMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[15]||(o[15]=function(e){return n.viewMode=e})},[Ac,Ic,Fc],512),[[e.vModelSelect,n.viewMode]])]),e.createVNode("div",Uc,[e.createVNode("label",_c,e.toDisplayString(t.Resource.surfaceTransparency),1),e.createVNode(l,{modelValue:n.surfaceTransparency,"onUpdate:modelValue":o[16]||(o[16]=function(e){return n.surfaceTransparency=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.withDirectives(e.createVNode("div",Oc,[Hc,e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[17]||(o[17]=function(e){return n.snowType=e})},[zc,Gc,jc,Wc],512),[[e.vModelSelect,n.snowType]])],512),[[e.vShow,!1]])],512),[[s]])],512),[[c]]),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.compass)))],64)},hc.__file="src/components/scene/scene-attribute/scene-attribute.vue",hc.install=function(e){e.component(hc.name,hc)};var Qc={name:"Sm3dFacade",props:{maxDistance:{type:Number},maxHeight:{type:Number},setLodrange:{type:Boolean},lodrange:{type:Number},selectedLayerName:{type:String}},methods:{formatTooltip:function(e){return e+Resource.meter}},setup:function(e){var t=Kc(e),o=t.maxDistance,i=t.maxHeight,n=t.layerNames;return{maxDistance:o,maxHeight:i,setLodrange:t.setLodrange,layerNames:n,selectedLayerName:t.selectedLayerName,lodrange:t.lodrange,setRegion:t.setRegion,execute:t.execute,clear:t.clear}}},Xc={id:"facade-panel",class:"sm-panel"},Yc={class:"sm-function-module-sub-section",style:{margin:"0"}},Zc={class:"sm-half-L"},qc={style:{width:"35%"}},Jc={class:"sm-half-L"},$c={style:{width:"35%"}},ed={class:"sm-half-L"},td={style:{width:"100%"}},od={class:"sm-half-L"},id={style:{width:"35%"}},nd={class:"sm-half-L"},rd={style:{width:"35%"}},ad={class:"boxchild flex-between"};function ld(o){var i,n,r=e.reactive({resetPosition:"",isfull:!1});if(r.resetPosition=new SuperMap3D.Cartesian3.fromDegrees(110.60396458865515,34.54408834959379,30644793.325518917),o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);r.isfull&&y();var l,s,c=e.ref(null),d=!1;function p(){(n=new SuperMap3D.Cartesian2).x=i.canvas.clientWidth/2,n.y=i.canvas.clientHeight/2,i.postRender.addEventListener(m),window.addEventListener("resize",(function(){n.x=i.canvas.clientWidth/2,n.y=i.canvas.clientHeight/2}))}function m(){var e=i.camera.heading,t="rotate("+-SuperMap3D.Math.toDegrees(e)+"deg)";c.value.style.transform=t,d&&(e<=.05||e>=6.23)&&(i.camera.stopFlyCircle(),e=0,d=!1)}function h(){var e=i.pickPosition(n),t=viewer.camera.position,o=SuperMap3D.Cartesian3.distance(e,t);return o>=1e3?o/30:o>=20?o/20:o>0?.5:0}function y(){var e;document.fullscreenElement?(r.isfull=!1,document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()):(r.isfull=!0,(e=document.documentElement).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())}return t.isViewer&&(i=viewer.scene,p()),e.watch((function(){return t.isViewer}),(function(e){e&&(i=viewer.scene,p())})),e.onBeforeUnmount((function(){i.postRender.removeEventListener(m)})),u(u({},e.toRefs(r)),{},{compass_dom:c,reduceCompass:function(){var e=i.camera.heading,t=8;if(!(e<=.05||e>=6.23)){(e<=.5||e>=5.8)&&(t=2),d=!0;var o=i.pickPosition(n);if(i.camera.heading-SuperMap3D.Math.PI>=0)return i.camera.speedRatio=t,void i.camera.flyCircle(o);i.camera.speedRatio=-t,i.camera.flyCircle(o)}},reset:function(){viewer.camera.flyTo({destination:r.resetPosition})},fullscreenchange:y,zoomIn:function(){var e=10;clearInterval(l),l=setInterval((function(){e=h(),viewer.camera.zoomIn(e)}),30)},mouseup_zoomIn:function(){clearInterval(l)},zoomOut:function(){var e=10;clearInterval(s),s=setInterval((function(){e=h(),viewer.camera.zoomOut(e)}),30)},mouseup_zoomOut:function(){clearInterval(s)}})}Qc.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Xc,[e.withDirectives(e.createVNode("div",Yc,[e.createVNode("div",Zc,[e.createVNode("label",qc,e.toDisplayString(t.Resource.facadeDistance),1),e.createVNode(l,{modelValue:n.maxDistance,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.maxDistance=e}),min:1,max:1e3,step:1,"input-size":"mini",debounce:500,"format-tooltip":a.formatTooltip,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",Jc,[e.createVNode("label",$c,e.toDisplayString(t.Resource.facadeHeight),1),e.createVNode(l,{modelValue:n.maxHeight,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.maxHeight=e}),min:1,max:200,step:1,"input-size":"mini",debounce:500,"format-tooltip":a.formatTooltip,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","format-tooltip"])]),e.createVNode("div",ed,[e.createVNode("label",td,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.setLodrange=e})},null,512),[[e.vModelCheckbox,n.setLodrange]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.setLodrange),1)]),e.withDirectives(e.createVNode("div",od,[e.createVNode("label",id,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])],512),[[e.vShow,n.setLodrange]]),e.withDirectives(e.createVNode("div",nd,[e.createVNode("label",rd,e.toDisplayString(t.Resource.lodrange),1),e.createVNode(l,{modelValue:n.lodrange,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.lodrange=e}),min:.01,max:2,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","min","step"])],512),[[e.vShow,n.setLodrange]])]),e.createVNode("div",ad,[e.createVNode("button",{class:"tbtn",type:"button",style:{width:"auto"},onClick:o[6]||(o[6]=function(){return n.setRegion&&n.setRegion.apply(n,arguments)})},e.toDisplayString(t.Resource.setRegion),1),e.createVNode("button",{class:"tbtn",type:"button",style:{width:"auto"},onClick:o[7]||(o[7]=function(){return n.execute&&n.execute.apply(n,arguments)})},e.toDisplayString(t.Resource.execute),1),e.createVNode("button",{onClick:o[8]||(o[8]=function(){return n.clear&&n.clear.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},Qc.__file="src/components/scene/facade/facade.vue",Qc.install=function(e){e.component(Qc.name,Qc)};var sd={name:"Sm3dCompass",props:{isfull:{type:Boolean,default:!1}},setup:function(e){var t=ld(e);return{compass_dom:t.compass_dom,isfull:t.isfull,reduceCompass:t.reduceCompass,reset:t.reset,fullscreenchange:t.fullscreenchange,zoomIn:t.zoomIn,mouseup_zoomIn:t.mouseup_zoomIn,zoomOut:t.zoomOut,mouseup_zoomOut:t.mouseup_zoomOut}}},cd={id:"compass-panel",class:"compass-panel"},dd={id:"compass",style:{transform:"rotate(-45deg)",display:"inline-block"},class:"iconfont iconzhibeizhen",ref:"compass_dom"},ud=e.createVNode("span",{class:"iconfont iconzhongzhi"},null,-1),pd=e.createVNode("span",{class:"iconfont iconfangda"},null,-1),md=e.createVNode("span",{class:"iconfont iconsuoxiao"},null,-1);sd.render=function(t,o,i,n,r,a){return e.openBlock(),e.createBlock("div",cd,[e.createVNode("div",{class:"btn_box",style:{"border-radius":"50%"},onClick:o[1]||(o[1]=function(){return n.reduceCompass&&n.reduceCompass.apply(n,arguments)}),title:t.Resource.compass},[e.createVNode("span",dd,null,512)],8,["title"]),e.createVNode("div",{class:"btn_box",onClick:o[2]||(o[2]=function(){return n.reset&&n.reset.apply(n,arguments)}),title:t.Resource.reset},[ud],8,["title"]),e.createVNode("div",{class:"btn_box",onMousedown:o[3]||(o[3]=function(){return n.zoomIn&&n.zoomIn.apply(n,arguments)}),onMouseup:o[4]||(o[4]=function(){return n.mouseup_zoomIn&&n.mouseup_zoomIn.apply(n,arguments)}),title:t.Resource.zoomIn},[pd],40,["title"]),e.createVNode("div",{class:"btn_box",onMousedown:o[5]||(o[5]=function(){return n.zoomOut&&n.zoomOut.apply(n,arguments)}),onMouseup:o[6]||(o[6]=function(){return n.mouseup_zoomOut&&n.mouseup_zoomOut.apply(n,arguments)}),title:t.Resource.zoomOut},[md],40,["title"]),e.createVNode("div",{class:"btn_box",onClick:o[7]||(o[7]=function(){return n.fullscreenchange&&n.fullscreenchange.apply(n,arguments)}),title:t.Resource.fullScreen},[e.createVNode("span",{class:["iconfont",n.isfull?"iconshouqi1":"iconquanping"]},null,2)],8,["title"])])},sd.__file="src/components/scene/compass/compass.vue",sd.install=function(e){e.component(sd.name,sd)};var hd=function(){function e(){a(this,e)}return s(e,[{key:"createXMLflyLine",value:function(e){var t=new DOMParser;window.parser=t;var o=t.parseFromString("<cusxmlRoute></cusxmlRoute>","text/xml");window.xmlDoc=o;var i=this.createSceneRouteNode(o),n=this.createRouteNode(o,e),r=this.createRouteStyleNode(o);n.appendChild(r);var a=e.routeStops;if(!(a.length<2)){for(var l=0;l<a.length;l++){var s=a[l],c={longitude:s.point[0],latitude:s.point[1],altitude:s.point[2],heading:s.heading*(180/Math.PI),tilt:s.tilt*(180/Math.PI)+90},d=this.createStopNode(o,c,s,l);n.appendChild(d)}return i.appendChild(n),o.children[0].appendChild(i),o.children[0].innerHTML}console.warn("节点数小于2")}},{key:"createSceneRouteNode",value:function(e){var t=e.createElement("SceneRoute");return t.setAttribute("xmlns","http://www.supermap.com.cn/ugc60"),t}},{key:"createRouteNode",value:function(e,t){var o=e.createElement("route"),i={name:t.routeName||"飞行路线",speed:t.speed||"200",lineType:"0",showroutestop:"False",showrouteline:"False",altitudefree:"False",headingfree:"False",tiltfree:"False",flycircle:"False",alongline:t.isAlongLine||"False"};for(var n in i)o.setAttribute(n,i[n]);return o}},{key:"createRouteStyleNode",value:function(e){var t=e.createElement("style"),o=e.createElement("geostyle3d"),i=e.createElement("linecolor");i.textContent="RGBA(147,112,219,255)";var n=e.createElement("linewidth");n.textContent=2;var r=e.createElement("altitudeMode");r.textContent="Absolute";var a=e.createElement("bottomAltitude");return a.textContent=0,o.appendChild(i),o.appendChild(n),o.appendChild(r),o.appendChild(a),t.appendChild(o),t}},{key:"createStopNode",value:function(e,t,o,i){var n=e.createElement("routestop"),r={name:o.stopName||"Stop"+(i+1),speed:o.speed,excluded:"False",viewType:"camera"};for(var a in r)n.setAttribute(a,r[a]);var l=this.createStopCameraNode(e,t);n.appendChild(l);var s=this.createStopStyleNode(e);n.appendChild(s);var c=this.createStopSettingNode(e,o);return n.appendChild(c),n}},{key:"createStopCameraNode",value:function(e,t){var o=e.createElement("camera");for(var i in t){var n=e.createElement(i);n.textContent=t[i],o.appendChild(n)}return o}},{key:"createStopStyleNode",value:function(e){var t={icon:"",markersize:4.8,markericonscale:1,markercolor:"RGBA(255, 255, 255, 255)"},o=e.createElement("style"),i=e.createElement("geostyle3d");for(var n in t){var r=e.createElement(n);r.textContent=t[n],i.appendChild(r)}return o.appendChild(i),o}},{key:"createStopSettingNode",value:function(e,t){var o=e.createElement("setting"),i={turnTime:t.surroundDuration||1.5,turnSlowly:"False",stopPlayMode:t.stopPlayMode||"StopPause",autoPlay:"False",pauseTime:t.waitTime||0,angularSpeed:1};for(var n in i){var r=e.createElement(n);r.textContent=i[n],o.appendChild(r)}return o}}]),e}();function yd(o){var i,n,r=e.reactive({routeType:"designatedRoute",fileSrc:"",fpfUrl:null,selectedStopIndex:0,showRoute:!1,showStop:!1,currentStopNames:[],customRouteNames:[],customRouteSelectedIndex:null,routeStops:[],selectedAddedStopIndex:null,setStopName:"Stop-1",setStopSpeed:0,stopPlayMode:"StopPause",waitTime:0,surroundDuration:1,isAlongline:!1,routeSpeed:200});if(o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);var l,s,c=e.ref(null),d=new FileReader,p=[];function m(){n=new SuperMap3D.RouteCollection(viewer.entities),i=new SuperMap3D.FlyManager({scene:viewer.scene,routes:n}),s=new hd,r.fpfUrl&&h()}function h(){i.stop(),n.fromFile(r.fpfUrl),i.readyPromise.then((function(){var e=i.currentRoute;e.isLineVisible=r.showRoute,e.isStopVisible=r.showStop,f()}))}function y(){n.readyPromise.then((function(){i.routes=n;var e=i.currentRoute;e.isLineVisible=r.showRoute,e.isStopVisible=r.showStop,f()}))}function f(){r.currentStopNames.length=0;for(var e=0,t=(l=i.getAllRouteStops()).length;e<t;e++){var o=l[e].stopName||"Stop"+(e+1);r.currentStopNames.push(o)}}function v(){if(i.stop(),!(p.length<1))if(p.splice(r.customRouteSelectedIndex,1),r.customRouteNames.splice(r.customRouteSelectedIndex,1),p.length>0)r.customRouteSelectedIndex=0;else{r.customRouteSelectedIndex=null,r.currentStopNames.length=0;var e=i.currentRoute;e&&e.clear()}}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),m()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),m())})),e.onMounted((function(){c.value.addEventListener("change",(function(e){i.stop();var t=i.currentRoute;t&&t.clear(),n=new SuperMap3D.RouteCollection(viewer.entities);var o=e.target.files[0];o&&(r.fileSrc=c.value.value,d.onload=function(e){var t=e.target.result;n.fromXML(t)},d.readAsBinaryString(o),y())}))})),e.watch((function(){return r.selectedStopIndex}),(function(e){i&&i.stop();var t=Number(e),o=l[t];i.viewToStop(o)})),e.watch((function(){return r.showRoute}),(function(e){var t=i.currentRoute;t&&(t.isLineVisible=e)})),e.watch((function(){return r.showStop}),(function(e){var t=i.currentRoute;t&&(t.isStopVisible=e)})),e.watch((function(){return r.fpfUrl}),(function(e){h()})),e.watch((function(){return r.customRouteSelectedIndex}),(function(e){if(null!==e){i&&i.stop();var t=i.currentRoute;t&&t.clear(),(n=new SuperMap3D.RouteCollection(viewer.entities)).fromXML(p[e]),y()}})),e.watch((function(){return r.selectedAddedStopIndex}),(function(e){var t=r.routeStops[e];t&&viewer.camera.setView({destination:SuperMap3D.Cartesian3.fromDegrees(t.point[0],t.point[1],t.point[2]),orientation:{heading:t.heading,pitch:t.tilt,roll:0}})})),e.watch((function(){return r.routeType}),(function(e){"customRoute"===e?(window.tooltip.showAt(" <p>调整当前相机位置和视角</p><p>以当前相机位置和视角设置站点</p><p>点击添加保存此站点</p>","80%"),setTimeout((function(){window.tooltip.setVisible(!1)}),5e3)):window.tooltip.setVisible(!1);var t=i.currentRoute;t&&(t.isLineVisible=!1,t.isStopVisible=!1)})),e.onBeforeUnmount((function(){r=null,i=n=null,l=null,s=p=null})),u(u({},e.toRefs(r)),{},{flyFile_dom:c,chooseFile:function(){c.value.click()},flyStart:function(){i.readyPromise.then((function(){i.play()}))},flyPause:function(){i&&i.pause()},flyStop:function(){i&&i.stop()},addStop:function(){i.stop();var e=viewer.camera.position,t=ae.CartesiantoDegrees(e),o={stopName:r.setStopName,point:t,heading:viewer.camera.heading,tilt:viewer.camera.pitch,speed:r.setStopSpeed,stopPlayMode:r.stopPlayMode,surroundDuration:r.surroundDuration,waitTime:r.waitTime};if(r.routeStops.push(o),r.routeStops.length>0){var n=r.routeStops.length,a=r.routeStops[n-1].stopName.split("-")[1]||1,l="Stop-"+(Number(a)+1);r.setStopName=l}r.selectedAddedStopIndex=r.routeStops.length-1},saveStop:function(){if(r.routeStops.length<2)ae.Message.warnMsg("节点小于2");else{p.length>0&&v();var e={routeName:"飞行路线_"+(p.length+1),speed:r.routeSpeed,isAlongLine:"False",routeStops:r.routeStops},t=s.createXMLflyLine(e);p.push(t),r.customRouteNames.push(e.routeName),null===r.customRouteSelectedIndex&&(r.customRouteSelectedIndex=0)}},restStops:function(){r.routeStops.length=0,r.setStopName="Stop-1",r.setStopSpeed=0,r.stopPlayMode="StopPause",r.waitTime=0,r.surroundDuration=1},downLoad:function(){var e=p[r.customRouteSelectedIndex];if(e){var t=new Blob([e]),o=document.createElement("a");o.download="fly-route.fpf",o.href=URL.createObjectURL(t),o.click()}},clearRoute:v,clearStop:function(){r.routeStops.splice(r.selectedAddedStopIndex,1),r.routeStops.length>0?r.selectedAddedStopIndex=r.routeStops.length-1:(r.selectedAddedStopIndex=null,r.setStopName="Stop-1")}})}var fd={name:"Sm3dFlyRoute",props:{fpfUrl:{type:String},showRoute:{type:Boolean},showStop:{type:Boolean},stopPlayMode:{type:String},waitTime:{type:Number},surroundDuration:{type:Number},isAlongline:{type:Boolean},routeSpeed:{type:Number}},setup:function(e){var t=yd(e);return{routeType:t.routeType,fileSrc:t.fileSrc,fpfUrl:t.fpfUrl,selectedStopIndex:t.selectedStopIndex,showRoute:t.showRoute,showStop:t.showStop,flyFile_dom:t.flyFile_dom,chooseFile:t.chooseFile,currentStopNames:t.currentStopNames,flyStart:t.flyStart,flyPause:t.flyPause,flyStop:t.flyStop,routeStops:t.routeStops,selectedAddedStopIndex:t.selectedAddedStopIndex,routeSpeed:t.routeSpeed,clearStop:t.clearStop,addStop:t.addStop,saveStop:t.saveStop,restStops:t.restStops,customRouteNames:t.customRouteNames,customRouteSelectedIndex:t.customRouteSelectedIndex,downLoad:t.downLoad,clearRoute:t.clearRoute}}},vd={id:"fly-route-panel",class:"sm-panel"},wd={class:"sm-function-module-sub-section",style:{margin:"0"}},gd={class:"sm-half-L"},bd={style:{width:"auto"}},Sd={style:{width:"auto"}},Vd={class:"sm-half-L"},Dd={class:"sm-half-L"},Nd={style:{width:"35%"}},Cd={type:"file",accept:".fpf",id:"flyFile",style:{display:"none"},ref:"flyFile_dom"},Md={class:"sm-half-L"},xd={style:{width:"35%"}},Rd={class:"sm-half-L flex-between"},kd={style:{width:"auto"}},Ld={style:{width:"auto"}},Pd={class:"sm-half-L flex-around"},Bd={class:"sm-half-L"},Td={class:"sm-half-L"},Ed={style:{width:"35%"}},Ad={class:"sm-half-L"},Id={style:{width:"35%"}},Fd={class:"boxchild"},Ud={class:"sm-half-L"},_d={style:{margin:"15px 0 5px 0"}},Od=e.createVNode("div",{class:"sm-point"},null,-1),Hd={class:"sm-half-L"},zd={style:{width:"35%"}},Gd={class:"sm-half-L"},jd={style:{width:"35%"}},Wd={class:"sm-half-L flex-between"},Kd={style:{width:"auto"}},Qd={style:{width:"auto"}},Xd={class:"sm-half-L flex-around"},Yd={class:"boxchild",style:{"margin-bottom":"-5px"}};fd.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",vd,[e.withDirectives(e.createVNode("div",wd,[e.createVNode("div",gd,[e.createVNode("label",bd,[e.withDirectives(e.createVNode("input",{type:"radio",value:"designatedRoute","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.routeType=e})},null,512),[[e.vModelRadio,n.routeType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.designatedRoute),1)]),e.createVNode("label",Sd,[e.withDirectives(e.createVNode("input",{type:"radio",value:"customRoute","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.routeType=e})},null,512),[[e.vModelRadio,n.routeType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.customRoute),1)])]),e.createCommentVNode(" 指定路线面板 "),e.withDirectives(e.createVNode("div",Vd,[e.withDirectives(e.createVNode("div",Dd,[e.createVNode("label",Nd,e.toDisplayString(t.Resource.routeType),1),e.withDirectives(e.createVNode("input",{type:"text",class:"sm-input",disabled:"",style:{width:"63%",position:"relative","padding-right":"30px"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.fileSrc=e}),placeholder:"选择飞行线路文件"},null,512),[[e.vModelText,n.fileSrc]]),e.createVNode("span",{class:"iconfont iconwenjianjia fpfFile",onClick:o[4]||(o[4]=function(){return n.chooseFile&&n.chooseFile.apply(n,arguments)})}),e.createVNode("input",Cd,null,512)],512),[[e.vShow,!n.fpfUrl]]),e.withDirectives(e.createVNode("div",Md,[e.createVNode("label",xd,e.toDisplayString(t.Resource.selectStop),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.selectedStopIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.currentStopNames,(function(t,o){return e.openBlock(),e.createBlock("option",{value:o,key:o},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedStopIndex]])],512),[[e.vShow,n.currentStopNames.length>0]]),e.createVNode("div",Rd,[e.createVNode("label",kd,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.showRoute=e})},null,512),[[e.vModelCheckbox,n.showRoute]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.showRoute),1)]),e.createVNode("label",Ld,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[7]||(o[7]=function(e){return n.showStop=e})},null,512),[[e.vModelCheckbox,n.showStop]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.showStop),1)])]),e.createVNode("div",Pd,[e.createVNode("div",null,[e.createVNode("span",{class:"iconfont iconbofang",style:{"font-size":"32px",color:"var(--theme-bg-color)"},onClick:o[8]||(o[8]=function(){return n.flyStart&&n.flyStart.apply(n,arguments)}),title:t.Resource.start},null,8,["title"])]),e.createVNode("div",null,[e.createVNode("span",{class:"iconfont iconzanting",style:{"font-size":"32px",color:"var(--theme-bg-color)"},onClick:o[9]||(o[9]=function(){return n.flyPause&&n.flyPause.apply(n,arguments)}),title:t.Resource.pause},null,8,["title"])]),e.createVNode("div",null,[e.createVNode("span",{class:"iconfont icontingzhi",style:{"font-size":"32px",color:"var(--theme-bg-color)"},onClick:o[10]||(o[10]=function(){return n.flyStop&&n.flyStop.apply(n,arguments)}),title:t.Resource.stop},null,8,["title"])])])],512),[[e.vShow,"designatedRoute"===n.routeType]]),e.createCommentVNode(" 自定义路线面板 "),e.withDirectives(e.createVNode("div",Bd,[e.withDirectives(e.createVNode("div",null,[e.createVNode("div",Td,[e.createVNode("label",Ed,e.toDisplayString(t.Resource.flySpeed),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[11]||(o[11]=function(e){return n.routeSpeed=e})},null,512),[[e.vModelText,n.routeSpeed]])]),e.withDirectives(e.createVNode("div",Ad,[e.createVNode("label",Id,e.toDisplayString(t.Resource.addedStops),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[12]||(o[12]=function(e){return n.selectedAddedStopIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.routeStops,(function(t,o){return e.openBlock(),e.createBlock("option",{value:o,key:o},e.toDisplayString(t.stopName),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedAddedStopIndex]])],512),[[e.vShow,n.routeStops.length>0]]),e.createVNode("div",Fd,[e.createVNode("button",{onClick:o[13]||(o[13]=function(){return n.addStop&&n.addStop.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.add),1),e.createVNode("button",{onClick:o[14]||(o[14]=function(){return n.clearStop&&n.clearStop.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.delete),1),e.createVNode("button",{onClick:o[15]||(o[15]=function(){return n.restStops&&n.restStops.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.reset),1),e.createVNode("button",{onClick:o[16]||(o[16]=function(){return n.saveStop&&n.saveStop.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.save),1)])],512),[[e.vShow,0==n.customRouteNames.length]]),e.createCommentVNode(' 保存飞行路线操作  v-show="customRouteNames.length>0" '),e.withDirectives(e.createVNode("div",Ud,[e.createVNode("div",_d,[Od,e.createTextVNode(" "+e.toDisplayString(t.Resource.customRouteOperating),1)]),e.createVNode("div",Hd,[e.createVNode("label",zd,e.toDisplayString(t.Resource.routeType),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[17]||(o[17]=function(e){return n.customRouteSelectedIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.customRouteNames,(function(t,o){return e.openBlock(),e.createBlock("option",{value:o,key:o},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.customRouteSelectedIndex]])]),e.withDirectives(e.createVNode("div",Gd,[e.createVNode("label",jd,e.toDisplayString(t.Resource.selectStop),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[18]||(o[18]=function(e){return n.selectedStopIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.currentStopNames,(function(t,o){return e.openBlock(),e.createBlock("option",{value:o,key:o},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedStopIndex]])],512),[[e.vShow,n.currentStopNames.length>0]]),e.createVNode("div",Wd,[e.createVNode("label",Kd,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[19]||(o[19]=function(e){return n.showRoute=e})},null,512),[[e.vModelCheckbox,n.showRoute]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.showRoute),1)]),e.createVNode("label",Qd,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[20]||(o[20]=function(e){return n.showStop=e})},null,512),[[e.vModelCheckbox,n.showStop]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.showStop),1)])]),e.createVNode("div",Xd,[e.createVNode("div",null,[e.createVNode("span",{class:"iconfont iconbofang",style:{"font-size":"32px",color:"var(--theme-bg-color)"},onClick:o[21]||(o[21]=function(){return n.flyStart&&n.flyStart.apply(n,arguments)}),title:t.Resource.start},null,8,["title"])]),e.createVNode("div",null,[e.createVNode("span",{class:"iconfont iconzanting",style:{"font-size":"32px",color:"var(--theme-bg-color)"},onClick:o[22]||(o[22]=function(){return n.flyPause&&n.flyPause.apply(n,arguments)}),title:t.Resource.pause},null,8,["title"])]),e.createVNode("div",null,[e.createVNode("span",{class:"iconfont icontingzhi",style:{"font-size":"32px",color:"var(--theme-bg-color)"},onClick:o[23]||(o[23]=function(){return n.flyStop&&n.flyStop.apply(n,arguments)}),title:t.Resource.stop},null,8,["title"])]),e.createVNode("div",Yd,[e.createVNode("button",{onClick:o[24]||(o[24]=function(){return n.downLoad&&n.downLoad.apply(n,arguments)}),class:"tbtn",type:"button"},e.toDisplayString(t.Resource.downLoad),1),e.createVNode("button",{onClick:o[25]||(o[25]=function(){return n.clearRoute&&n.clearRoute.apply(n,arguments)}),class:"tbtn tbtn-margin-left",type:"button"},e.toDisplayString(t.Resource.clear),1)])])],512),[[e.vShow,n.customRouteNames.length>0]])],512),[[e.vShow,"customRoute"===n.routeType]])],512),[[l]])],512)),[[s]])},fd.__file="src/components/fly/fly-route/fly-route.vue",fd.install=function(e){e.component(fd.name,fd)};var Zd={Iron:"铁",Steel:"钢",Aluminum:"铝",Bronze:"铜",Ceramic:"陶瓷",Concrete:"混凝土",Rubber:"橡胶",Glass:"玻璃",Paint:"油漆",Plastic:"塑料",SelfLuminous:"自发光",Wood:"木材",PVC_White:"PVC"};function qd(o){var i,n,r=e.reactive({layerNames:[],selectedLayerName:"none",selectedPbr:"Iron"});if(o)for(var a in o)r.hasOwnProperty(a)?r[a]=o[a]:ae.Message.errorMsg(te.AttributeError+a);function l(){viewer.scene,(i=viewer.scene.layers.layerQueue)&&i.length>0&&(i.forEach((function(e,t){r.layerNames.includes(e._name)||r.layerNames.push(e._name)})),(r.selectedLayerName="none")&&(r.selectedLayerName=r.layerNames[0],n=i[0])),viewer.terrainProvider instanceof SuperMap3D.EllipsoidTerrainProvider||r.layerNames.includes("地形")||(r.layerNames.push("地形"),(r.selectedLayerName="none")&&(r.selectedLayerName=r.layerNames[0]))}return t.isViewer&&l(),e.watch((function(){return t.isViewer}),(function(e){e&&l()})),e.watch((function(){return t.changeLayers}),(function(e){l()})),e.onBeforeUnmount((function(){i=null})),e.watch((function(){return r.selectedLayerName}),(function(e){if("地形"!==e){var t=r.layerNames.indexOf(e);n=-1!=t?i[t]:void 0}})),u(u({},e.toRefs(r)),{},{pbrLibrary:Zd,addPBR:function(){var e="public/data/pbr/jsons/"+r.selectedPbr+".json";"地形"!==r.selectedLayerName?n&&n.setPBRMaterialFromJSON(e):viewer.scene.globe.setPBRMaterialFromJSON(e)},clear:function(){"地形"!==r.selectedLayerName?n&&n.removePBRMaterial():viewer.scene.globe.removePBRMaterial()}})}var Jd={name:"Sm3dAddPbr",props:{selectedLayerName:{type:String}},setup:function(e){var t=qd(e);return{layerNames:t.layerNames,selectedLayerName:t.selectedLayerName,pbrLibrary:t.pbrLibrary,selectedPbr:t.selectedPbr,addPBR:t.addPBR,clear:t.clear}}},$d={id:"pbr-panel",class:"sm-panel"},eu={class:"sm-function-module-sub-section",style:{margin:"0"}},tu={class:"sm-half-L"},ou={style:{width:"35%"}},iu={class:"sm-half-L"},nu={style:{width:"35%"}},ru={class:"boxchild"};Jd.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",$d,[e.withDirectives(e.createVNode("div",eu,[e.createVNode("div",tu,[e.createVNode("label",ou,e.toDisplayString(t.Resource.selectedLayer),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedLayerName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.layerNames,(function(t,o){return e.openBlock(),e.createBlock("option",{key:o,value:t},e.toDisplayString(t),9,["value"])})),128)),e.withDirectives(e.createVNode("option",{value:"none"},e.toDisplayString(t.Resource.noLayer),513),[[e.vShow,0==n.layerNames.length]])],512),[[e.vModelSelect,n.selectedLayerName]])]),e.createVNode("div",iu,[e.createVNode("label",nu,e.toDisplayString(t.Resource.selectedPbr),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.selectedPbr=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.pbrLibrary,(function(t,o,i){return e.openBlock(),e.createBlock("option",{key:i,value:o},e.toDisplayString(t),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedPbr]])]),e.createVNode("div",ru,[e.createVNode("button",{type:"button",class:"tbtn",onClick:o[3]||(o[3]=function(){return n.addPBR&&n.addPBR.apply(n,arguments)})},e.toDisplayString(t.Resource.add),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:o[4]||(o[4]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[l]])],512)),[[s]])},Jd.__file="src/components/layer/pbr-material/pbr-material.vue",Jd.install=function(e){e.component(Jd.name,Jd)};var au={polyline:[{id:"1",iconfont:"iconshixian",lineName:"实线"},{id:"2",iconfont:"iconxuxian",lineName:"虚线"},{id:"3",iconfont:"iconlunkuoxian",lineName:"轮廓线"},{id:"4",iconfont:"iconjiantouxian",lineName:"箭头线"},{id:"5",iconfont:"iconguangyunxian",lineName:"光晕线"},{id:"6",iconfont:"iconweijixian",lineName:"尾迹线"},{},{}],polygon:[{id:"1",iconfont:"iconchunse",faceName:"纯色"},{id:"2",iconfont:"iconwangge",faceName:"网格"},{id:"3",iconfont:"icontiaowen",faceName:"条纹"}]};function lu(o){var i=e.reactive({drawModle:"space",currentId:"1",config:au,lineColor:"rgba(250, 196, 65, 1)",lineWidth:5,dottedColor:"rgba(250, 196, 65, 0)",dottedLength:30,outLineColor:"rgba(29, 206, 200, 1)",outLineWidth:2,glowStrength:.5,trailPercentage:.3,trailPeroid:2,isEdit:!0,isEditZ:!1,drawType:"polyline",solidColor:"rgba(250, 196, 65, 1)",gridColor:"rgba(250, 196, 65, 1)",gridWidth:1,gridCount:8,gridCellAlpha:.1,stripeEvenColor:"#FFFFFF",stripeOddColor:"#000000",stripeRepeat:12,stripeOffset:0,stripeOrientation:"horizontal"});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r=void 0,a=void 0,l=!0,s=(SuperMap3D.ClassificationType.TERRAIN,void 0),c=void 0,d=void 0;function p(){window.handlerPolyline||le("Polyline"),window.tooltip.showAt(" <p>点击鼠标左键开始绘制</p><p>右键单击结束分析</p><p>选中对象进行编辑或清除</p>","50%"),se("Polyline").then((function(e){!function(e){var t,o=SuperMap3D.Color.fromCssColorString(i.lineColor),n=Number(i.lineWidth);switch(i.currentId){case"1":t=o;break;case"2":var l=SuperMap3D.Color.fromCssColorString(i.dottedColor),c=Number(i.dottedLength);t=new SuperMap3D.PolylineDashMaterialProperty({color:o,gapColor:l,dashLength:c});break;case"3":var u=SuperMap3D.Color.fromCssColorString(i.outLineColor),p=Number(i.outLineWidth);t=new SuperMap3D.PolylineOutlineMaterialProperty({color:o,outlineWidth:p,outlineColor:u});break;case"4":t=new SuperMap3D.PolylineArrowMaterialProperty(o);break;case"5":var m=Number(i.glowStrength);t=new SuperMap3D.PolylineGlowMaterialProperty({glowPower:m,color:o});break;case"6":var h=Number(i.trailPercentage);t=new SuperMap3D.PolylineTrailMaterialProperty({color:o,trailLength:h,period:i.trailPeroid});break;default:t=o}s=viewer.entities.add({id:"polyline-symbol-line-"+(new Date).getTime(),polyline:{positions:e,width:n,material:t,clampToGround:r,classificationType:a,height:d}})}(e.result.object.positions);var t=window.handlerPolyline;t.polyline.show=!1,window.polylineTransparent.show=!1,t.deactivate(),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()}function m(e){var t=viewer.scene.pick(e.message.position);t&&t.id&&t.id.id&&"string"==typeof t.id.id&&(-1!=t.id.id.indexOf("polyline-symbol-line")&&(s=t.id),-1!=t.id.id.indexOf("polygon-symbol-gon")&&(c=t.id))}function h(e,t,o){r=e,a=t,d=o,s&&(s.polyline.clampToGround=r,s.polyline.classificationType=a,s.polyline.height=o)}function y(e,t,o){l=e,a=t,d=o,c&&(c.polygon.perPositionHeight=l,c.classificationType=a,c.polygon.height=o)}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),viewer.eventManager.addEventListener("CLICK",m,!1),he()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),viewer.eventManager.addEventListener("CLICK",m,!1),he())})),e.onBeforeUnmount((function(){viewer&&viewer.eventManager.removeEventListener("CLICK",m)})),e.watch((function(){return i.drawModle}),(function(e){var t="polyline"===i.drawType;switch(e){case"space":t?h(void 0,void 0,void 0):y(!0,void 0,void 0);break;case"stick":t?h(!0,SuperMap3D.ClassificationType.TERRAIN,0):y(!1,SuperMap3D.ClassificationType.TERRAIN,0);break;case"postObject":t?h(!0,SuperMap3D.ClassificationType.S3M_TILE,void 0):y(!1,SuperMap3D.ClassificationType.S3M_TILE,void 0);break;default:h(void 0,void 0,void 0),y(!0,!1,void 0)}})),e.watch((function(){return i.lineColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);s&&(s.polyline.material.color=t)})),e.watch((function(){return i.lineWidth}),(function(e){s&&(s.polyline.width=Number(e))})),e.watch((function(){return i.dottedColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);s&&(s.polyline.material.gapColor=t)})),e.watch((function(){return i.dottedLength}),(function(e){s&&(s.polyline.material.dashLength=Number(e))})),e.watch((function(){return i.outLineColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);s&&(s.polyline.material.outlineColor=t)})),e.watch((function(){return i.outLineWidth}),(function(e){s&&(s.polyline.material.outlineWidth=Number(e))})),e.watch((function(){return i.glowStrength}),(function(e){s&&(s.polyline.material.glowPower=Number(e))})),e.watch((function(){return i.trailPercentage}),(function(e){s&&(s.polyline.material.trailLength=Number(e))})),e.watch((function(){return i.isEdit}),(function(e){s&&(e?he():ye())})),e.watch((function(){return i.isEditZ}),(function(e){s&&window.editHandler&&(window.editHandler.isEditZ=e)})),e.watch((function(){return i.drawType}),(function(e){i.currentId="1"})),e.watch((function(){return i.solidColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);c&&(c.polygon.material=t)})),e.watch((function(){return i.gridColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);c&&(c.polygon.material.color=t)})),e.watch((function(){return i.gridWidth}),(function(e){c&&(c.polygon.material.lineThickness=new SuperMap3D.Cartesian2(Number(e),Number(e)))})),e.watch((function(){return i.gridCount}),(function(e){c&&(c.polygon.material.lineCount=new SuperMap3D.Cartesian2(Number(e),Number(e)))})),e.watch((function(){return i.gridCellAlpha}),(function(e){c&&(c.polygon.material.cellAlpha=Number(e))})),e.watch((function(){return i.stripeEvenColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);c&&(c.polygon.material.evenColor=t)})),e.watch((function(){return i.stripeOddColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);c&&(c.polygon.material.oddColor=t)})),e.watch((function(){return i.stripeRepeat}),(function(e){c&&(c.polygon.material.repeat=Number(e))})),e.watch((function(){return i.stripeOffset}),(function(e){c&&(c.polygon.material.offset=Number(e))})),e.watch((function(){return i.stripeOrientation}),(function(e){if(c){var t="horizontal"===e?0:1;c.polygon.material.orientation=t}})),u(u({},e.toRefs(i)),{},{draw:function(){"polyline"===i.drawType?p():function(){window.handlerPolygon||le("Polygon");se("Polygon",!1).then((function(e){var t=window.handlerPolygon;!function(e){var t;switch(console.log(e),i.currentId){case"1":t=SuperMap3D.Color.fromCssColorString(i.solidColor);break;case"2":var o=SuperMap3D.Color.fromCssColorString(i.gridColor),n=Number(i.gridWidth),r=Number(i.gridCount),s=Number(i.gridCellAlpha);t=new SuperMap3D.GridMaterialProperty({color:o,cellAlpha:s,lineCount:new SuperMap3D.Cartesian2(r,r),lineThickness:new SuperMap3D.Cartesian2(n,n)});break;case"3":var u=SuperMap3D.Color.fromCssColorString(i.stripeEvenColor),p=SuperMap3D.Color.fromCssColorString(i.stripeOddColor),m=Number(i.stripeRepeat),h=Number(i.stripeOffset);t=new SuperMap3D.StripeMaterialProperty({evenColor:u,oddColor:p,repeat:m,offset:h,orientation:"horizontal"===i.stripeOrientation?0:1})}c=viewer.entities.add({id:"polygon-symbol-gon-"+(new Date).getTime(),polygon:{hierarchy:{positions:e},material:t,perPositionHeight:l,groundBottomAltitude:0,groundExtrudedHeight:100},classificationType:a,height:d})}(e.result.object.positions),t.polygon.show=!1,t.polyline.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate()}()},changeSelect:function(e){i.currentId=e},clear:function(){s&&"polyline"===i.drawType&&viewer.entities.removeById(s.id),c&&"polygon"===i.drawType&&viewer.entities.removeById(c.id),window.tooltip.setVisible(!1),ce("Polyline"),ce("Polygon"),window.editHandler&&window.editHandler.clear(),i.isEdit=!1,i.isEditZ=!1}})}var su={name:"Sm3dDrawLinePolygon",props:{},setup:function(e){var t=lu(e);return{drawModle:t.drawModle,currentId:t.currentId,lineColor:t.lineColor,lineWidth:t.lineWidth,config:t.config,draw:t.draw,changeSelect:t.changeSelect,clear:t.clear,isEdit:t.isEdit,isEditZ:t.isEditZ,dottedColor:t.dottedColor,dottedLength:t.dottedLength,outLineColor:t.outLineColor,outLineWidth:t.outLineWidth,glowStrength:t.glowStrength,trailPercentage:t.trailPercentage,drawType:t.drawType,solidColor:t.solidColor,gridColor:t.gridColor,gridWidth:t.gridWidth,gridCount:t.gridCount,gridCellAlpha:t.gridCellAlpha,stripeEvenColor:t.stripeEvenColor,stripeOddColor:t.stripeOddColor,stripeRepeat:t.stripeRepeat,stripeOffset:t.stripeOffset,stripeOrientation:t.stripeOrientation}}},cu={id:"draw-panel",class:"sm-panel"},du={class:"sm-function-module-sub-section",style:{margin:"0"}},uu={class:"sm-half-L"},pu={style:{width:"auto"}},mu={style:{width:"auto"}},hu={class:"sm-half-L"},yu={style:{width:"35%"}},fu={value:"space"},vu={value:"stick"},wu={value:"postObject"},gu={class:"sm-half-L"},bu={style:{width:"auto"}},Su={style:{width:"auto"}},Vu={style:{width:"100%"}},Du={class:"sm-half-L symbolic"},Nu={style:{width:"100%"}},Cu={class:"sm-half-L"},Mu={style:{width:"35%"}},xu={class:"sm-half-L"},Ru={style:{width:"35%"}},ku={class:"sm-half-L"},Lu={style:{width:"35%"}},Pu={class:"sm-half-L"},Bu={style:{width:"35%"}},Tu={class:"sm-half-L"},Eu={style:{width:"35%"}},Au={class:"sm-half-L"},Iu={style:{width:"35%"}},Fu={class:"sm-half-L"},Uu={style:{width:"35%"}},_u={class:"sm-half-L"},Ou={style:{width:"35%"}},Hu={style:{width:"100%"}},zu={class:"sm-half-L symbolic"},Gu={style:{width:"100%"}},ju={class:"sm-half-L"},Wu={style:{width:"35%"}},Ku={class:"sm-half-L"},Qu={style:{width:"35%"}},Xu={class:"sm-half-L"},Yu={style:{width:"35%"}},Zu={class:"sm-half-L"},qu={style:{width:"35%"}},Ju={class:"sm-half-L"},$u={style:{width:"35%"}},ep={class:"sm-half-L"},tp={style:{width:"35%"}},op={class:"sm-half-L"},ip={style:{width:"35%"}},np={class:"sm-half-L"},rp={style:{width:"35%"}},ap={class:"sm-half-L"},lp={style:{width:"35%"}},sp={class:"sm-half-L"},cp={style:{width:"auto"}},dp={style:{width:"auto"}},up={class:"boxchild"};su.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-color-picker"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",cu,[e.withDirectives(e.createVNode("div",du,[e.createVNode("div",uu,[e.createVNode("label",pu,[e.withDirectives(e.createVNode("input",{type:"radio",value:"polyline","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.drawType=e})},null,512),[[e.vModelRadio,n.drawType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.polyline),1)]),e.createVNode("label",mu,[e.withDirectives(e.createVNode("input",{type:"radio",value:"polygon","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.drawType=e})},null,512),[[e.vModelRadio,n.drawType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.polygon),1)])]),e.createVNode("div",hu,[e.createVNode("label",yu,e.toDisplayString(t.Resource.drawModle),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.drawModle=e})},[e.createVNode("option",fu,e.toDisplayString(t.Resource.space),1),e.createVNode("option",vu,e.toDisplayString(t.Resource.stick),1),e.createVNode("option",wu,e.toDisplayString(t.Resource.postObject),1)],512),[[e.vModelSelect,n.drawModle]])]),e.createVNode("div",gu,[e.createVNode("label",bu,[e.withDirectives(e.createVNode("input",{type:"checkbox",style:{"margin-right":"14px"},"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.isEdit=e})},null,512),[[e.vModelCheckbox,n.isEdit]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.isEdit),1)]),e.createVNode("label",Su,[e.withDirectives(e.createVNode("input",{type:"checkbox",style:{"margin-right":"14px"},"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.isEditZ=e})},null,512),[[e.vModelCheckbox,n.isEditZ]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.isEditZ),1)])]),e.createCommentVNode(" 线 "),e.withDirectives(e.createVNode("div",Vu,[e.createVNode("div",Du,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.config.polyline,(function(t){return e.openBlock(),e.createBlock("div",{key:t.id,class:["symbolic-box",{"theme-color":t.id===n.currentId}],onClick:function(e){return n.changeSelect(t.id)}},[e.createVNode("span",{class:["iconfont",t.iconfont]},null,2),e.createVNode("label",Nu,e.toDisplayString(t.lineName),1)],10,["onClick"])})),128))]),e.createVNode("div",Cu,[e.createVNode("label",Mu,e.toDisplayString(t.Resource.lineColor),1),e.createVNode(l,{modelValue:n.lineColor,"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.lineColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",xu,[e.createVNode("label",Ru,e.toDisplayString(t.Resource.lineWidth),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.lineWidth=e})},null,512),[[e.vModelText,n.lineWidth]])]),e.createCommentVNode(" 虚线 "),e.withDirectives(e.createVNode("div",ku,[e.createVNode("label",Lu,e.toDisplayString(t.Resource.dottedColor),1),e.createVNode(l,{modelValue:n.dottedColor,"onUpdate:modelValue":o[8]||(o[8]=function(e){return n.dottedColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,"2"===n.currentId]]),e.withDirectives(e.createVNode("div",Pu,[e.createVNode("label",Bu,e.toDisplayString(t.Resource.dottedLength),1),e.withDirectives(e.createVNode("input",{type:"number",min:"0",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[9]||(o[9]=function(e){return n.dottedLength=e})},null,512),[[e.vModelText,n.dottedLength]])],512),[[e.vShow,"2"===n.currentId]]),e.createCommentVNode(" 轮廓线 "),e.withDirectives(e.createVNode("div",Tu,[e.createVNode("label",Eu,e.toDisplayString(t.Resource.outLineColor),1),e.createVNode(l,{modelValue:n.outLineColor,"onUpdate:modelValue":o[10]||(o[10]=function(e){return n.outLineColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,"3"===n.currentId]]),e.withDirectives(e.createVNode("div",Au,[e.createVNode("label",Iu,e.toDisplayString(t.Resource.outLineWidth),1),e.withDirectives(e.createVNode("input",{type:"number",min:"0",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[11]||(o[11]=function(e){return n.outLineWidth=e})},null,512),[[e.vModelText,n.outLineWidth]])],512),[[e.vShow,"3"===n.currentId]]),e.createCommentVNode(" 光晕线 "),e.withDirectives(e.createVNode("div",Fu,[e.createVNode("label",Uu,e.toDisplayString(t.Resource.glowStrength),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",min:"0",step:"0.1",style:{width:"63%"},"onUpdate:modelValue":o[12]||(o[12]=function(e){return n.glowStrength=e})},null,512),[[e.vModelText,n.glowStrength]])],512),[[e.vShow,"5"===n.currentId]]),e.createCommentVNode(" 尾迹线 "),e.withDirectives(e.createVNode("div",_u,[e.createVNode("label",Ou,e.toDisplayString(t.Resource.trailPercentage),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",min:"0",step:"0.1",style:{width:"63%"},"onUpdate:modelValue":o[13]||(o[13]=function(e){return n.trailPercentage=e})},null,512),[[e.vModelText,n.trailPercentage]])],512),[[e.vShow,"6"===n.currentId]])],512),[[e.vShow,"polyline"===n.drawType]]),e.createCommentVNode(" 面 "),e.withDirectives(e.createVNode("div",Hu,[e.createVNode("div",zu,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.config.polygon,(function(t){return e.openBlock(),e.createBlock("div",{key:t.id,class:["symbolic-box",{"theme-color":t.id===n.currentId}],onClick:function(e){return n.changeSelect(t.id)}},[e.createVNode("span",{class:["iconfont",t.iconfont]},null,2),e.createVNode("label",Gu,e.toDisplayString(t.faceName),1)],10,["onClick"])})),128))]),e.createCommentVNode(" 纯色 "),e.withDirectives(e.createVNode("div",ju,[e.createVNode("label",Wu,e.toDisplayString(t.Resource.polygonColor),1),e.createVNode(l,{modelValue:n.solidColor,"onUpdate:modelValue":o[14]||(o[14]=function(e){return n.solidColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,"1"===n.currentId]]),e.createCommentVNode(" 网格 "),e.withDirectives(e.createVNode("div",Ku,[e.createVNode("label",Qu,e.toDisplayString(t.Resource.polygonColor),1),e.createVNode(l,{modelValue:n.gridColor,"onUpdate:modelValue":o[15]||(o[15]=function(e){return n.gridColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,"2"===n.currentId]]),e.withDirectives(e.createVNode("div",Xu,[e.createVNode("label",Yu,e.toDisplayString(t.Resource.gridWidth),1),e.withDirectives(e.createVNode("input",{type:"number",min:"0",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[16]||(o[16]=function(e){return n.gridWidth=e})},null,512),[[e.vModelText,n.gridWidth]])],512),[[e.vShow,"2"===n.currentId]]),e.withDirectives(e.createVNode("div",Zu,[e.createVNode("label",qu,e.toDisplayString(t.Resource.gridCount),1),e.withDirectives(e.createVNode("input",{type:"number",min:"0",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[17]||(o[17]=function(e){return n.gridCount=e})},null,512),[[e.vModelText,n.gridCount]])],512),[[e.vShow,"2"===n.currentId]]),e.withDirectives(e.createVNode("div",Ju,[e.createVNode("label",$u,e.toDisplayString(t.Resource.gridCellAlpha),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",min:"0",step:"0.1",style:{width:"63%"},"onUpdate:modelValue":o[18]||(o[18]=function(e){return n.gridCellAlpha=e})},null,512),[[e.vModelText,n.gridCellAlpha]])],512),[[e.vShow,"2"===n.currentId]]),e.createCommentVNode(" 条纹 "),e.withDirectives(e.createVNode("div",ep,[e.createVNode("label",tp,e.toDisplayString(t.Resource.stripeEvenColor),1),e.createVNode(l,{modelValue:n.stripeEvenColor,"onUpdate:modelValue":o[19]||(o[19]=function(e){return n.stripeEvenColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,"3"===n.currentId]]),e.withDirectives(e.createVNode("div",op,[e.createVNode("label",ip,e.toDisplayString(t.Resource.stripeOddColor),1),e.createVNode(l,{modelValue:n.stripeOddColor,"onUpdate:modelValue":o[20]||(o[20]=function(e){return n.stripeOddColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,"3"===n.currentId]]),e.withDirectives(e.createVNode("div",np,[e.createVNode("label",rp,e.toDisplayString(t.Resource.stripeRepeat),1),e.withDirectives(e.createVNode("input",{type:"number",min:"0",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[21]||(o[21]=function(e){return n.stripeRepeat=e})},null,512),[[e.vModelText,n.stripeRepeat]])],512),[[e.vShow,"3"===n.currentId]]),e.withDirectives(e.createVNode("div",ap,[e.createVNode("label",lp,e.toDisplayString(t.Resource.stripeOffset),1),e.withDirectives(e.createVNode("input",{type:"number",min:"0",class:"sm-input",style:{width:"63%"},"onUpdate:modelValue":o[22]||(o[22]=function(e){return n.stripeOffset=e})},null,512),[[e.vModelText,n.stripeOffset]])],512),[[e.vShow,"3"===n.currentId]]),e.withDirectives(e.createVNode("div",sp,[e.createVNode("label",cp,[e.withDirectives(e.createVNode("input",{type:"radio",value:"horizontal","onUpdate:modelValue":o[23]||(o[23]=function(e){return n.stripeOrientation=e})},null,512),[[e.vModelRadio,n.stripeOrientation]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.stripeOrientation),1)]),e.createVNode("label",dp,[e.withDirectives(e.createVNode("input",{type:"radio",value:"vertical","onUpdate:modelValue":o[24]||(o[24]=function(e){return n.stripeOrientation=e})},null,512),[[e.vModelRadio,n.stripeOrientation]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.stripeOrientation),1)])],512),[[e.vShow,"3"===n.currentId]])],512),[[e.vShow,"polygon"===n.drawType]]),e.createVNode("div",up,[e.createVNode("button",{class:"tbtn",type:"button",style:{width:"auto"},onClick:o[25]||(o[25]=function(){return n.draw&&n.draw.apply(n,arguments)})},e.toDisplayString(t.Resource.draw),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",style:{width:"auto"},type:"button ",onClick:o[26]||(o[26]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},su.__file="src/components/draw/draw-line-surface/draw-line-surface.vue",su.install=function(e){e.component(su.name,su)};var pp=[{id:0,name:"树木",type:"tree",data:[{id:0,name:"树1",thumbnail:"public/data/s3m/S3MData/tree.png",path:"public/data/s3m/S3MData/tree1.s3m"},{id:1,name:"树2",thumbnail:"public/data/s3m/S3MData/pine.png",path:"public/data/s3m/S3MData/tree2.s3m"},{id:2,name:"树3",thumbnail:"public/data/s3m/S3MData/tree3.png",path:"public/data/s3m/S3MData/tree3.s3m"},{id:3,name:"树4",thumbnail:"public/data/s3m/S3MData/tree2.png",path:"public/data/s3m/S3MData/tree4.s3m"},{id:4,name:"springTree",thumbnail:"public/data/s3m/S3MData/springTree.png",path:"public/data/s3m/S3MData/springTree.s3m"},{id:5,name:"autumnTree",thumbnail:"public/data/s3m/S3MData/autumnTree.png",path:"public/data/s3m/S3MData/autumnTree.s3m"},{id:6,name:"winterTree",thumbnail:"public/data/s3m/S3MData/winterTree.png",path:"public/data/s3m/S3MData/winterTree.s3m"},{},{},{}]},{id:1,name:"公共设施",type:"public-utilities",data:[{id:0,name:"椅子",thumbnail:"public/data/s3m/S3MData/bench.png",path:"public/data/s3m/S3MData/Chair.s3m"},{id:1,name:"垃圾箱",thumbnail:"public/data/s3m/S3MData/Dustbin.png",path:"public/data/s3m/S3MData/Dustbin.s3m"},{id:2,name:"垃圾箱2",thumbnail:"public/data/s3m/S3MData/paper-bucket.png",path:"public/data/s3m/S3MData/Dustbin2.s3m"},{id:3,name:"垃圾桶",thumbnail:"public/data/s3m/S3MData/dustbin1.png",path:"public/data/s3m/S3MData/GarbageCan.s3m"},{id:4,name:"报亭",thumbnail:"public/data/s3m/S3MData/newspaper.png",path:"public/data/s3m/S3MData/NewsStand.s3m"},{id:5,name:"邮政信箱",thumbnail:"public/data/s3m/S3MData/mailbox.png",path:"public/data/s3m/S3MData/PO-Box.s3m"},{id:6,name:"电信电话亭",thumbnail:"public/data/s3m/S3MData/phone-booth.png",path:"public/data/s3m/S3MData/T-TelBooth.s3m"},{},{},{}]},{id:2,name:"交通",type:"traffic",data:[{id:0,name:"限速牌",thumbnail:"public/data/s3m/S3MData/speed-limit.png",path:"public/data/s3m/S3MData/RestrictionBoard.s3m"},{id:1,name:"路灯",thumbnail:"public/data/s3m/S3MData/lamp-post.png",path:"public/data/s3m/S3MData/StreetLight.s3m"},{id:2,name:"红绿灯",thumbnail:"public/data/s3m/S3MData/traffic-light.png",path:"public/data/s3m/S3MData/TrafficLight.s3m"},{},{}]}],mp=function(){function e(){a(this,e),this._positions=null,this.boundingSphere=null,this._geometry=null,this._triangleArrayByWeight=null}return s(e,[{key:"initPolygonEmitter",value:function(e){if(this._positions=SuperMap3D.defaultValue(e,[new SuperMap3D.Cartesian3,new SuperMap3D.Cartesian3,new SuperMap3D.Cartesian3]),this.boundingSphere=SuperMap3D.BoundingSphere.fromPoints(e),SuperMap3D.defaultValue(e)){var t=SuperMap3D.PolygonGeometry.fromPositions({positions:e,perPositionHeight:!0});this._geometry=SuperMap3D.PolygonGeometry.createGeometry(t),this._triangleArrayByWeight=this.initWeight(this._geometry)}}},{key:"initWeight",value:function(e){var t,o,i=new SuperMap3D.Cartesian3,n=new SuperMap3D.Cartesian3,r=new SuperMap3D.Cartesian3,a=e.indices,l=a.length/3,s=e.attributes.position.values,c=[],d=0;for(t=0;t<l;t++){var u=a[3*t],p=a[3*t+1],m=a[3*t+2];i.x=s[3*u],i.y=s[3*u+1],i.z=s[3*u+2],n.x=s[3*p],n.y=s[3*p+1],n.z=s[3*p+2],r.x=s[3*m],r.y=s[3*m+1],r.z=s[3*m+2];var h=this.triangleArea(i,n,r);d+=h,c.push(h)}var y=Math.max(100,10*l),f=[];for(t=0;t<l;t++){var v=Math.floor(c[t]/d*y);for(v=Math.max(1,v),o=0;o<v;o++)f.push(t)}return f}},{key:"triangleArea",value:function(e,t,o){var i=new SuperMap3D.Cartesian3,n=new SuperMap3D.Cartesian3,r=new SuperMap3D.Cartesian3;return i=SuperMap3D.Cartesian3.subtract(t,e,i),n=SuperMap3D.Cartesian3.subtract(o,e,n),r=SuperMap3D.Cartesian3.cross(i,n,r),.5*SuperMap3D.Cartesian3.magnitude(r)}},{key:"randomVertex",value:function(e,t,o,i,n){return(1-Math.sqrt(e))*o+Math.sqrt(e)*(1-t)*i+Math.sqrt(e)*t*n}},{key:"getOneRandomPosition",value:function(){if(SuperMap3D.defaultValue(this._geometry)){var e=Math.floor(SuperMap3D.Math.randomBetween(0,this._triangleArrayByWeight.length)),t=this._triangleArrayByWeight[e],o=this._geometry.indices[3*t],i=this._geometry.indices[3*t+1],n=this._geometry.indices[3*t+2],r=this._geometry.attributes.position.values,a=r[3*o],l=r[3*o+1],s=r[3*o+2],c=r[3*i],d=r[3*i+1],u=r[3*i+2],p=r[3*n],m=r[3*n+1],h=r[3*n+2],y=SuperMap3D.Math.randomBetween(0,1),f=SuperMap3D.Math.randomBetween(0,1),v=this.randomVertex(y,f,a,c,p),w=this.randomVertex(y,f,l,d,m),g=this.randomVertex(y,f,s,u,h);return SuperMap3D.Cartesian3.fromElements(v,w,g)}}},{key:"positions",get:function(){return this._positions},set:function(e){if(SuperMap3D.defaultValue(e)){this._positions=e;var t=SuperMap3D.PolygonGeometry.fromPositions({positions:this._positions,perPositionHeight:!0});this._geometry=SuperMap3D.PolygonGeometry.createGeometry(t),this._triangleArrayByWeight=this.initWeight(this._geometry),this.boundingSphere=SuperMap3D.BoundingSphere.fromPoints(e)}}}]),e}();function hp(o){var i=e.reactive({selectedTypeId:0,selectedSymbolId:0,symbolColor:"#ffffff",space:10,density:100,addType:"single"});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r,a,l,s=pp[i.selectedTypeId].data,c=null,d=!1,p=[],m=!1,h=!0;function y(e){if(!d){if(m){tooltip.setVisible(!1),viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur");var t=scene.pickPosition(e.message.position),o=SuperMap3D.Color.fromCssColorString(i.symbolColor),n="symbol-"+pp[i.selectedTypeId].id+"-"+s[i.selectedSymbolId].id+"-"+(new Date).getTime(),l=s[i.selectedSymbolId].path;return r.add(l,{id:n,position:t,color:o}),p.includes(l)||p.push(l),void(m=!1)}var u=viewer.scene.pick(e.message.position)||viewer.selectedEntity;if(u&&u.id&&"string"==typeof u.id&&-1!=u.id.indexOf("symbol-")){if(c&&c.id===u.id)return;return a&&a.destroy(),c=u,void(a=new SuperMap3D.ModelEditor({model:c.primitive,scene:viewer.scene})).activate()}a&&a.destroy(),a=null,c=null}}function f(){viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),m=!0}function v(){d=!0,window.handlerPolyline||le("Polyline"),se("Polyline").then((function(e){!function(e,t){for(var o=[],n=1,a=t.positions.length;n<a;n++)for(var l=t.positions[n-1],c=t.positions[n],u=SuperMap3D.Cartesian3.distance(l,c),m=w(parseInt(u)),h=1,y=m;h<=y;h++)o.push(SuperMap3D.Cartesian3.lerp(l,c,h/m,new SuperMap3D.Cartesian3));viewer.scene.clampToHeightMostDetailed(o).then((function(e){d=!1;var t=SuperMap3D.Color.fromCssColorString(i.symbolColor),o="symbol-"+pp[i.selectedTypeId].id+"-"+s[i.selectedSymbolId].id+"-",n=s[i.selectedSymbolId].path;p.includes(n)||p.push(n);for(var a=0,l=e.length;a<=l;a++)r.add(n,{id:o+(new Date).getTime()+a,position:e[a],color:t})}))}(0,e.result.object);var t=window.handlerPolyline;t.polyline.show=!1,window.polylineTransparent.show=!1,t.deactivate(),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()}function w(e){var t=Number(i.space);return parseInt(e/t)+1}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),r=new SuperMap3D.S3MInstanceCollection(scene._context),viewer.scene.primitives.add(r),l=new mp),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),r=new SuperMap3D.S3MInstanceCollection(scene._context),viewer.scene.primitives.add(r),l=new mp)})),e.onBeforeUnmount((function(){s.length=0,r=null,c=null,a&&a.destroy(),p.length=0})),e.watch((function(){return i.selectedTypeId}),(function(e){s=pp[i.selectedTypeId].data})),e.watch((function(){return i.symbolColor}),(function(e){var t=SuperMap3D.Color.fromCssColorString(e);if(c){var o=c.primitive,i=c.id;o.updateColor(t,i)}})),u(u({},e.toRefs(i)),{},{s3mModels:pp,changeSelect:function(e){i.selectedSymbolId=e},clear:function(){if(c){var e=c.id,t=e.split("-"),o=pp[t[1]].data[t[2]].path;o&&(r.removeInstance(o,e),c=null)}else p.forEach((function(e){r.removeCollection(e)})),p.length=0;0===p.length&&viewer.eventManager.removeEventListener("CLICK",y),a&&a.destroy(),a=null,window.tooltip.setVisible(!1),ce("Polyline"),ce("Polygon"),m=!1,viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur")},statrtAdd:function(){switch(h&&(window.tooltip.showAt("<p>选中模型可以编辑和清除选中模型</p><p>未选中模型时清除所有</p>","420px"),h=!1),viewer.eventManager.addEventListener("CLICK",y,!0),i.addType){case"single":f();break;case"line":v();break;case"face":d=!0,window.handlerPolygon||le("Polygon"),se("Polygon",!1).then((function(e){tooltip.setVisible(!1);var t=window.handlerPolygon;t.polygon.show=!1,t.polyline.show=!1,t.deactivate(),l.initPolygonEmitter(e.result.object.positions);var o=SuperMap3D.Color.fromCssColorString(i.symbolColor),n="symbol-"+pp[i.selectedTypeId].id+"-"+s[i.selectedSymbolId].id+"-",a=s[i.selectedSymbolId].path;p.includes(a)||p.push(a);for(var c=Number(i.density),u=0;u<c;u++){var m=l.getOneRandomPosition();r.add(a,{id:n+(new Date).getTime()+u,position:m,color:o})}d=!1}),(function(e){console.log(e)})),window.handlerPolygon.activate();break;default:f()}}})}var yp={name:"Sm3dPointSymbol",props:{selectedTypeId:{type:Number},symbolColor:{type:String},space:{type:Number},density:{type:Number}},setup:function(e){var t=hp(e);return{s3mModels:t.s3mModels,selectedTypeId:t.selectedTypeId,selectedSymbolId:t.selectedSymbolId,symbolColor:t.symbolColor,changeSelect:t.changeSelect,space:t.space,density:t.density,clear:t.clear,statrtAdd:t.statrtAdd,addType:t.addType}}},fp={id:"draw-panel",class:"sm-panel"},vp={class:"sm-function-module-sub-section",style:{margin:"0"}},wp={class:"sm-half-L"},gp={style:{width:"35%"}},bp={class:"sm-half-L symbolic"},Sp={class:"sm-half-L"},Vp={style:{width:"35%"}},Dp={class:"sm-half-L"},Np={style:{width:"35%"}},Cp={value:"single"},Mp={value:"line"},xp={value:"face"},Rp={class:"sm-half-L"},kp={style:{width:"35%"}},Lp={class:"sm-half-L"},Pp={style:{width:"35%"}},Bp={class:"boxchild"};yp.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-color-picker"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",fp,[e.withDirectives(e.createVNode("div",vp,[e.createVNode("div",wp,[e.createVNode("label",gp,e.toDisplayString(t.Resource.symbolType),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.selectedTypeId=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.s3mModels,(function(t){return e.openBlock(),e.createBlock("option",{key:t.id,value:t.id},e.toDisplayString(t.name),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedTypeId]])]),e.createVNode("div",bp,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.s3mModels[n.selectedTypeId].data,(function(t,o){return e.openBlock(),e.createBlock("div",{key:t.id,class:["symbolic-box",{"theme-border-color":t.id===n.selectedSymbolId}],style:{width:"40px"},title:t.name,onClick:function(e){return n.changeSelect(o)}},[e.withDirectives(e.createVNode("img",{src:t.thumbnail,alt:""},null,8,["src"]),[[e.vShow,t.name]])],10,["title","onClick"])})),128))]),e.createVNode("div",Sp,[e.createVNode("label",Vp,e.toDisplayString(t.Resource.symbolColor),1),e.createVNode(l,{modelValue:n.symbolColor,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.symbolColor=e}),size:"mini",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Dp,[e.createVNode("label",Np,e.toDisplayString(t.Resource.addType),1),e.withDirectives(e.createVNode("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.addType=e})},[e.createVNode("option",Cp,e.toDisplayString(t.Resource.singleAdd),1),e.createVNode("option",Mp,e.toDisplayString(t.Resource.lineAdd),1),e.createVNode("option",xp,e.toDisplayString(t.Resource.faceAdd),1)],512),[[e.vModelSelect,n.addType]])]),e.withDirectives(e.createVNode("div",Rp,[e.createVNode("label",kp,e.toDisplayString(t.Resource.spacing),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},min:"1","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.space=e})},null,512),[[e.vModelText,n.space]])],512),[[e.vShow,"line"===n.addType]]),e.withDirectives(e.createVNode("div",Lp,[e.createVNode("label",Pp,e.toDisplayString(t.Resource.number),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"63%"},min:"1","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.density=e})},null,512),[[e.vModelText,n.density]])],512),[[e.vShow,"face"===n.addType]]),e.createVNode("div",Bp,[e.createVNode("button",{class:"tbtn",type:"button ",onClick:o[6]||(o[6]=function(){return n.statrtAdd&&n.statrtAdd.apply(n,arguments)})},e.toDisplayString(t.Resource.add),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[7]||(o[7]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[s]])],512)),[[c]])},yp.__file="src/components/draw/add-point-symbol/add-point-symbol.vue",yp.install=function(e){e.component(yp.name,yp)};var Tp=[{id:0,iconfont:"icondianguangyuan",lightName:"点光源"},{id:1,iconfont:"iconjuguangdeng",lightName:"聚光灯"},{id:2,iconfont:"iconpinghangguang",lightName:"平行光"}];function Ep(o){var i,n,r,a=e.reactive({lightSelectId:0,lightColor:"#FFFFFF",cutoffDistance:200,lightDecay:5,lightIntensity:5,spotLightAngle:30,visibleModel:!0,dockFontShow:!0,modelPosition:[0,0,0],modelLongitude:"",modelLatitude:"",modelHeight:"",bubbleShow:!1,visiblePositions:!1});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);var s,c=!1,d=new Map,p="public/data/s3m/light.s3m",m=e.ref(null);function h(e,t){var o="light-model-"+(new Date).getTime();r.add(p,{id:o,position:e,scale:new SuperMap3D.Cartesian3(2,2,2)}),i=r.getInstance(p,o),d.set(o,t)}t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),r=new SuperMap3D.S3MInstanceCollection(scene._context),viewer.scene.primitives.add(r)),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),r=new SuperMap3D.S3MInstanceCollection(scene._context),viewer.scene.primitives.add(r))}));var y,f=!1;function v(){window.handlerPolyline||le("Polyline"),se("Polyline").then((function(e){var t,o,i,r,l;1===a.lightSelectId?(t=e.result.object.positions,o=g(t[0]),i=t[1],r={color:SuperMap3D.Color.fromCssColorString(a.lightColor),distance:Number(a.cutoffDistance),decay:Number(a.lightDecay),intensity:Number(a.lightIntensity),angle:SuperMap3D.Math.toRadians(Number(a.spotLightAngle))},l=new SuperMap3D.SpotLight(o,i,r),n=l,viewer.scene.addLightSource(l),h(o,l)):function(e){var t=g(e[0]),o={targetPosition:e[1],color:SuperMap3D.Color.fromCssColorString(a.lightColor),intensity:Number(a.lightIntensity)},i=new SuperMap3D.DirectionalLight(t,o);n=i,viewer.scene.addLightSource(i),h(t,i)}(e.result.object.positions);var s=window.handlerPolyline;s.polyline.show=!1,window.polylineTransparent.show=!1,s.deactivate(),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()}function w(e){if(c){c=!1,viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur"),!function(e){var t=g(e),o={color:SuperMap3D.Color.fromCssColorString(a.lightColor),cutoffDistance:Number(a.cutoffDistance),decay:Number(a.lightDecay),intensity:Number(a.lightIntensity)},i=new SuperMap3D.PointLight(t,o);n=i,viewer.scene.addLightSource(i),h(t,i)}(scene.pickPosition(e.message.position)),tooltip.setVisible(!1)}else{var t=viewer.scene.pick(e.message.position)||viewer.selectedEntity;if(t&&t.id&&"string"==typeof t.id&&-1!=t.id.indexOf("light-model-")){var o;if(i&&i.id===t.id.id)return;i=t,n=d.get(t.id),s?s.setEditObject(t.primitive):(l=t.primitive,(s=new SuperMap3D.ModelEditor({model:l,scene:viewer.scene,axesShow:{translation:!0,rotation:!1,scale:!0}})).activate(),s.changedEvt.addEventListener((function(e){var t=new SuperMap3D.Cartesian3;if(SuperMap3D.Matrix4.getTranslation(e.modelMatrix,t),t){var o;n.position=t,f=!0,S((function(){return f=!1}));var i=ae.CartesiantoDegrees(t);a.modelPosition.length=0,(o=a.modelPosition).push.apply(o,[i[0].toFixed(6),i[1].toFixed(6),i[2].toFixed(2)])}}))),m.value.style.top=e.message.position.y-160+"px",m.value.style.left=e.message.position.x+"px",console.log(s);var r=ae.CartesiantoDegrees(s._position);return a.modelPosition.length=0,(o=a.modelPosition).push.apply(o,[r[0].toFixed(6),r[1].toFixed(6),r[2].toFixed(2)]),void(a.bubbleShow=!0)}i=void 0,n=void 0,s&&s.deactivate(),a.bubbleShow=!1}var l}function g(e){var t=SuperMap3D.Cartographic.fromCartesian(e);return t.height+=.5,SuperMap3D.Cartographic.toCartesian(t)}function b(){a.bubbleShow=!1}function S(e){y&&clearTimeout(y),y=setTimeout((function(){e()}),1e3)}return e.watch((function(){return a.lightColor}),(function(e){if(n){var t=SuperMap3D.Color.fromCssColorString(e);n.color=t}})),e.watch((function(){return a.cutoffDistance}),(function(e){n&&(1!==n.lightType?2!==n.lightType||(n.distance=Number(e)):n.cutoffDistance=Number(e))})),e.watch((function(){return a.lightDecay}),(function(e){n&&0!==n.lightType&&(n.decay=Number(e))})),e.watch((function(){return a.lightIntensity}),(function(e){n&&(n.intensity=Number(e))})),e.watch((function(){return a.spotLightAngle}),(function(e){n&&2===n.lightType&&(n.angle=SuperMap3D.Math.toRadians(Number(e)))})),e.watch((function(){return a.visibleModel}),(function(e){i&&(s&&s.deactivate(),r.visible=e)})),e.watch((function(){return a.modelPosition}),(function(e){i&&!f&&S((function(){var t=Number(e[0]),o=Number(e[1]),r=Number(e[2]),a=SuperMap3D.Cartesian3.fromDegrees(t,o,r);n.position=a,i.primitive.updatePosition(a),s&&s.setEditObject(i.primitive)}))}),{deep:!0}),e.onBeforeUnmount((function(){})),u(u({},e.toRefs(a)),{},{config:Tp,addLight:function(){var e=0===a.lightSelectId?"<p>点击确认点光源位置</p><p>选中光源模型可编辑与删除</p>":"<p>点击第一点确认光源位置</p><p>第二点确认光源方向</p><p>选中光源模型可编辑与删除</p>";if(window.tooltip.showAt(e,"400px"),viewer.eventManager.addEventListener("CLICK",w,!0),0===a.lightSelectId)return viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),void(c=!0);v()},clearLight:function(){i&&(d.delete(i.id),r.removeInstance(p,i.id),i=null),n&&viewer.scene.removeLightSource(n),0===d.size&&viewer.eventManager.removeEventListener("CLICK",w),s&&s.deactivate(),c=!1,n=null,ce(),viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur"),tooltip.setVisible(!1),b()},bubble:m,closeBubble:b,dockBubble:function(e){e?(m.value.classList.add("bubbleDock"),a.dockFontShow=!1):(m.value.classList.remove("bubbleDock"),a.dockFontShow=!0)}})}var Ap={name:"Sm3dLight",props:{lightColor:{type:String},cutoffDistance:{type:Number},lightDecay:{type:Number},lightIntensity:{type:Number},spotLightAngle:{type:Number}},setup:function(e){var t=Ep(e);return{lightSelectId:t.lightSelectId,lightColor:t.lightColor,cutoffDistance:t.cutoffDistance,lightDecay:t.lightDecay,lightIntensity:t.lightIntensity,spotLightAngle:t.spotLightAngle,config:t.config,addLight:t.addLight,clearLight:t.clearLight,visibleModel:t.visibleModel,bubble:t.bubble,closeBubble:t.closeBubble,dockBubble:t.dockBubble,dockFontShow:t.dockFontShow,modelPosition:t.modelPosition,bubbleShow:t.bubbleShow,visiblePositions:t.visiblePositions}}},Ip={id:"draw-panel",class:"sm-panel"},Fp={class:"sm-function-module-sub-section",style:{margin:"0"}},Up={class:"sm-half-L symbolic"},_p={style:{width:"100%"}},Op={class:"sm-half-L"},Hp={style:{width:"35%"}},zp={class:"sm-half-L"},Gp={style:{width:"35%"}},jp={class:"sm-half-L"},Wp={style:{width:"35%"}},Kp={class:"sm-half-L"},Qp={style:{width:"35%"}},Xp={class:"sm-half-L"},Yp={style:{width:"35%"}},Zp={class:"sm-half-L flex-between"},qp={style:{width:"auto"}},Jp={style:{width:"auto"}},$p={class:"boxchild",style:{padding:"0"}},em={id:"bubble",class:"bubble",ref:"bubble"},tm={class:"boxchild flex-between"},om={style:{width:"auto"}},im={class:"flex flex-end",style:{width:"auto"}},nm={class:"sm-half-L"},rm={class:"label-S"},am={class:"sm-half-L"},lm={class:"label-S"},sm={class:"sm-half-L"},cm={class:"label-S"};function dm(o){var i,n,r,a=e.reactive({viewlongitude:"",viewlatitude:"",viewheight:"",direction:"",pitch:"",horizontal:20,vertical:10,distance:200,hintLineColor:"rgba(251,250,248,1)",clipMode:"clip-inside",visibleLine:!0,fileText:"",fromInfo:null});if(o)for(var l in o)a.hasOwnProperty(l)?a[l]=o[l]:ae.Message.errorMsg(te.AttributeError+l);var s,c,d,p=e.ref(null),m=new Map,h="public/data/s3m/projector.s3m",y=!1,f=null,v=new FileReader,w=!1;function g(e,t){return new Promise((function(o,i){var n=document.getElementById("videoContain"),r=document.createElement("video"),a=document.createElement("source");a.src=e,r.appendChild(a),r.id="trailer-"+t,r.classList.add("videoBox"),r.setAttribute("autoplay","autoplay"),r.setAttribute("loop","loop"),r.setAttribute("crossorigin","crossorigin"),r.setAttribute("controls","controls"),r.setAttribute("muted","muted"),n.appendChild(r),setTimeout((function(){o(r)}),500)}))}function b(e){if(!w){if(y){viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur");var t=SuperMap3D.Cartesian3.fromDegrees(r.viewPosition[0],r.viewPosition[1],r.viewPosition[2]),o=JSON.parse(JSON.stringify(t));return viewer.eventManager.removeEventListener("MOUSE_MOVE",S),i=o,n="projector-"+(new Date).getTime(),l=r.direction,d=r.pitch,u=SuperMap3D.Math.toRadians(l),p=u>=SuperMap3D.Math.PI?u-SuperMap3D.Math.PI:u+SuperMap3D.Math.PI,v=-SuperMap3D.Math.toRadians(d),s.add(h,{id:n,position:i,hpr:{heading:p,pitch:0,roll:v}}),f=s.getInstance(h,n),m.set(n,r),void(y=!1)}var i,n,l,d,u,p,v,g=viewer.scene.pick(e.message.position)||viewer.selectedEntity;if(g&&g.id&&"string"==typeof g.id&&-1!=g.id.indexOf("projector-"))return c&&c.destroy(),f=g,void((r=m.get(g.id))&&(a.horizontal=r.horizontalFov,a.vertical=r.verticalFov,a.distance=r.distance));f=null,r=null}}function S(e){var t=0,o=viewer.scene.camera.position,i=n.pickPosition(e.message.endPosition);i&&(t=SuperMap3D.Cartesian3.distance(o,i)),t>0&&t<1e3&&r.setDistDirByPoint(ae.CartesiantoDegrees(i))}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),n=viewer.scene,i=viewer.scene.layers.layerQueue,s=new SuperMap3D.S3MInstanceCollection(n._context),viewer.scene.primitives.add(s),viewer.eventManager.addEventListener("CLICK",b,!0)),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),n=viewer.scene,i=viewer.scene.layers.layerQueue,s=new SuperMap3D.S3MInstanceCollection(n._context),viewer.scene.primitives.add(s))})),e.watch((function(){return t.changeLayers}),(function(e){for(var t=0;t<i.length;t++)i[t].selectEnabled=!1})),e.onMounted((function(){p.value.addEventListener("change",(function(e){var t=e.target.files[0];if(t){a.fileText=p.value.value;var o=new Blob([t],{type:"video/mp4"});v.readAsDataURL(o),v.onload=function(e){var t=e.target.result,o=document.querySelectorAll("#videoContain>video").length;g(t,o).then((function(e){d=document.getElementById("trailer-"+o)}))}}})),d=document.getElementById("trailer-0")})),e.watch((function(){return a.fileText}),(function(e){if(-1!==e.indexOf("http")){var t=document.querySelectorAll("#videoContain>video").length;g(e,t).then((function(e){d=document.getElementById("trailer-"+t)}))}})),e.watch((function(){return a.horizontal}),(function(e){""!=e&&r&&(r.horizontalFov=Number(e))})),e.watch((function(){return a.vertical}),(function(e){""!=e&&r&&(r.verticalFov=Number(e))})),e.watch((function(){return a.distance}),(function(e){""!=e&&r&&(r.distance=Number(e))})),e.watch((function(){return a.visibleLine}),(function(e){r&&(s.visible=e,m.forEach((function(t){t.hintLineVisible=e})))})),e.watch((function(){return a.hintLineColor}),(function(e){r&&(r.hintLineColor=SuperMap3D.Color.fromCssColorString(e))})),e.watch((function(){return a.clipMode}),(function(e){if(r){var t="clip-outside"===e?SuperMap3D.ModifyRegionMode.CLIP_INSIDE:SuperMap3D.ModifyRegionMode.CLIP_OUTSIDE;r.setClipMode(t)}})),e.watch((function(){return a.viewlongitude}),(function(e){r&&""!=e&&(r.viewPosition[0]=e)})),e.watch((function(){return a.viewlatitude}),(function(e){r&&""!=e&&(r.viewPosition[1]=e)})),e.watch((function(){return a.viewheight}),(function(e){r&&""!=e&&(r.viewPosition[2]=e)})),e.watch((function(){return a.direction}),(function(e){r&&""!=e&&(r.direction=Number(e))})),e.watch((function(){return a.pitch}),(function(e){r&&""!=e&&(r.pitch=Number(e))})),e.watch((function(){return a.fromInfo}),(function(e){e&&""!=e&&SuperMap3D.ProjectionImage.fromInfo(n,a.fromInfo.infoUrl,a.fromInfo.baseUrl)})),e.onBeforeUnmount((function(){for(var e=0;e<i.length;e++)i[e].selectEnabled=!0})),u(u({},e.toRefs(a)),{},{chooseFile:function(){p.value.click()},vedioFile_dom:p,startProjection:function(){viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur");var e=viewer.scene.camera.position;d.play(),(r=new SuperMap3D.ProjectionImage(n)).setImage({video:d}),r.distance=Number(a.distance),r.horizontalFov=Number(a.horizontal),r.verticalFov=Number(a.vertical),r.viewPosition=ae.CartesiantoDegrees(e),r.build(),y=!0,window.tooltip.showAt(" <p>选中投放模型进行编辑和清除</p>","400px"),viewer.eventManager.addEventListener("MOUSE_MOVE",S),viewer.eventManager.addEventListener("CLICK",b,!0)},clear:function(){viewer.eventManager.removeEventListener("MOUSE_MOVE",S),f&&(m.delete(f.id),s.removeInstance(h,f.id),f=null),r&&(r.removeAllClipRegion(),r.destroy()),0===m.size&&viewer.eventManager.removeEventListener("CLICK",b),c&&c.destroy(),c=null,r=null,window.tooltip.setVisible(!1),ce(),viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur")},clipProjectImg:function(){w=!0,tooltip.setVisible(!1),window.tooltip.showAt(" <p>点击鼠标左键绘制裁剪区域</p><p>点击鼠标右键结束绘制</p><p>注：只能裁剪当前选中投放对象</p>","400px"),window.handlerPolygon||le("Polygon"),se("Polygon").then((function(e){w=!1;var t=window.handlerPolygon;!function(e){if(!r)return;r.addClipRegion({name:"clip-Projector"+(new Date).getTime(),position:e})}(e.positions),t.polygon.show=!1,t.polyline.show=!1,window.polylineTransparent.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate()}})}Ap.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-color-picker"),s=e.resolveComponent("el-slider"),c=e.resolveDirective("stopdrag"),d=e.resolveDirective("drag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",Ip,[e.withDirectives(e.createVNode("div",Fp,[e.createVNode("div",Up,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.config,(function(t){return e.openBlock(),e.createBlock("div",{key:t.id,class:["symbolic-box",{"theme-color":t.id===n.lightSelectId}],onClick:function(e){return n.lightSelectId=t.id}},[e.createVNode("span",{class:["iconfont",t.iconfont]},null,2),e.createVNode("label",_p,e.toDisplayString(t.lightName),1)],10,["onClick"])})),128))]),e.createVNode("div",Op,[e.createVNode("label",Hp,e.toDisplayString(t.Resource.lightColor),1),e.createVNode(l,{modelValue:n.lightColor,"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.lightColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),e.withDirectives(e.createVNode("div",zp,[e.createVNode("label",Gp,e.toDisplayString(t.Resource.cutoffDistance),1),e.createVNode(s,{modelValue:n.cutoffDistance,"onUpdate:modelValue":o[2]||(o[2]=function(e){return n.cutoffDistance=e}),min:0,max:500,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,2!==n.lightSelectId]]),e.withDirectives(e.createVNode("div",jp,[e.createVNode("label",Wp,e.toDisplayString(t.Resource.lightDecay),1),e.createVNode(s,{modelValue:n.lightDecay,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.lightDecay=e}),min:0,max:10,step:.1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])],512),[[e.vShow,2!==n.lightSelectId]]),e.createVNode("div",Kp,[e.createVNode("label",Qp,e.toDisplayString(t.Resource.lightIntensity),1),e.createVNode(s,{modelValue:n.lightIntensity,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.lightIntensity=e}),min:0,max:10,step:.1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),e.withDirectives(e.createVNode("div",Xp,[e.createVNode("label",Yp,e.toDisplayString(t.Resource.spotLightAngle),1),e.createVNode(s,{modelValue:n.spotLightAngle,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.spotLightAngle=e}),min:0,max:90,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])],512),[[e.vShow,1===n.lightSelectId]]),e.createVNode("div",Zp,[e.createVNode("label",qp,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.visibleModel=e})},null,512),[[e.vModelCheckbox,n.visibleModel]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.lightModel),1)]),e.createVNode("label",Jp,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[7]||(o[7]=function(e){return n.visiblePositions=e})},null,512),[[e.vModelCheckbox,n.visiblePositions]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.lightPositions),1)])]),e.createVNode("div",$p,[e.createCommentVNode(' <div class="flex flex-start" style="width:56%; align-items: center;">\r\n          <input checked type="checkbox" style="margin-right:10%" v-model="showLight" />\r\n          <label style="width:auto">显示光源</label>\r\n        </div>'),e.createVNode("button",{class:"tbtn",type:"button",style:{width:"auto"},onClick:o[8]||(o[8]=function(){return n.addLight&&n.addLight.apply(n,arguments)})},e.toDisplayString(t.Resource.add),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",style:{width:"auto"},type:"button ",onClick:o[9]||(o[9]=function(){return n.clearLight&&n.clearLight.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[c]])],512),[[d]]),e.withDirectives(e.createVNode("div",em,[e.createVNode("div",tm,[e.createVNode("label",om,e.toDisplayString(t.Resource.visiblePositions),1),e.createVNode("div",im,[e.withDirectives(e.createVNode("i",{class:"el-icon-position",title:"停靠",style:{"margin-right":"8px"},onClick:o[10]||(o[10]=function(e){return n.dockBubble(!0)})},null,512),[[e.vShow,n.dockFontShow]]),e.withDirectives(e.createVNode("i",{class:"el-icon-chat-square",title:"悬浮",style:{"margin-right":"8px"},onClick:o[11]||(o[11]=function(e){return n.dockBubble(!1)})},null,512),[[e.vShow,!n.dockFontShow]]),e.createVNode("i",{class:"el-icon-close",title:"关闭",onClick:o[12]||(o[12]=function(){return n.closeBubble&&n.closeBubble.apply(n,arguments)})})])]),e.createVNode("div",nm,[e.createVNode("label",rm,e.toDisplayString(t.Resource.longitude),1),e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[13]||(o[13]=function(e){return n.modelPosition[0]=e})},null,512),[[e.vModelText,n.modelPosition[0]]])]),e.createVNode("div",am,[e.createVNode("label",lm,e.toDisplayString(t.Resource.latitude),1),e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[14]||(o[14]=function(e){return n.modelPosition[1]=e})},null,512),[[e.vModelText,n.modelPosition[1]]])]),e.createVNode("div",sm,[e.createVNode("label",cm,e.toDisplayString(t.Resource.altitude),1),e.withDirectives(e.createVNode("input",{class:"sm-input-M",style:{width:"70%",height:"20px"},type:"text","onUpdate:modelValue":o[15]||(o[15]=function(e){return n.modelPosition[2]=e})},null,512),[[e.vModelText,n.modelPosition[2]]])])],512),[[e.vShow,n.bubbleShow&&n.visiblePositions]])],64)},Ap.__file="src/components/scene/light/light.vue",Ap.install=function(e){e.component(Ap.name,Ap)};var um={name:"Sm3dProjectionImage",props:{fileText:{type:Number},fromInfo:{type:Object}},setup:function(e){var t=dm(e);return{horizontal:t.horizontal,vertical:t.vertical,distance:t.distance,clipMode:t.clipMode,visibleLine:t.visibleLine,fileText:t.fileText,chooseFile:t.chooseFile,vedioFile_dom:t.vedioFile_dom,startProjection:t.startProjection,clear:t.clear,clipProjectImg:t.clipProjectImg}}},pm={id:"fly-route-panel",class:"sm-panel"},mm={class:"sm-function-module-sub-section",style:{margin:"0"}},hm={class:"sm-half-L"},ym={style:{width:"30%"}},fm={type:"file",accept:"*.mp4",id:"vedioFile",style:{display:"none"},ref:"vedioFile_dom"},vm={class:"sm-half-L"},wm={style:{width:"30%"}},gm={class:"sm-half-L"},bm={style:{width:"30%"}},Sm={class:"sm-half-L"},Vm={style:{width:"30%"}},Dm={class:"sm-half-L"},Nm={style:{width:"30%"}},Cm={class:"sm-half",style:{width:"68%"}},Mm={style:{width:"auto"}},xm={style:{width:"auto"}},Rm={class:"sm-half-L flex-between"},km={style:{width:"auto"}},Lm={class:"boxchild",style:{padding:"0"}},Pm=e.createVNode("div",{id:"videoContain",style:{width:"0",height:"0"}},[e.createVNode("video",{id:"trailer-0",style:{visibility:"hidden"},autoplay:"",loop:"",crossorigin:"",controls:"",muted:"",multiple:""},[e.createVNode("source",{src:"public/data/media/video.mp4",type:"video/mp4"})])],-1);um.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",pm,[e.withDirectives(e.createVNode("div",mm,[e.createVNode("div",hm,[e.createVNode("label",ym,e.toDisplayString(t.Resource.videoUrl),1),e.withDirectives(e.createVNode("input",{type:"text",class:"sm-input",style:{width:"65%",position:"relative","padding-right":"30px"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.fileText=e}),placeholder:t.Resource.fileType},null,8,["placeholder"]),[[e.vModelText,n.fileText]]),e.createVNode("span",{class:"iconfont iconwenjianjia fpfFile",onClick:o[2]||(o[2]=function(){return n.chooseFile&&n.chooseFile.apply(n,arguments)})}),e.createVNode("input",fm,null,512)]),e.createVNode("div",vm,[e.createVNode("label",wm,e.toDisplayString(t.Resource.horizontal),1),e.createVNode(l,{modelValue:n.horizontal,"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.horizontal=e}),min:.5,max:60,step:.5,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"65%"}},null,8,["modelValue","min","step"])]),e.createVNode("div",gm,[e.createVNode("label",bm,e.toDisplayString(t.Resource.vertical),1),e.createVNode(l,{modelValue:n.vertical,"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.vertical=e}),min:.5,max:60,step:.5,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"65%"}},null,8,["modelValue","min","step"])]),e.createVNode("div",Sm,[e.createVNode("label",Vm,e.toDisplayString(t.Resource.projectDistance),1),e.createVNode(l,{modelValue:n.distance,"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.distance=e}),min:1,max:500,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"65%"}},null,8,["modelValue"])]),e.createVNode("div",Dm,[e.createVNode("label",Nm,e.toDisplayString(t.Resource.clipMode),1),e.createVNode("div",Cm,[e.createVNode("label",Mm,[e.withDirectives(e.createVNode("input",{type:"radio",value:"clip-inside","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.clipMode=e})},null,512),[[e.vModelRadio,n.clipMode]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.clipInside),1)]),e.createVNode("label",xm,[e.withDirectives(e.createVNode("input",{type:"radio",value:"clip-outside","onUpdate:modelValue":o[7]||(o[7]=function(e){return n.clipMode=e})},null,512),[[e.vModelRadio,n.clipMode]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.clipOutside),1)])])]),e.createVNode("div",Rm,[e.createVNode("label",km,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=function(e){return n.visibleLine=e})},null,512),[[e.vModelCheckbox,n.visibleLine]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.visibleLine),1)]),e.createCommentVNode(' <label style="width:auto">\r\n          <input type="checkbox" v-model="visibleLine" />显示投放线\r\n        </label>')]),e.createVNode("div",Lm,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[9]||(o[9]=function(){return n.startProjection&&n.startProjection.apply(n,arguments)})},e.toDisplayString(t.Resource.projection),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button",onClick:o[10]||(o[10]=function(){return n.clipProjectImg&&n.clipProjectImg.apply(n,arguments)})},e.toDisplayString(t.Resource.clip),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[11]||(o[11]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)]),Pm],512),[[s]])],512)),[[c]])},um.__file="src/components/scene/projection-image/projection-image.vue",um.install=function(e){e.component(um.name,um)};var Bm=[{name:"线状纹理1",type:"line",url:"public/img/particleSystem/line-1.jpg"},{name:"线状纹理2",type:"line",url:"public/img/particleSystem/line-2.jpg"},{name:"环状纹理1",type:"ring",url:"public/img/particleSystem/ring-1.jpg"},{name:"环状纹理2",type:"ring",url:"public/img/particleSystem/ring-2.jpg"},{name:"环状六边形纹理",type:"ring",url:"public/img/particleSystem/ring-3.jpg"}];function Tm(o){var i=e.reactive({scanMode:"lineMode",scanColor:"#0F7AF4",scanTextures:[],selectedTextureIndex:0,bloomShow:!1,openHDR:!1,threshold:.01,intensity:.5,lineWidth:100,period:3,speed:100,addTextures:null,scanShow:!1});if(o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var a=[{name:"无纹理",type:"line",url:""}],l=[{name:"无纹理",type:"ring",url:""}];function s(e){for(var t=0;t<e.length;t++)"line"===e[t].type?a.push(e[t]):l.push(e[t]);i.scanTextures="lineMode"===i.scanMode?a:l}function c(){viewer.scene.scanEffect.color=SuperMap3D.Color.fromCssColorString(i.scanColor),viewer.scene.scanEffect.textureUrl="",viewer.scene.scanEffect.lineWidth=Number(i.lineWidth),viewer.scene.scanEffect.period=Number(i.period),viewer.scene.scanEffect.speed=Number(i.speed),viewer.scene.scanEffect.centerPostion=new SuperMap3D.Cartesian3.fromDegrees(0,0,0)}function d(){window.handlerPolyline||le("Polyline"),window.tooltip.showAt(" <p>点击鼠标左键开始绘制</p><p>绘制两点确定扫描线方向</p><p>鼠标右键结束绘制</p>","350px"),se("Polyline").then((function(e){!function(e){var t=new SuperMap3D.Cartesian3;if(SuperMap3D.Cartesian3.subtract(e[1],e[0],t),i.scanShow)return viewer.scene.scanEffect.add(e[0]),void(viewer.scene.scanEffect.lineMoveDirection=t);viewer.scene.scanEffect.centerPostion=e[0],viewer.scene.scanEffect.lineMoveDirection=t,i.scanShow=!0}(e.result.object.positions);var t=window.handlerPolyline;t.polyline.show=!1,window.polylineTransparent.show=!1,t.deactivate(),tooltip.setVisible(!1)}),(function(e){console.log(e)})),window.handlerPolyline.activate()}function p(e){viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur");var t=viewer.scene.pickPosition(e.message.position);i.scanShow?viewer.scene.scanEffect.add(t):(viewer.scene.scanEffect.centerPostion=t,i.scanShow=!0,viewer.eventManager.removeEventListener("CLICK",p))}return s(Bm),t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),c()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),c())})),e.watch((function(){return i.scanShow}),(function(e){viewer.scene.scanEffect.show=e})),e.watch((function(){return i.scanMode}),(function(e){if("lineMode"===e)return viewer.scene.scanEffect.mode=SuperMap3D.ScanEffectMode.LINE,void(i.scanTextures=a);viewer.scene.scanEffect.mode=SuperMap3D.ScanEffectMode.CIRCLE,i.scanTextures=l})),e.watch((function(){return i.scanColor}),(function(e){viewer.scene.scanEffect.color=SuperMap3D.Color.fromCssColorString(e)})),e.watch((function(){return i.selectedTextureIndex}),(function(e){viewer.scene.scanEffect.textureUrl=i.scanTextures[e].url})),e.watch((function(){return i.scanTextures}),(function(e){i.selectedTextureIndex=0})),e.watch((function(){return i.bloomShow}),(function(e){viewer.scene.bloomEffect.show=e,viewer.scene.bloomEffect.threshold=Number(i.threshold),viewer.scene.bloomEffect.bloomIntensity=Number(i.intensity)})),e.watch((function(){return i.openHDR}),(function(e){viewer.scene.hdrEnabled=e})),e.watch((function(){return i.threshold}),(function(e){viewer.scene.bloomEffect.threshold=Number(e)})),e.watch((function(){return i.intensity}),(function(e){viewer.scene.bloomEffect.bloomIntensity=Number(e)})),e.watch((function(){return i.lineWidth}),(function(e){viewer.scene.scanEffect.lineWidth=Number(e)})),e.watch((function(){return i.period}),(function(e){viewer.scene.scanEffect.period=Number(e)})),e.watch((function(){return i.speed}),(function(e){viewer.scene.scanEffect.speed=Number(e)})),e.watch((function(){return i.scanShow}),(function(e){viewer.scene.scanEffect.scanShow=e})),e.watch((function(){return i.addTextures}),(function(e){"object"===r(e)?s(e):console.log("addTextures类型不是数组！")})),e.onBeforeUnmount((function(){})),u(u({},e.toRefs(i)),{},{addScans:function(){"lineMode"!==i.scanMode?(viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),viewer.eventManager.addEventListener("CLICK",p,!0)):d()},clear:function(){i.scanShow=!1;for(var e=viewer.scene.scanEffect.count,t=0;t<e;t++)viewer.scene.scanEffect.remove(t);viewer.eventManager.removeEventListener("CLICK",p),ce("Polyline")}})}var Em={name:"Sm3dScanEffect",props:{scanMode:{type:String},scanColor:{type:String},selectedTextureIndex:{type:Number},bloomShow:{type:Boolean},openHDR:{type:Boolean},threshold:{type:Number},intensity:{type:Number},lineWidth:{type:Number},period:{type:Number},speed:{type:Number},addTextures:{type:Object},scanShow:{type:Boolean}},setup:function(e){var t=Tm(e);return{scanMode:t.scanMode,scanTextures:t.scanTextures,selectedTextureIndex:t.selectedTextureIndex,addScans:t.addScans,clear:t.clear}}},Am={id:"scan-effect-panel",class:"sm-panel"},Im={class:"sm-function-module-sub-section",style:{margin:"0"}},Fm={class:"sm-half-L"},Um={style:{width:"30%"}},_m={class:"sm-half",style:{width:"68%"}},Om={style:{width:"auto"}},Hm={style:{width:"auto"}},zm={class:"sm-half-L"},Gm={style:{width:"30%"}},jm={class:"boxchild",style:{"padding-bottom":"0"}};function Wm(o){var i=e.reactive({operationType:"stretch_cut",stretchHeight:1,modelUrls:null,digHeight:500,drillRadius:400,drillHeight:2e3,clipType:"drawClip",drawClipMode:"KeepInside"});if(i.modelUrls=[{id:1,model:"http://www.supermapol.com/realspace/services/data-dizhiti/rest/data/datasources/%E5%9C%B0%E8%B4%A8%E4%BD%93/datasets/Layer1/features/1.stream",color:new SuperMap3D.Color(179/255,179/255,179/255,1)},{id:2,model:"http://www.supermapol.com/realspace/services/data-dizhiti/rest/data/datasources/%E5%9C%B0%E8%B4%A8%E4%BD%93/datasets/Layer2/features/1.stream",color:new SuperMap3D.Color(94/255,179/255,59/255,1)},{id:3,model:"http://www.supermapol.com/realspace/services/data-dizhiti/rest/data/datasources/%E5%9C%B0%E8%B4%A8%E4%BD%93/datasets/Layer3/features/1.stream",color:new SuperMap3D.Color(52/255,94/255,35/255,1)},{id:4,model:"http://www.supermapol.com/realspace/services/data-dizhiti/rest/data/datasources/%E5%9C%B0%E8%B4%A8%E4%BD%93/datasets/Layer4/features/1.stream",color:new SuperMap3D.Color(115/255,115/255,115/255,1)},{id:5,model:"http://www.supermapol.com/realspace/services/data-dizhiti/rest/data/datasources/%E5%9C%B0%E8%B4%A8%E4%BD%93/datasets/Layer5/features/1.stream",color:new SuperMap3D.Color(171/255,85/255,66/255,1)},{id:6,model:"http://www.supermapol.com/realspace/services/data-dizhiti/rest/data/datasources/%E5%9C%B0%E8%B4%A8%E4%BD%93/datasets/Layer6/features/1.stream",color:new SuperMap3D.Color(68/255,68/255,68/255,1)}],o)for(var n in o)i.hasOwnProperty(n)?i[n]=o[n]:ae.Message.errorMsg(te.AttributeError+n);var r,a,l,s,c=[],d=0,p=[];function m(){(r=viewer.scene).logarithmicDepthBuffer=!0,r.camera.frustum.near=.1,r.globe.show=!1,viewer.scene.skyAtmosphere.show=!1,(a=new SuperMap3D.SolidModelsProfile(r)).addModels(i.modelUrls),console.log(a),a.addedEvent.addEventListener((function(e){console.log(a._s3mInstanceCollection.getInstance(i.modelUrls[2].model,3))})),viewer.scene.camera.setView({destination:new SuperMap3D.Cartesian3(-2167835.4408299956,4423497.534529096,4095839.2845661934),orientation:{heading:4.029329438295484,pitch:-.23796647219353817,roll:8.994289757424667e-10}})}function h(){tooltip.setVisible(!1),a.clearProfile(),ce("Polyline"),c.forEach((function(e){viewer.entities.removeById(e)})),c.length=0}function y(){window.handlerPolygon||le("Polygon"),se("Polygon",!1).then((function(e){var t=window.handlerPolygon;!function(e){var t=new SuperMap3D.Point3Ds;ae.CartesiantoDegreesObjs(e).forEach((function(e){var o=new SuperMap3D.Point3D(e.longitude,e.latitude,e.height+1e3);t.add(o)}));var o=new SuperMap3D.GeoRegion3D([t]);if("dig"===i.operationType){a.clippingType=SuperMap3D.ClippingType.KeepOutside,o.extrudedHeight=-Number(i.digHeight);var n=new SuperMap3D.GeoRegion3D([t]);n.isLatLon=!1,n.bottomAltitude=o.extrudedHeight,a.addProfileGeometry(n)}else o.extrudedHeight=-7e3;o.isLatLon=!1,a.setClipGeometry(o);for(var r=0;r<e.length;r++){var l=[];l.push(e[r]),r==e.length-1?l.push(e[0]):l.push(e[r+1]),a.addProfileGeometry(l),a.build()}}(e.result.object.positions),t.polygon.show=!1,t.polyline.show=!1,t.deactivate()}),(function(e){console.log(e)})),window.handlerPolygon.activate()}function f(){tooltip.setVisible(!1),a.clearProfile(),ce()}function v(e){var t=viewer.scene.pickPosition(e.message.position);!function(e){d++,viewer.entities.add({id:"Drill_Point-"+d,position:e,cylinder:{length:100,topRadius:Number(i.drillRadius),bottomRadius:Number(i.drillRadius),material:SuperMap3D.Color.fromCssColorString("#d60000")}})}(t),p.push(t)}function w(e){window.tooltip.setVisible(!1),document.body.classList.remove("measureCur"),ae.CartesiantoDegreesObjs(p).forEach((function(e){var t=new SuperMap3D.GeoCylinder(Number(i.drillRadius),Number(i.drillRadius),Number(i.drillHeight)),o=Number(i.drillHeight)/2;t.geoPosition=new SuperMap3D.Point3D(e.longitude,e.latitude,e.height-o),a.addProfileGeometry(t)}));for(var t=1;t<=d;t++)viewer.entities.removeById("Drill_Point-"+t);a.build(),viewer.eventManager.removeEventListener("CLICK",v),viewer.eventManager.removeEventListener("RIGHT_CLICK",w)}function b(){tooltip.setVisible(!1),a.clearProfile(),document.body.classList.remove("measureCur");for(var e=1;e<=d;e++)viewer.entities.removeById("Drill_Point-"+e);viewer.eventManager.removeEventListener("CLICK",v),viewer.eventManager.removeEventListener("RIGHT_CLICK",w),d=0,p.length=0}function S(){f(),ce("Box"),l&&(l.deactivate(),l.destroy(),l=null)}function V(){h(),S(),b()}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),m()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),m())})),e.watch((function(){return i.modelUrls}),(function(e){a.addModels(e)})),e.watch((function(){return i.stretchHeight}),(function(e){if(i.modelUrls&&0!=i.modelUrls.length){var t,o=g(i.modelUrls);try{for(o.s();!(t=o.n()).done;){var n=t.value.model;a._s3mInstanceCollection._group[n].instances._array[0].updateScale(new SuperMap3D.Cartesian3(1,1,Number(e)))}}catch(e){o.e(e)}finally{o.f()}}})),e.watch((function(){return i.operationType}),(function(e){V()})),e.watch((function(){return i.drawClipMode}),(function(e){a.clippingType=SuperMap3D.ClippingType[e]})),e.watch((function(){return i.clipType}),(function(e){S()})),e.onBeforeUnmount((function(){a.clear(),viewer.scene.globe.show=!0,viewer.scene.skyAtmosphere.show=!0,V(),r=null,a=null,s=null})),u(u({},e.toRefs(i)),{},{drawLine:function(){window.handlerPolyline||le("Polyline"),window.tooltip.showAt(" <p>点击鼠标左键开始绘制</p><p>鼠标右键结束绘制</p><p>可以绘制多条线段</p>","350px"),se("Polyline").then((function(e){!function(e){var t=[];if(e.length<2)return;for(var o=0;o<e.length-1;o++)t.length=0,t.push(e[o]),t.push(e[o+1]),a.addProfileGeometry(t)}(e.result.object.positions);var t=window.handlerPolyline;t.polyline.show=!1,t.deactivate(),tooltip.setVisible(!1);var o="geologicalbody_cutline-"+(new Date).getTime();c.push(o),viewer.entities.add({id:o,polyline:{positions:e.result.object.positions,width:2,material:SuperMap3D.Color.fromCssColorString("#51ff00")}})}),(function(e){console.log(e)})),window.handlerPolyline.activate()},startCut:function(){tooltip.setVisible(!1),ce("Polyline"),0!==c.length?a.build():window.tooltip.showAt(" <p>请先绘制剖切的线段</p>","350px")},clearCut:h,startDig:function(){f(),y()},clearDig:f,startDrilling:function(){b(),viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),window.tooltip.showAt(" <p>点击鼠标左键确认钻孔位置</p><p>鼠标右键结束绘制并执行钻孔</p>","350px"),console.log(1),viewer.eventManager.addEventListener("CLICK",v,!0),viewer.eventManager.addEventListener("RIGHT_CLICK",w,!0)},clearDrilling:b,startClip:function(){S(),a.clippingType=SuperMap3D.ClippingType[i.drawClipMode],"drawClip"!==i.clipType?function(){l&&l.deactivate();tooltip.showAt(" <p>点击鼠标左键开始绘制box底面</p><p>然后移动鼠标绘制box高度</p><p>点击鼠标右键结束绘制</p>","350px"),window.handlerBox||le("Box");se("Box",!1).then((function(e){var t=window.handlerBox;!function(e){e.show=!1;var t=e.box.dimensions.getValue(),o=SuperMap3D.Cartographic.fromCartesian(e.position.getValue(0));if((s=new SuperMap3D.GeoBox(t.x,t.y,t.z)).geoPosition=new SuperMap3D.Point3D(SuperMap3D.Math.toDegrees(o.longitude),SuperMap3D.Math.toDegrees(o.latitude),o.height),a.addProfileGeometry(s),a.build(),l)l.setEditObject(e);else{(l=new SuperMap3D.BoxEditor(viewer,e)).color=SuperMap3D.Color.WHITE.withAlpha(0),l.hoverColor=SuperMap3D.Color.BLUE;var i=function(e){var t=e.dimensions;s.geoWidth=t.y,s.geoHeight=t.z,s.geoLength=t.x;var o=ae.CartesiantoDegrees(e.position);s.geoPosition=new SuperMap3D.Point3D(o[0],o[1],o[2]),s.geoRotationZ=l.hpr.heading*(180/SuperMap3D.Math.PI)};l.editEvt.addEventListener(i)}l.activate()}(e.result.object),t.deactivate()}),(function(e){console.log(e)})),window.handlerBox.activate()}():y()},clearClip:S})}Em.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Am,[e.withDirectives(e.createVNode("div",Im,[e.createVNode("div",Fm,[e.createVNode("label",Um,e.toDisplayString(t.Resource.scanMode),1),e.createVNode("div",_m,[e.createVNode("label",Om,[e.withDirectives(e.createVNode("input",{type:"radio",value:"lineMode","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.scanMode=e}),style:{"margin-right":"0"}},null,512),[[e.vModelRadio,n.scanMode]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.lineScan),1)]),e.createVNode("label",Hm,[e.withDirectives(e.createVNode("input",{type:"radio",value:"ringMode","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.scanMode=e}),style:{"margin-right":"0"}},null,512),[[e.vModelRadio,n.scanMode]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.circularScan),1)])])]),e.withDirectives(e.createVNode("div",zm,[e.createVNode("label",Gm,e.toDisplayString(t.Resource.scanTexture),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"68%"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.selectedTextureIndex=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.scanTextures,(function(t,o){return e.openBlock(),e.createBlock("option",{value:o,key:o},e.toDisplayString(t.name),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedTextureIndex]])],512),[[e.vShow,n.scanTextures.length>0]]),e.createVNode("div",jm,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[4]||(o[4]=function(){return n.addScans&&n.addScans.apply(n,arguments)})},e.toDisplayString(t.Resource.add),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[5]||(o[5]=function(){return n.clear&&n.clear.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[l]])],512)),[[s]])},Em.__file="src/components/special-effects/scan-effect/scan-effect.vue",Em.install=function(e){e.component(Em.name,Em)};var Km={name:"Sm3dGeologicalBody",props:{},setup:function(e){var t=Wm(e);return{operationType:t.operationType,stretchHeight:t.stretchHeight,drawLine:t.drawLine,startCut:t.startCut,clearCut:t.clearCut,digHeight:t.digHeight,startDig:t.startDig,clearDig:t.clearDig,startDrilling:t.startDrilling,clearDrilling:t.clearDrilling,drillHeight:t.drillHeight,drillRadius:t.drillRadius,startClip:t.startClip,clearClip:t.clearClip,clipType:t.clipType,drawClipMode:t.drawClipMode}}},Qm={id:"geological-body-panel",class:"sm-panel"},Xm={class:"sm-function-module-sub-section",style:{margin:"0"}},Ym={class:"sm-half-L"},Zm={style:{width:"33%"}},qm={value:"stretch_cut"},Jm={value:"dig"},$m={value:"drilling"},eh={value:"clip"},th={class:"sm-half-L"},oh={style:{width:"33%"}},ih={class:"boxchild",style:{"padding-bottom":"0"}},nh={class:"sm-half-L"},rh={style:{width:"33%"}},ah={class:"boxchild",style:{"padding-bottom":"0"}},lh={class:"sm-half-L"},sh={style:{width:"33%"}},ch={class:"sm-half-L"},dh={style:{width:"33%"}},uh={class:"boxchild",style:{"padding-bottom":"0"}},ph={style:{width:"100%"}},mh={class:"sm-half-L"},hh={style:{width:"auto"}},yh={style:{width:"auto"}},fh={class:"sm-half-L"},vh={style:{width:"33%"}},wh={value:"KeepInside"},gh={value:"KeepOutside"},bh={class:"boxchild",style:{"padding-bottom":"0"}};function Sh(e){this.tableName=e.tableName,this.opacityMinValue=e.opacityMinValue,this.opacityMaxValue=e.opacityMaxValue,this.gradientMinOpacity=e.gradientMinOpacity,this.gradientMaxOpacity=e.gradientMaxOpacity,this.visibleMinValue=e.visibleMinValue,this.visibleMaxValue=e.visibleMaxValue}function Vh(o){var i,n=e.reactive({dataUrl:"",operationType:"addDate",dimensions:[],variables:[],selectedDateName:null,xDim:100,yDim:200,zDim:9,timeDim:40,drawMode:"volume",opacityInterval:[0,1],useGradientOpacity:!1,gradientOpacityValue:[0,1],gradientOpacity:[0,1],showClipPlane:!1,clipX:.5,clipY:.5,clipRotate:0,xOffset:.5,yOffset:.5,zOffset:.5,contourValue:1,contourRange:[0,1],zScale:0,colorInterval:[0,1],timeOrder:0,timeRange:[0,24],openLight:!1});if(o)for(var r in o)n.hasOwnProperty(r)?n[r]=o[r]:ae.Message.errorMsg(te.AttributeError+r);var a,l=new SuperMap3D.Cartesian3(1,1,1),s=new SuperMap3D.Cartesian3(.5,.5,.5),c=SuperMap3D.Plane.fromPointNormal(new SuperMap3D.Cartesian3(0,0,0),new SuperMap3D.Cartesian3(1,0,0));function d(){if(!n.dataUrl)return ae.Message.warnMsg("请先定义数据路径！");var e=viewer.scene.addVoxelGridLayer(n.dataUrl,"test");SuperMap3D.when(e,(function(e){i=e,n.dimensions=i._NetCDFInfo.dimensions,n.variables=i._NetCDFInfo.variables,n.selectedDateName=n.variables[0].name,n.xDim=n.dimensions[0].name,n.yDim=n.dimensions[1].name,n.zDim=n.dimensions[2].name,n.timeDim=n.dimensions[3].name,i.layerBounds=new SuperMap3D.Rectangle(99.95422,32.25671,107.1912,37.1386),i.zBounds=new SuperMap3D.Cartesian2(500,5e4)}))}function p(){var e=i.layerBounds.west+(i.layerBounds.east-i.layerBounds.west)*Number(n.clipX),t=i.layerBounds.south+(i.layerBounds.north-i.layerBounds.south)*Number(n.clipY);viewer.entities.removeById("volume-clip-plane"),viewer.entities.add({id:"volume-clip-plane",position:SuperMap3D.Cartesian3.fromDegrees(e,t,5e4),point:{color:SuperMap3D.Color.YELLOW,pixelSize:10}})}return t.isViewer&&(window.tooltip||(window.tooltip=Z(viewer._element)),d()),e.watch((function(){return t.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=Z(viewer._element)),d())})),e.onBeforeUnmount((function(){viewer.scene.layers.remove(i.name),i=null})),e.watch((function(){return n.drawMode}),(function(e){i&&(i.volumeRenderMode="slice"===e?1:"gradient"===e?2:0)})),e.watch((function(){return n.useGradientOpacity}),(function(e){i&&(i.useGradientOpacity=e)})),e.watch((function(){return n.gradientOpacityValue}),(function(e){i&&(a.gradientMinOpacity=e[0],a.gradientMaxOpacity=e[1],a.setGradientOpacityValue(i))})),e.watch((function(){return n.opacityInterval}),(function(e){i&&(a.opacityMinValue=e[0],a.opacityMaxValue=e[1],a.setColorTable(i))})),e.watch((function(){return n.gradientOpacity}),(function(e){i&&(i.gradientOpacityMinOpacity=e[0],i.gradientOpacityMaxOpacity=e[1])})),e.watch((function(){return n.zScale}),(function(e){i&&(l.z=parseFloat(e),i.scale=l)})),e.watch((function(){return n.colorInterval}),(function(e){i&&(a.visibleMinValue=e[0],a.visibleMaxValue=e[1],a.setColorTable(i))})),e.watch((function(){return n.timeOrder}),(function(e){i&&(i.frameIndex=Number(e))})),e.watch((function(){return n.openLight}),(function(e){i&&(i.enableLighting=e)})),e.watch((function(){return n.clipX}),(function(e){if(i){p();var t=parseFloat(e),o=parseFloat(n.clipY),r=SuperMap3D.Math.toRadians(n.clipRotate),a=SuperMap3D.Quaternion.fromAxisAngle(SuperMap3D.Cartesian3.UNIT_Z,r),l=new SuperMap3D.Cartesian3(t,o,0),s=new SuperMap3D.TranslationRotationScale(l,a),d=SuperMap3D.Matrix4.fromTranslationRotationScale(s);SuperMap3D.Plane.fromPointNormal(new SuperMap3D.Cartesian3(0,0,0),new SuperMap3D.Cartesian3(1,0,0),c),SuperMap3D.Plane.transform(c,d,c)}})),e.watch((function(){return n.clipY}),(function(e){if(i){p();var t=parseFloat(n.clipX),o=parseFloat(e),r=new SuperMap3D.Cartesian3(t,o,0);SuperMap3D.Plane.fromPointNormal(r,new SuperMap3D.Cartesian3(0,1,0),c)}})),e.watch((function(){return n.clipRotate}),(function(e){if(i){var t=parseFloat(n.clipX),o=parseFloat(n.clipY),r=SuperMap3D.Math.toRadians(e),a=SuperMap3D.Quaternion.fromAxisAngle(SuperMap3D.Cartesian3.UNIT_Z,r),l=new SuperMap3D.Cartesian3(t,o,0),s=SuperMap3D.Matrix3.fromQuaternion(a),d=SuperMap3D.Matrix4.fromRotationTranslation(s),u=new SuperMap3D.Cartesian3(1,0,0);u=SuperMap3D.Matrix4.multiplyByPoint(d,u,new SuperMap3D.Cartesian3),SuperMap3D.Plane.fromPointNormal(l,u,c)}})),e.watch((function(){return n.xOffset}),(function(e){i&&(s.x=parseFloat(e),i.sliceCoordinate=s)})),e.watch((function(){return n.yOffset}),(function(e){i&&(s.y=parseFloat(e),i.sliceCoordinate=s)})),e.watch((function(){return n.zOffset}),(function(e){i&&(s.z=parseFloat(e),i.sliceCoordinate=s)})),e.watch((function(){return n.contourValue}),(function(e){i&&(i.contourValue=parseFloat(e))})),u(u({},e.toRefs(n)),{},{startRender:function(){i?n.xDim!=n.yDim&&n.xDim!=n.zDim&&n.yDim!=n.zDim?((a=new Sh({opacityMinValue:0,opacityMaxValue:.8,gradientMinOpacity:1,gradientMaxOpacity:1,visibleMinValue:0,visibleMaxValue:.37})).setColorTable(i,0),i.startRender({variableName:n.selectedDateName,xDimName:n.xDim,yDimName:n.yDim,zDimName:n.zDim,timeDimName:n.timeDim}),function(){n.contourRange=[Math.ceil(i.minValue),Math.ceil(i.maxValue)],n.contourValue=Math.ceil(i.minValue);var e=i._NetCDFInfo.recordDimension;e&&e.length>0&&(n.timeRange=[0,e.length])}(),viewer.scene.camera.flyTo({destination:{x:-1688158.0372444934,y:6654029.431965283,z:2998692.1265170774},orientation:{heading:.028840576504810755,pitch:-.8994386458052253,roll:6.283185307179586}})):ae.Message.warnMsg("各维度名不能一样"):d()},addClipPlane:function(){!SuperMap3D.defined(i)||i.getNumberOfClipPlanes()>0||(n.showClipPlane=!0,i.addClipPlane(c),p())},removeClipPlane:function(){SuperMap3D.defined(i)&&0!==i.getNumberOfClipPlanes()&&(n.showClipPlane=!1,i.removeAllClipPlanes(),viewer.entities.removeById("volume-clip-plane"))},clear:function(){i&&(viewer.scene.layers.remove(i.name),i=null,d())}})}Km.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Qm,[e.withDirectives(e.createVNode("div",Xm,[e.createVNode("div",Ym,[e.createVNode("label",Zm,e.toDisplayString(t.Resource.operationType),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"65%"},"onUpdate:modelValue":o[1]||(o[1]=function(e){return n.operationType=e})},[e.createVNode("option",qm,e.toDisplayString(t.Resource.stretch_cut),1),e.createVNode("option",Jm,e.toDisplayString(t.Resource.excavation),1),e.createVNode("option",$m,e.toDisplayString(t.Resource.drilling),1),e.createVNode("option",eh,e.toDisplayString(t.Resource.clip),1),e.createCommentVNode(' <option value="volume">叠加体元</option> ')],512),[[e.vModelSelect,n.operationType]])]),e.createCommentVNode(" 拉伸与剖切 "),e.withDirectives(e.createVNode("div",null,[e.createVNode("div",th,[e.createVNode("label",oh,e.toDisplayString(t.Resource.stretchHeight),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"65%"},min:"1","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.stretchHeight=e})},null,512),[[e.vModelText,n.stretchHeight]])]),e.createVNode("div",ih,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[3]||(o[3]=function(){return n.drawLine&&n.drawLine.apply(n,arguments)})},e.toDisplayString(t.Resource.drawLine),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[4]||(o[4]=function(){return n.startCut&&n.startCut.apply(n,arguments)})},e.toDisplayString(t.Resource.cut),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[5]||(o[5]=function(){return n.clearCut&&n.clearCut.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[e.vShow,"stretch_cut"===n.operationType]]),e.createCommentVNode(" 开挖 "),e.withDirectives(e.createVNode("div",null,[e.createVNode("div",nh,[e.createVNode("label",rh,e.toDisplayString(t.Resource.terrainExcavationDepth),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"65%"},min:"1","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.digHeight=e})},null,512),[[e.vModelText,n.digHeight]])]),e.createVNode("div",ah,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[7]||(o[7]=function(){return n.startDig&&n.startDig.apply(n,arguments)})},e.toDisplayString(t.Resource.excavation),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[8]||(o[8]=function(){return n.clearDig&&n.clearDig.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[e.vShow,"dig"===n.operationType]]),e.createCommentVNode(" 钻孔 "),e.withDirectives(e.createVNode("div",null,[e.createVNode("div",lh,[e.createVNode("label",sh,e.toDisplayString(t.Resource.drillRadius),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"65%"},min:"1","onUpdate:modelValue":o[9]||(o[9]=function(e){return n.drillRadius=e})},null,512),[[e.vModelText,n.drillRadius]])]),e.createVNode("div",ch,[e.createVNode("label",dh,e.toDisplayString(t.Resource.drillHeight),1),e.withDirectives(e.createVNode("input",{type:"number",class:"sm-input",style:{width:"65%"},min:"1","onUpdate:modelValue":o[10]||(o[10]=function(e){return n.drillHeight=e})},null,512),[[e.vModelText,n.drillHeight]])]),e.createVNode("div",uh,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[11]||(o[11]=function(){return n.startDrilling&&n.startDrilling.apply(n,arguments)})},e.toDisplayString(t.Resource.drilling),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[12]||(o[12]=function(){return n.clearDrilling&&n.clearDrilling.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[e.vShow,"drilling"===n.operationType]]),e.createCommentVNode(" 裁剪 "),e.withDirectives(e.createVNode("div",ph,[e.createVNode("div",mh,[e.createVNode("label",hh,[e.withDirectives(e.createVNode("input",{type:"radio",value:"drawClip","onUpdate:modelValue":o[13]||(o[13]=function(e){return n.clipType=e})},null,512),[[e.vModelRadio,n.clipType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.drawClip),1)]),e.createVNode("label",yh,[e.withDirectives(e.createVNode("input",{type:"radio",value:"boxClip","onUpdate:modelValue":o[14]||(o[14]=function(e){return n.clipType=e})},null,512),[[e.vModelRadio,n.clipType]]),e.createTextVNode(" "+e.toDisplayString(t.Resource.boxClip),1)])]),e.withDirectives(e.createVNode("div",fh,[e.createVNode("label",vh,e.toDisplayString(t.Resource.clipMode),1),e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"65%"},"onUpdate:modelValue":o[15]||(o[15]=function(e){return n.drawClipMode=e})},[e.createVNode("option",wh,e.toDisplayString(t.Resource.clipOutside),1),e.createVNode("option",gh,e.toDisplayString(t.Resource.clipInside),1)],512),[[e.vModelSelect,n.drawClipMode]])],512),[[e.vShow,"drawClip"===n.clipType]]),e.createVNode("div",bh,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[16]||(o[16]=function(){return n.startClip&&n.startClip.apply(n,arguments)})},e.toDisplayString(t.Resource.clip),1),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button ",onClick:o[17]||(o[17]=function(){return n.clearClip&&n.clearClip.apply(n,arguments)})},e.toDisplayString(t.Resource.clear),1)])],512),[[e.vShow,"clip"===n.operationType]])],512),[[l]])],512)),[[s]])},Km.__file="src/components/model/geological-body/geological-body.vue",Km.install=function(e){e.component(Km.name,Km)},Sh.prototype.setColorTable=function(e,t){if(SuperMap3D.defined(e)){var o=e.minValue,i=e.maxValue,n=this.visibleMinValue,r=this.visibleMaxValue;if(n>r){var a=n;n=r,r=a}this.setOpacityFunction(e,o,i,n,r),this.setColorFunction(e,o,i,n,r,t)}},Sh.prototype.setOpacityFunction=function(e,t,o,i,n){var r=this.opacityMinValue,a=this.opacityMaxValue,l=new SuperMap3D.PiecewiseFunction;l.addPoint(t,0),l.addPoint(t+(o-t)*i,r),l.addPoint(t+(o-t)*n,a),l.addPoint(t+(o-t)*(n+.01),r),l.addPoint(o,0),e.opacityTransferFunction=l},Sh.prototype.setColorFunction=function(e,t,o,i,n,r){var a=new SuperMap3D.ColorTransferFunction,l=(n-i)/15;switch(r){case 1:a.addRGBPoint(t,9/255,9/255,212/255),a.addRGBPoint(t+(o-t)*i,9/255,10/255,1),a.addRGBPoint(t+(o-t)*(i+l),9/255,.2,1),a.addRGBPoint(t+(o-t)*(i+2*l),9/255,.4,1),a.addRGBPoint(t+(o-t)*(i+3*l),9/255,.6,1),a.addRGBPoint(t+(o-t)*(i+4*l),9/255,.8,1),a.addRGBPoint(t+(o-t)*(i+5*l),9/255,1,1),a.addRGBPoint(t+(o-t)*(i+6*l),.2,1,.8),a.addRGBPoint(t+(o-t)*(i+7*l),.4,1,.6),a.addRGBPoint(t+(o-t)*(i+8*l),.6,1,.4),a.addRGBPoint(t+(o-t)*(i+9*l),.8,1,.2),a.addRGBPoint(t+(o-t)*(i+10*l),1,1,0),a.addRGBPoint(t+(o-t)*(i+11*l),1,.8,0),a.addRGBPoint(t+(o-t)*(i+12*l),1,.6,0),a.addRGBPoint(t+(o-t)*(i+13*l),1,.4,0),a.addRGBPoint(t+(o-t)*(i+14*l),1,.2,0),a.addRGBPoint(t+(o-t)*(i+15*l),1,0,0);break;case 2:a.addRGBPoint(t,1,103/255,103/255),a.addRGBPoint(t+(o-t)*i,1,0,1),a.addRGBPoint(t+(o-t)*(i+l),1,.2,1),a.addRGBPoint(t+(o-t)*(i+2*l),1,.4,1),a.addRGBPoint(t+(o-t)*(i+3*l),1,.6,1),a.addRGBPoint(t+(o-t)*(i+4*l),1,.8,1),a.addRGBPoint(t+(o-t)*(i+5*l),1,1,1),a.addRGBPoint(t+(o-t)*(i+6*l),.2,1,.8),a.addRGBPoint(t+(o-t)*(i+7*l),.4,1,.6),a.addRGBPoint(t+(o-t)*(i+8*l),.6,1,.4),a.addRGBPoint(t+(o-t)*(i+9*l),.8,1,.2),a.addRGBPoint(t+(o-t)*(i+10*l),1,1,0),a.addRGBPoint(t+(o-t)*(i+11*l),1,.8,0),a.addRGBPoint(t+(o-t)*(i+12*l),1,.6,0),a.addRGBPoint(t+(o-t)*(i+13*l),1,.4,0),a.addRGBPoint(t+(o-t)*(i+14*l),1,.2,0),a.addRGBPoint(t+(o-t)*(i+15*l),1,0,0);break;case 3:a.addRGBPoint(t,157/255,0,1),a.addRGBPoint(t+(o-t)*i,157/255,0,1),a.addRGBPoint(t+(o-t)*(i+l),157/255,.2,1),a.addRGBPoint(t+(o-t)*(i+2*l),157/255,.4,1),a.addRGBPoint(t+(o-t)*(i+3*l),157/255,.6,1),a.addRGBPoint(t+(o-t)*(i+4*l),157/255,.8,1),a.addRGBPoint(t+(o-t)*(i+5*l),157/255,1,1),a.addRGBPoint(t+(o-t)*(i+6*l),.2,1,.8),a.addRGBPoint(t+(o-t)*(i+7*l),.4,1,.6),a.addRGBPoint(t+(o-t)*(i+8*l),.6,1,.4),a.addRGBPoint(t+(o-t)*(i+9*l),.8,1,.2),a.addRGBPoint(t+(o-t)*(i+10*l),1,1,0),a.addRGBPoint(t+(o-t)*(i+11*l),1,.8,0),a.addRGBPoint(t+(o-t)*(i+12*l),1,.6,0),a.addRGBPoint(t+(o-t)*(i+13*l),1,.4,0),a.addRGBPoint(t+(o-t)*(i+14*l),1,.2,0),a.addRGBPoint(t+(o-t)*(i+15*l),1,0,0);break;case 4:a.addRGBPoint(t,149/255,232/255,249/255),a.addRGBPoint(t+(o-t)*i,149/255,0,1),a.addRGBPoint(t+(o-t)*(i+l),149/255,.2,1),a.addRGBPoint(t+(o-t)*(i+2*l),149/255,.4,1),a.addRGBPoint(t+(o-t)*(i+3*l),149/255,.6,1),a.addRGBPoint(t+(o-t)*(i+4*l),149/255,.8,1),a.addRGBPoint(t+(o-t)*(i+5*l),149/255,1,1),a.addRGBPoint(t+(o-t)*(i+6*l),.2,1,.8),a.addRGBPoint(t+(o-t)*(i+7*l),.4,1,.6),a.addRGBPoint(t+(o-t)*(i+8*l),.6,1,.4),a.addRGBPoint(t+(o-t)*(i+9*l),.8,1,.2),a.addRGBPoint(t+(o-t)*(i+10*l),1,1,0),a.addRGBPoint(t+(o-t)*(i+11*l),1,.8,0),a.addRGBPoint(t+(o-t)*(i+12*l),1,.6,0),a.addRGBPoint(t+(o-t)*(i+13*l),1,.4,0),a.addRGBPoint(t+(o-t)*(i+14*l),1,.2,0),a.addRGBPoint(t+(o-t)*(i+15*l),1,0,0);break;case 5:a.addRGBPoint(t,26/255,1,156/255),a.addRGBPoint(t+(o-t)*i,26/255,0,1),a.addRGBPoint(t+(o-t)*(i+l),26/255,.2,1),a.addRGBPoint(t+(o-t)*(i+2*l),26/255,.4,1),a.addRGBPoint(t+(o-t)*(i+3*l),26/255,.6,1),a.addRGBPoint(t+(o-t)*(i+4*l),26/255,.8,1),a.addRGBPoint(t+(o-t)*(i+5*l),26/255,1,1),a.addRGBPoint(t+(o-t)*(i+6*l),.2,1,.8),a.addRGBPoint(t+(o-t)*(i+7*l),.4,1,.6),a.addRGBPoint(t+(o-t)*(i+8*l),.6,1,.4),a.addRGBPoint(t+(o-t)*(i+9*l),.8,1,.2),a.addRGBPoint(t+(o-t)*(i+10*l),1,1,0),a.addRGBPoint(t+(o-t)*(i+11*l),1,.8,0),a.addRGBPoint(t+(o-t)*(i+12*l),1,.6,0),a.addRGBPoint(t+(o-t)*(i+13*l),1,.4,0),a.addRGBPoint(t+(o-t)*(i+14*l),1,.2,0),a.addRGBPoint(t+(o-t)*(i+15*l),1,0,0);break;default:a.addRGBPoint(t,0,0,1),a.addRGBPoint(t+(o-t)*i,0,0,1),a.addRGBPoint(t+(o-t)*(i+l),0,.2,1),a.addRGBPoint(t+(o-t)*(i+2*l),0,.4,1),a.addRGBPoint(t+(o-t)*(i+3*l),0,.6,1),a.addRGBPoint(t+(o-t)*(i+4*l),0,.8,1),a.addRGBPoint(t+(o-t)*(i+5*l),0,1,1),a.addRGBPoint(t+(o-t)*(i+6*l),.2,1,.8),a.addRGBPoint(t+(o-t)*(i+7*l),.4,1,.6),a.addRGBPoint(t+(o-t)*(i+8*l),.6,1,.4),a.addRGBPoint(t+(o-t)*(i+9*l),.8,1,.2),a.addRGBPoint(t+(o-t)*(i+10*l),1,1,0),a.addRGBPoint(t+(o-t)*(i+11*l),1,.8,0),a.addRGBPoint(t+(o-t)*(i+12*l),1,.6,0),a.addRGBPoint(t+(o-t)*(i+13*l),1,.4,0),a.addRGBPoint(t+(o-t)*(i+14*l),1,.2,0),a.addRGBPoint(t+(o-t)*(i+15*l),1,0,0)}i+15*l<1&&a.addRGBPoint(o,1,0,0),e.colorTransferFunction=a},Sh.prototype.setGradientOpacityValue=function(e){var t=e.minValue,o=e.maxValue,i=this.gradientMinOpacity,n=this.gradientMaxOpacity;if(i>n){var r=i;i=n,n=r}e.gradientOpacityMinValue=.1*Math.abs(o-t)*i,e.gradientOpacityMaxValue=.1*Math.abs(o-t)*n};var Dh={name:"Sm3dVolumeRender",props:{dataUrl:{type:String,required:!0}},setup:function(e){var t=Vh(e);return{operationType:t.operationType,dimensions:t.dimensions,variables:t.variables,selectedDateName:t.selectedDateName,xDim:t.xDim,yDim:t.yDim,zDim:t.zDim,timeDim:t.timeDim,drawMode:t.drawMode,opacityInterval:t.opacityInterval,useGradientOpacity:t.useGradientOpacity,gradientOpacityValue:t.gradientOpacityValue,gradientOpacity:t.gradientOpacity,openLight:t.openLight,showClipPlane:t.showClipPlane,clipX:t.clipX,clipY:t.clipY,clipRotate:t.clipRotate,addClipPlane:t.addClipPlane,removeClipPlane:t.removeClipPlane,xOffset:t.xOffset,yOffset:t.yOffset,zOffset:t.zOffset,contourValue:t.contourValue,zScale:t.zScale,colorInterval:t.colorInterval,timeOrder:t.timeOrder,startRender:t.startRender,contourRange:t.contourRange,timeRange:t.timeRange,clear:t.clear}}},Nh={id:"volume-panel",class:"sm-panel"},Ch={class:"sm-function-module-sub-section",style:{margin:"0"}},Mh={class:"sm-half-L"},xh={style:{width:"auto"}},Rh=e.createTextVNode(" 数据加载 "),kh={style:{width:"auto"}},Lh=e.createTextVNode(" 数据操作 "),Ph={class:"sm-half-L"},Bh=e.createVNode("label",{style:{width:"auto"}},"数据加载中···",-1),Th={style:{width:"100%"}},Eh={class:"sm-half-L"},Ah=e.createVNode("label",{style:{width:"30%"}},"数据名称",-1),Ih={class:"sm-half-L"},Fh=e.createVNode("label",{style:{width:"30%"}},"X轴方向",-1),Uh={class:"sm-half-L"},_h=e.createVNode("label",{style:{width:"30%"}},"Y轴方向",-1),Oh={class:"sm-half-L"},Hh=e.createVNode("label",{style:{width:"30%"}},"Z轴方向",-1),zh={class:"sm-half-L"},Gh=e.createVNode("label",{style:{width:"30%"}},"时间纬度",-1),jh={class:"boxchild",style:{"padding-bottom":"0"}},Wh={style:{width:"100%"}},Kh={class:"sm-half-L"},Qh=e.createVNode("label",{style:{width:"38%"}},"绘制模式",-1),Xh=e.createVNode("option",{value:"volume"},"数值模式",-1),Yh=e.createVNode("option",{value:"slice"},"剖切模式",-1),Zh=e.createVNode("option",{value:"gradient"},"等值面模式",-1),qh={style:{width:"100%"}},Jh={class:"sm-half-L"},$h={style:{width:"auto"}},ey=e.createTextVNode("使用梯度透明度 "),ty={class:"sm-half-L"},oy=e.createVNode("label",{style:{width:"40%"}},"梯度作用域",-1),iy={class:"sm-half-L"},ny=e.createVNode("label",{style:{width:"40%"}},"梯度透明度",-1),ry={class:"sm-half-L"},ay=e.createVNode("label",{style:{width:"40%"}},"透明范围",-1),ly={style:{width:"100%"}},sy={class:"sm-half-L"},cy=e.createVNode("label",{style:{width:"40%"}},"沿X轴偏移",-1),dy={class:"sm-half-L"},uy=e.createVNode("label",{style:{width:"40%"}},"沿Y轴偏移",-1),py={class:"sm-half-L"},my=e.createVNode("label",{style:{width:"40%"}},"沿Z轴偏移",-1),hy={class:"sm-half-L"},yy=e.createVNode("label",{style:{width:"40%"}},"等值面",-1),fy={class:"sm-half-L"},vy=e.createVNode("label",{style:{width:"40%"}},"沿Z轴缩放",-1),wy={class:"sm-half-L"},gy=e.createVNode("label",{style:{width:"40%"}},"颜色范围",-1),by={class:"sm-half-L"},Sy=e.createVNode("label",{style:{width:"40%"}},"时间序列",-1),Vy={class:"sm-half-L"},Dy=e.createVNode("label",{style:{width:"40%"}},"裁剪面X方向",-1),Ny={class:"sm-half-L"},Cy=e.createVNode("label",{style:{width:"40%"}},"裁剪面Y方向",-1),My={class:"sm-half-L"},xy=e.createVNode("label",{style:{width:"40%"}},"裁剪面旋转",-1),Ry={class:"sm-half-L"},ky={style:{width:"auto"}},Ly=e.createTextVNode("开启光照 "),Py={class:"boxchild",style:{"padding-bottom":"0"}};Dh.render=function(t,o,i,n,r,a){var l=e.resolveComponent("el-slider"),s=e.resolveDirective("stopdrag"),c=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",Nh,[e.withDirectives(e.createVNode("div",Ch,[e.createVNode("div",Mh,[e.createVNode("label",xh,[e.withDirectives(e.createVNode("input",{type:"radio",value:"addDate","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.operationType=e})},null,512),[[e.vModelRadio,n.operationType]]),Rh]),e.createVNode("label",kh,[e.withDirectives(e.createVNode("input",{type:"radio",value:"operation","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.operationType=e})},null,512),[[e.vModelRadio,n.operationType]]),Lh])]),e.createCommentVNode(" 数据加载 "),e.withDirectives(e.createVNode("div",Ph,[Bh],512),[[e.vShow,!n.variables||0===n.variables.length]]),e.withDirectives(e.createVNode("div",Th,[e.createVNode("div",Eh,[Ah,e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"68%"},"onUpdate:modelValue":o[3]||(o[3]=function(e){return n.selectedDateName=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.variables,(function(t,o){return e.openBlock(),e.createBlock("option",{value:t.name,key:o},e.toDisplayString(t.name),9,["value"])})),128))],512),[[e.vModelSelect,n.selectedDateName]])]),e.createVNode("div",Ih,[Fh,e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"68%"},"onUpdate:modelValue":o[4]||(o[4]=function(e){return n.xDim=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.dimensions,(function(t,o){return e.openBlock(),e.createBlock("option",{value:t.name,key:o},e.toDisplayString(t.name+":"+t.size),9,["value"])})),128))],512),[[e.vModelSelect,n.xDim]])]),e.createVNode("div",Uh,[_h,e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"68%"},"onUpdate:modelValue":o[5]||(o[5]=function(e){return n.yDim=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.dimensions,(function(t,o){return e.openBlock(),e.createBlock("option",{value:t.name,key:o},e.toDisplayString(t.name+":"+t.size),9,["value"])})),128))],512),[[e.vModelSelect,n.yDim]])]),e.createVNode("div",Oh,[Hh,e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"68%"},"onUpdate:modelValue":o[6]||(o[6]=function(e){return n.zDim=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.dimensions,(function(t,o){return e.openBlock(),e.createBlock("option",{value:t.name,key:o},e.toDisplayString(t.name+":"+t.size),9,["value"])})),128))],512),[[e.vModelSelect,n.zDim]])]),e.createVNode("div",zh,[Gh,e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"68%"},"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.timeDim=e})},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.dimensions,(function(t,o){return e.openBlock(),e.createBlock("option",{value:t.name,key:o},e.toDisplayString(t.name+":"+t.size),9,["value"])})),128))],512),[[e.vModelSelect,n.timeDim]])]),e.createVNode("div",jh,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[8]||(o[8]=function(){return n.startRender&&n.startRender.apply(n,arguments)})},"加载"),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button",onClick:o[9]||(o[9]=function(){return n.clear&&n.clear.apply(n,arguments)})},"清除")])],512),[[e.vShow,"addDate"===n.operationType&&n.variables.length>0]]),e.createCommentVNode(" 操作模式 "),e.withDirectives(e.createVNode("div",Wh,[e.createVNode("div",Kh,[Qh,e.withDirectives(e.createVNode("select",{class:"sm-select-m",style:{width:"60%"},"onUpdate:modelValue":o[10]||(o[10]=function(e){return n.drawMode=e})},[Xh,Yh,Zh],512),[[e.vModelSelect,n.drawMode]])]),e.createCommentVNode(" 数值模式 "),e.withDirectives(e.createVNode("div",qh,[e.createVNode("div",Jh,[e.createVNode("label",$h,[e.withDirectives(e.createVNode("input",{checked:"",type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=function(e){return n.useGradientOpacity=e})},null,512),[[e.vModelCheckbox,n.useGradientOpacity]]),ey])]),e.withDirectives(e.createVNode("div",ty,[oy,e.createVNode(l,{modelValue:n.gradientOpacityValue,"onUpdate:modelValue":o[12]||(o[12]=function(e){return n.gradientOpacityValue=e}),min:0,max:1,range:"",step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])],512),[[e.vShow,n.useGradientOpacity]]),e.withDirectives(e.createVNode("div",iy,[ny,e.createVNode(l,{modelValue:n.gradientOpacity,"onUpdate:modelValue":o[13]||(o[13]=function(e){return n.gradientOpacity=e}),min:0,max:1,range:"",step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])],512),[[e.vShow,n.useGradientOpacity]]),e.createVNode("div",ry,[ay,e.createVNode(l,{modelValue:n.opacityInterval,"onUpdate:modelValue":o[14]||(o[14]=function(e){return n.opacityInterval=e}),min:0,max:1,range:"",step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])])],512),[[e.vShow,"volume"===n.drawMode]]),e.createCommentVNode(" 剖切模式 "),e.withDirectives(e.createVNode("div",ly,[e.createVNode("div",sy,[cy,e.createVNode(l,{modelValue:n.xOffset,"onUpdate:modelValue":o[15]||(o[15]=function(e){return n.xOffset=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])]),e.createVNode("div",dy,[uy,e.createVNode(l,{modelValue:n.yOffset,"onUpdate:modelValue":o[16]||(o[16]=function(e){return n.yOffset=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])]),e.createVNode("div",py,[my,e.createVNode(l,{modelValue:n.zOffset,"onUpdate:modelValue":o[17]||(o[17]=function(e){return n.zOffset=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])])],512),[[e.vShow,"slice"===n.drawMode]]),e.createCommentVNode(" 等值面 "),e.withDirectives(e.createVNode("div",hy,[yy,e.createVNode(l,{modelValue:n.contourValue,"onUpdate:modelValue":o[18]||(o[18]=function(e){return n.contourValue=e}),min:n.contourRange[0],max:n.contourRange[1],step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","min","max"])],512),[[e.vShow,"gradient"===n.drawMode]]),e.createCommentVNode(" 公共部分 "),e.withDirectives(e.createVNode("div",fy,[vy,e.createVNode(l,{modelValue:n.zScale,"onUpdate:modelValue":o[19]||(o[19]=function(e){return n.zScale=e}),min:1,step:.1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])],512),[[e.vShow,"gradient"!==n.drawMode]]),e.withDirectives(e.createVNode("div",wy,[gy,e.createVNode(l,{modelValue:n.colorInterval,"onUpdate:modelValue":o[20]||(o[20]=function(e){return n.colorInterval=e}),min:0,max:1,range:"",step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])],512),[[e.vShow,"gradient"!==n.drawMode]]),e.createVNode("div",by,[Sy,e.createVNode(l,{modelValue:n.timeOrder,"onUpdate:modelValue":o[21]||(o[21]=function(e){return n.timeOrder=e}),min:0,max:n.timeRange[1],"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","max"])]),e.withDirectives(e.createVNode("div",Vy,[Dy,e.createVNode(l,{modelValue:n.clipX,"onUpdate:modelValue":o[22]||(o[22]=function(e){return n.clipX=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])],512),[[e.vShow,n.showClipPlane]]),e.withDirectives(e.createVNode("div",Ny,[Cy,e.createVNode(l,{modelValue:n.clipY,"onUpdate:modelValue":o[23]||(o[23]=function(e){return n.clipY=e}),min:0,max:1,step:.01,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue","step"])],512),[[e.vShow,n.showClipPlane]]),e.withDirectives(e.createVNode("div",My,[xy,e.createVNode(l,{modelValue:n.clipRotate,"onUpdate:modelValue":o[24]||(o[24]=function(e){return n.clipRotate=e}),min:-180,max:180,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"58%"}},null,8,["modelValue"])],512),[[e.vShow,n.showClipPlane]]),e.createVNode("div",Ry,[e.createVNode("label",ky,[e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":o[25]||(o[25]=function(e){return n.openLight=e})},null,512),[[e.vModelCheckbox,n.openLight]]),Ly])]),e.withDirectives(e.createVNode("div",Py,[e.createVNode("button",{class:"tbtn",type:"button",onClick:o[26]||(o[26]=function(){return n.addClipPlane&&n.addClipPlane.apply(n,arguments)}),style:{width:"auto"}},"添加裁剪面"),e.createVNode("button",{class:"tbtn tbtn-margin-left",type:"button",style:{width:"auto"},onClick:o[27]||(o[27]=function(){return n.removeClipPlane&&n.removeClipPlane.apply(n,arguments)})},"移除裁剪面")],512),[[e.vShow,"volume"===n.drawMode]])],512),[[e.vShow,"operation"===n.operationType]])],512),[[s]])],512)),[[c]])},Dh.__file="src/components/scene/volume-render/volume-render.vue",Dh.install=function(e){e.component(Dh.name,Dh)};var By={class:"sm-function-module-sub-section",style:{margin:"0"}},Ty={class:"sm-half-L "},Ey={style:{width:"35%"}},Ay={class:"sm-half-L"},Iy={style:{width:"35%"}},Fy={class:"sm-half-L"},Uy={style:{width:"35%"}},_y={class:"sm-half-L"},Oy={style:{width:"35%"}},Hy={class:"boxchild"},zy={expose:[],setup:function(t){var o,i,n=viewer.scene,r=e.reactive({selectedType:"NONE",selectedId:0,showEditCheck:!0,emitRate:50,lifeRange:[.005,.25],speedRange:[1,10],scaleRange:[1,10],gravity:0}),a=new SuperMap3D.Matrix4;function l(){(i=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas)).setInputAction((function(e){var t,r=viewer.scene.pickPosition(e.position);SuperMap3D.Transforms.eastNorthUpToFixedFrame(r,void 0,a),t="public/data/particle/Fire.json",SuperMap3D.ParticleHelper.fromJsonUrl(t,n).then((function(e){(o=e).modelMatrix=a})),i.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}function s(){SuperMap3D.defaultValue(o)&&n.primitives.remove(o)}return e.watch((function(){return r.emitRate}),(function(e){o&&(o.emitRate=Number(e))})),e.watch((function(){return r.lifeRange}),(function(e){e.length>1&&(o.minLifeTime=Number(e[0]),o.maxLifeTime=Number(e[1]))})),e.watch((function(){return r.speedRange}),(function(e){e.length>1&&(o.minEmitPower=Number(e[0]),o.maxEmitPower=Number(e[1]))})),e.watch((function(){return r.scaleRange}),(function(e){e.length>1&&(o.minSize=Number(e[0]),o.maxSize=Number(e[1]))})),e.onBeforeUnmount((function(){s()})),function(t,o){var i=e.resolveComponent("el-slider"),n=e.resolveDirective("stopdrag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",By,[e.createCommentVNode(" 参数设置 "),e.createVNode("div",Ty,[e.createVNode("label",Ey,e.toDisplayString(t.Resource.emitSpeed),1),e.createVNode(i,{modelValue:e.unref(r).emitRate,"onUpdate:modelValue":o[1]||(o[1]=function(t){return e.unref(r).emitRate=t}),min:1,max:2500,step:20,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",Ay,[e.createVNode("label",Iy,e.toDisplayString(t.Resource.lifeCycle),1),e.createVNode(i,{modelValue:e.unref(r).lifeRange,"onUpdate:modelValue":o[2]||(o[2]=function(t){return e.unref(r).lifeRange=t}),step:.001,range:"",min:.005,max:.25,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step","min","max"])]),e.createVNode("div",Fy,[e.createVNode("label",Uy,e.toDisplayString(t.Resource.speedRange),1),e.createVNode(i,{modelValue:e.unref(r).speedRange,"onUpdate:modelValue":o[3]||(o[3]=function(t){return e.unref(r).speedRange=t}),step:1,range:"",min:1,max:100,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",_y,[e.createVNode("label",Oy,e.toDisplayString(t.Resource.scaleRange),1),e.createVNode(i,{modelValue:e.unref(r).scaleRange,"onUpdate:modelValue":o[4]||(o[4]=function(t){return e.unref(r).scaleRange=t}),step:1,range:"",min:1,max:100,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])])],512),[[n]]),e.createVNode("div",Hy,[e.createVNode("button",{type:"button",class:"tbtn",onClick:l},e.toDisplayString(t.Resource.addParticle),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:s},e.toDisplayString(t.Resource.clearParticle),1)])],64)}},__file:"src/components/special-effects/particle-system/coms/fire.vue"},Gy={class:"sm-function-module-sub-section",style:{margin:"0"}},jy={class:"sm-half-L"},Wy=e.createVNode("label",{class:"label-S"},"发射类型",-1),Ky={selected:"",value:"Cone"},Qy={value:"Sphere"},Xy={value:"Box"},Yy={class:"sm-half-L "},Zy={style:{width:"35%"}},qy={class:"sm-half-L "},Jy={style:{width:"35%"}},$y={class:"sm-half-L "},ef={style:{width:"35%"}},tf={class:"sm-half-L "},of={style:{width:"35%"}},nf={class:"sm-half-L "},rf={style:{width:"35%"}},af={class:"sm-half-L "},lf={style:{width:"35%"}},sf={class:"boxchild"},cf={expose:[],setup:function(t){var o,i,n=viewer.scene,r=e.reactive({selectedType:"Cone",selectedId:0,showEditCheck:!0,setParam:!1,emitRate:1500,particleSize:1,lifeRange:[1,4],speedRange:[6,7],scaleRange:[1,4],gravity:-8}),a=new SuperMap3D.Matrix4;function l(){(i=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas)).setInputAction((function(e){var t,r=viewer.scene.pickPosition(e.position);SuperMap3D.Transforms.eastNorthUpToFixedFrame(r,void 0,a),t="public/data/particle/fountain.json",SuperMap3D.ParticleHelper.fromJsonUrl(t,n).then((function(e){(o=e).modelMatrix=a,o.start()})),i.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}function s(){SuperMap3D.defaultValue(o)&&n.primitives.remove(o)}return e.watch((function(){return r.selectedType}),(function(e){if(o)switch(e){case"Cone":o.createConeEmitter(1,1.05);break;case"Sphere":o.createSphereEmitter(1);break;case"Box":var t=new SuperMap3D.Cartesian3(-1,1,1),i=new SuperMap3D.Cartesian3(1,1,-1),n=new SuperMap3D.Cartesian3(-10,0,-10),r=new SuperMap3D.Cartesian3(10,0,10);o.createBoxEmitter(t,i,n,r)}})),e.watch((function(){return r.emitRate}),(function(e){o&&(o.emitRate=Number(e))})),e.watch((function(){return r.particleSize}),(function(e){o&&(o.minScaleX=Number(e),o.minScaleY=Number(e),o.maxScaleX=Number(e),o.maxScaleY=Number(e))})),e.watch((function(){return r.lifeRange}),(function(e){o&&e.length>1&&(o.minLifeTime=Number(e[0]),o.maxLifeTime=Number(e[1]))})),e.watch((function(){return r.speedRange}),(function(e){o&&e.length>1&&(o.minEmitPower=Number(e[0]),o.maxEmitPower=Number(e[1]))})),e.watch((function(){return r.scaleRange}),(function(e){o&&e.length>1&&(o.minSize=Number(e[0]),o.maxSize=Number(e[1]))})),e.watch((function(){return r.gravity}),(function(e){o&&(o.gravity=new SuperMap3D.Cartesian3(0,0,Number(e)))})),e.onBeforeUnmount((function(){s()})),function(t,o){var i=e.resolveComponent("el-slider"),n=e.resolveDirective("stopdrag");return e.openBlock(),e.createBlock(e.Fragment,null,[e.withDirectives(e.createVNode("div",Gy,[e.createVNode("div",jy,[Wy,e.withDirectives(e.createVNode("select",{class:"sm-select-m","onUpdate:modelValue":o[1]||(o[1]=function(t){return e.unref(r).selectedType=t})},[e.createVNode("option",Ky,e.toDisplayString(t.Resource.coneEmit),1),e.createVNode("option",Qy,e.toDisplayString(t.Resource.sphereEmit),1),e.createVNode("option",Xy,e.toDisplayString(t.Resource.boxEmit),1)],512),[[e.vModelSelect,e.unref(r).selectedType]])]),e.createVNode("div",Yy,[e.createVNode("label",Zy,e.toDisplayString(t.Resource.particleNumber),1),e.createVNode(i,{modelValue:e.unref(r).emitRate,"onUpdate:modelValue":o[2]||(o[2]=function(t){return e.unref(r).emitRate=t}),min:1,max:2500,step:20,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",qy,[e.createVNode("label",Jy,e.toDisplayString(t.Resource.particleSize),1),e.createVNode(i,{modelValue:e.unref(r).particleSize,"onUpdate:modelValue":o[3]||(o[3]=function(t){return e.unref(r).particleSize=t}),min:1,max:60,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",$y,[e.createVNode("label",ef,e.toDisplayString(t.Resource.lifeCycle),1),e.createVNode(i,{modelValue:e.unref(r).lifeRange,"onUpdate:modelValue":o[4]||(o[4]=function(t){return e.unref(r).lifeRange=t}),step:1,range:"",min:.1,max:30,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","min"])]),e.createVNode("div",tf,[e.createVNode("label",of,e.toDisplayString(t.Resource.speedRange),1),e.createVNode(i,{modelValue:e.unref(r).speedRange,"onUpdate:modelValue":o[5]||(o[5]=function(t){return e.unref(r).speedRange=t}),step:1,range:"",min:1,max:30,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",nf,[e.createVNode("label",rf,e.toDisplayString(t.Resource.scaleRange),1),e.createVNode(i,{modelValue:e.unref(r).scaleRange,"onUpdate:modelValue":o[6]||(o[6]=function(t){return e.unref(r).scaleRange=t}),step:1,range:"",min:1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),e.createVNode("div",af,[e.createVNode("label",lf,e.toDisplayString(t.Resource.gravity),1),e.createVNode(i,{modelValue:e.unref(r).gravity,"onUpdate:modelValue":o[7]||(o[7]=function(t){return e.unref(r).gravity=t}),step:1,min:-20,max:20,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])])],512),[[n]]),e.createVNode("div",sf,[e.createVNode("button",{type:"button",class:"tbtn",onClick:l},e.toDisplayString(t.Resource.addParticle),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:s},e.toDisplayString(t.Resource.clearParticle),1)])],64)}},__file:"src/components/special-effects/particle-system/coms/water.vue"},df={class:"boxchild"},uf={expose:[],setup:function(t){var o,i=viewer.scene,n=new SuperMap3D.Matrix4,r=[];i.skyAtmosphere=new SuperMap3D.SkyAtmosphere,i.globe.show=!1,i.skyAtmosphere.show=!1;var a=-2100;function l(){for(var e=function(e){var t=SuperMap3D.Math.randomBetween(a+300*e,a+300*(e+1)),o=SuperMap3D.Math.randomBetween(0,2e3),l=SuperMap3D.Math.randomBetween(150,550),s=new SuperMap3D.Cartesian3(t,o,l),c="";e%4==0&&(c="public/data/particle/babylon/sparkGravityOne.json"),e%4==1&&(c="public/data/particle/babylon/sparkGravityTwo.json"),e%4==2&&(c="public/data/particle/babylon/sparkGravityThree.json"),e%4==3&&(c="public/data/particle/babylon/sparkGravityFour.json"),SuperMap3D.ParticleHelper.fromJsonUrl(c,i).then((function(t){!function(e,t,o){e.modelMatrix=n,e.worldOffset.x=t.x,e.worldOffset.y=t.y,e.worldOffset.z=t.z;var a=setInterval((function(){e.start()}),2e3+50*o);i.primitives.add(e),r.push(a)}(t,s,e)}))},t=0;t<8;++t)e(t)}function s(){i.globe.show=!1,i.skyAtmosphere.show=!1,(o=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas)).setInputAction((function(e){var t=viewer.scene.pickPosition(e.position);SuperMap3D.Transforms.eastNorthUpToFixedFrame(t,void 0,n),l(),o.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}function c(){i.globe.show=!0,i.skyAtmosphere.show=!0,r.length>0&&(r.forEach((function(e){clearInterval(e)})),r=[])}return e.onBeforeUnmount((function(){c()})),function(t,o){return e.openBlock(),e.createBlock("div",df,[e.createVNode("button",{type:"button",class:"tbtn",onClick:s},e.toDisplayString(t.Resource.addParticle),1),e.createVNode("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:c},e.toDisplayString(t.Resource.clearParticle),1)])}},__file:"src/components/special-effects/particle-system/coms/fireworks.vue"},pf={name:"Sm3dParticleSystem",props:{},data:function(){return{}},setup:function(t){var o=function(t){var o=e.reactive({particles:[{id:0,iconfont:"iconhuoyan",particleName:"火焰"},{id:1,iconfont:"iconshui",particleName:"水"},{id:2,iconfont:"iconyanhua",particleName:"烟花"}],particleSelectedId:0});if(t)for(var i in t)o.hasOwnProperty(i)?null!=t[i]&&(o[i]=t[i]):ae.Message.errorMsg(te.AttributeError+i);return e.onBeforeUnmount((function(){})),u({},e.toRefs(o))}(t);return{particles:o.particles,particleSelectedId:o.particleSelectedId,Fire:zy,Water:cf,FireWorks:uf}}},mf={id:"scan-effect-panel",class:"sm-panel"},hf={class:"sm-function-module-sub-section",style:{margin:"0"}},yf={class:"sm-half-L symbolic"},ff={style:{width:"100%"}},vf={key:0},wf={key:1},gf={key:2};pf.render=function(t,o,i,n,r,a){var l=e.resolveDirective("stopdrag"),s=e.resolveDirective("drag");return e.withDirectives((e.openBlock(),e.createBlock("div",mf,[e.withDirectives(e.createVNode("div",hf,[e.createVNode("div",yf,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(n.particles,(function(t){return e.openBlock(),e.createBlock("div",{key:t.id,class:["symbolic-box",{"theme-color":t.id===n.particleSelectedId}],onClick:function(e){return n.particleSelectedId=t.id}},[e.createVNode("span",{class:["iconfont",t.iconfont]},null,2),e.createVNode("label",ff,e.toDisplayString(t.particleName),1)],10,["onClick"])})),128))]),0===n.particleSelectedId?(e.openBlock(),e.createBlock("div",vf,[e.createVNode(n.Fire)])):e.createCommentVNode("v-if",!0),1===n.particleSelectedId?(e.openBlock(),e.createBlock("div",wf,[e.createVNode(n.Water)])):e.createCommentVNode("v-if",!0),2===n.particleSelectedId?(e.openBlock(),e.createBlock("div",gf,[e.createVNode(n.FireWorks)])):e.createCommentVNode("v-if",!0)],512),[[l]])],512)),[[s]])},pf.__file="src/components/special-effects/particle-system/particle-system.vue",pf.install=function(e){e.component(pf.name,pf)};var bf=[oe,fe,ke,He,ot,mt,bt,qt,Rt,uo,ko,$o,Ti,rn,hn,Ln,or,gr,Fr,na,fa,Va,rl,El,us,Jd,Cs,Fs,Qs,hc,Qc,sd,fd,su,yp,Ap,um,Em,Km,Dh,pf],Sf=function e(t,o){window.Resource=F,t.config.globalProperties.Resource=F,function(e,t){e.directive("drag",{beforeMount:function(e,t){var o,i,n,r,a,l,s=!1,c=e;c.addEventListener("touchstart",(function(e){if(s=!0,e.changedTouches[0]){var t=e.changedTouches[0],o=t.clientX,i=t.clientY;n=o-e.changedTouches[0].target.x,r=i-e.changedTouches[0].target.y,a=document.body.clientWidth,l=document.body.clientHeight}}),{passive:!1}),c.addEventListener("touchmove",T((function(t){t.preventDefault(),o=t.changedTouches[0].clientX-n,i=t.changedTouches[0].clientY-r,o<0&&i<0?(e.style.left="0px",e.style.top="0px"):o<0&&i+e.clientHeight<l?(e.style.left="0px",e.style.top=i+"px"):o<0&&i+e.clientHeight>=l?(e.style.left="0px",e.style.top=l-e.clientHeight+"px"):o+e.clientWidth>a&&i<0?(e.style.left=a-e.clientWidth+"px",e.style.top="0px"):o+e.clientWidth<a&&i+e.clientHeight>=l?(e.style.left=o+"px",e.style.top=l-e.clientHeight+"px"):o+e.clientWidth<a&&i<0?(e.style.left=o+"px",e.style.top="0px"):o+e.clientWidth>a&&i+e.clientHeight<l?(e.style.left=a-e.clientWidth+"px",e.style.top=i+"px"):o+e.clientWidth>a&&i+e.clientHeight>=l?(e.style.left=a-e.clientWidth+"px",e.style.top=l-e.clientHeight+"px"):(e.style.left=o+"px",e.style.top=i+"px")}),5),{passive:!1}),c.addEventListener("touchend",(function(e){s=!1,document.ontouchmove=null,document.ontouchmove=null,e.changedTouches[0].clientX,e.changedTouches[0].clientY}),{passive:!1}),c.onmousedown=function(t){if(a=document.body.clientWidth,l=document.body.clientHeight,!s){s=!0;var n=t.clientX,r=t.clientY,c=n-e.offsetLeft,d=r-e.offsetTop;document.onmousemove=T((function(t){o=t.clientX-c,i=t.clientY-d,o<0&&i<0?(e.style.left="0px",e.style.top="0px"):o<0&&i+e.clientHeight<l?(e.style.left="0px",e.style.top=i+"px"):o<0&&i+e.clientHeight>=l?(e.style.left="0px",e.style.top=l-e.clientHeight+"px"):o+e.clientWidth>a&&i<0?(e.style.left=a-e.clientWidth+"px",e.style.top="0px"):o+e.clientWidth<a&&i+e.clientHeight>=l?(e.style.left=o+"px",e.style.top=l-e.clientHeight+"px"):o+e.clientWidth<a&&i<0?(e.style.left=o+"px",e.style.top="0px"):o+e.clientWidth>a&&i+e.clientHeight<l?(e.style.left=a-e.clientWidth+"px",e.style.top=i+"px"):o+e.clientWidth>a&&i+e.clientHeight>=l?(e.style.left=a-e.clientWidth+"px",e.style.top=l-e.clientHeight+"px"):(e.style.left=o+"px",e.style.top=i+"px")}),5),document.onmouseup=function(e){document.onmousedown=null,document.onmousemove=null,s=!1}}}}}),e.directive("stopdrag",{beforeMount:function(e,t){e.onmousedown=function(e){"el-input__inner"!=e.target.className&&e.stopPropagation()}}})}(t),o&&(t.config.globalProperties.Resource=o),e.installed||(e.installed=!0,bf.forEach((function(e){t.use(e)})))};return window.store=n,"undefined"!=typeof window&&window.Vue&&(window.webgl3d=Sf),{install:Sf,components:bf}}));
