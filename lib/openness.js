import{reactive as e,toRefs as o,watch as t,onBeforeUnmount as i,pushScopeId as n,popScopeId as r,resolveComponent as s,resolveDirective as l,withDirectives as a,openBlock as u,createBlock as d,createVNode as p,toDisplayString as c,createCommentVNode as m,vModelSelect as v,vModelCheckbox as g,createTextVNode as w,withScopeId as f}from"vue";function h(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function b(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);o&&(i=i.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,i)}return t}function y(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?b(Object(t),!0).forEach((function(o){h(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}var C,A,D={errorMsg:function(e){console.log("error",e),alert("error："+e)},warnMsg:function(e){console.log("warn",e)},successMsg:function(e){console.log("success",e)}},S=function(e){for(var o=[].concat(e),t=[],i=0,n=o.length;i<n;i++){var r=SuperMap3D.Cartographic.fromCartesian(o[i]),s=SuperMap3D.Math.toDegrees(r.longitude),l=SuperMap3D.Math.toDegrees(r.latitude),a=r.height;-1==t.indexOf(s)&&-1==t.indexOf(l)&&(t.push(s),t.push(l),t.push(a))}return t},M={showRenderLoopErrors:"渲染时发生错误，已停止渲染。",AttributeError:"该组件props没有这个属性：",NoPickPositionSupported:"不支持深度纹理,无法绘制多边形，地形操作功能无法使用！",NoTerrain:"请在地形里使用地形组件！",initViewerWarn:"请先初始化viewer!",MoveMouseHeightBox:"点击鼠标左键结束矩形绘制，移动鼠标绘制box高度",RightClickEndDrawing:"右键单击结束绘制",LeftClickBottomBox:"点击鼠标左键，开始绘制矩形作为box底面",ClickModelAddBox:"点击模型，添加裁剪盒子",SkyLineWarn:"获取天际线体前，请先绘制天际线！",SkyLineBody:"天际线体",ShadowqueryWarn:"此操作需要先开启阴影！",VeiwshedBody:"可视体",VeiwshedBodyHidden:"不可视体",EchartsErr:"二维显示需要echarts支持，未找到相关依赖！",BaseMapImg:"底图",tip1:"<p>点击左键确定操作区域中间点</p><p>右键单击结束绘制</p>"},V=(A=(navigator.language||navigator.browserLanguage).toLowerCase(),window.lang=A,A).toLowerCase();var L=((C=void 0!==V?V:(navigator.language||navigator.browserLanguage).toLowerCase()).startsWith("zh")||C.startsWith("ja"),M),P=e({isViewer:!1,changeLayers:0,changeGeometrys:0});function O(e){var o=function(e){var o=document.createElement("DIV");o.className="tooltip",this._div=o,this.message="",e.appendChild(o)};return o.prototype.setVisible=function(e){this._div.style.right=e?"10px":"-300px"},o.prototype.showAt=function(e,o){o&&(this._div.style.top=o),e&&(this.setVisible(!0),this._div.innerHTML=e)},new o(e)}function E(n){var r=e({addHeight:1,viewPosition:null,viewDomeRadius:100,domeType:"ALLDOME",isClosed:!1,visibleAreaColor:"rgba(9,199,112,0.5)",hiddenAreaColor:"rgba(238,114,22,0.5)",startAngle:0,endAngle:360});if(n)for(var s in n)r.hasOwnProperty(s)?r[s]=n[s]:D.errorMsg(L.AttributeError+s);var l,a,u,d=!0;function p(){l=viewer.scene,(a=new SuperMap3D.ViewDome(l)).viewPosition=[0,0,0],a.distance=Number(r.viewDomeRadius),a.domeType=SuperMap3D.ViewDomeType[r.domeType],a.visibleAreaColor=SuperMap3D.Color.fromCssColorString(r.visibleAreaColor),a.hiddenAreaColor=SuperMap3D.Color.fromCssColorString(r.hiddenAreaColor),a.startAngle=Number(r.startAngle),a.endAngle=Number(r.endAngle),a.isClosed=r.isClosed,a.build()}function c(e){viewer.enableCursorStyle=!0,document.body.classList.remove("measureCur");var o=l.pickPosition(e.message.position),t=S(o);t[2]+=Number(r.addHeight),r.viewPosition={longitude:t[0].toFixed(6),latitude:t[1].toFixed(6),height:t[2].toFixed(2)},a.viewPosition=t,a.build(),window.tooltip.setVisible(!1),viewer.eventManager.removeEventListener("CLICK",c),viewer.eventManager.removeEventListener("MOUSE_MOVE",m),a.startAngle=Number(r.startAngle)}function m(e){u=l.pickPosition(e.message.endPosition)}function v(){viewer.entities.removeById("opennessPoint"),document.body.classList.remove("measureCur"),window.tooltip.setVisible(!1),r.viewPosition=null,a.viewPosition=[0,0,0],a.startAngle=Number(r.startAngle)}return P.isViewer&&(window.tooltip||(window.tooltip=O(viewer._element)),p()),t((function(){return P.isViewer}),(function(e){e&&(window.tooltip||(window.tooltip=O(viewer._element)),p())})),t((function(){return r.viewDomeRadius}),(function(e){""!=e&&(a.distance=Number(e))})),t((function(){return r.domeType}),(function(e){""!=e&&(a.domeType=SuperMap3D.ViewDomeType[e])})),t((function(){return r.isClosed}),(function(e){""!=e&&(a.isClosed=e)})),t((function(){return r.startAngle}),(function(e){""!=e&&(a.startAngle=Number(e))})),t((function(){return r.endAngle}),(function(e){""!=e&&(a.endAngle=Number(e))})),t((function(){return r.visibleAreaColor}),(function(e){if(""!=e){var o=SuperMap3D.Color.fromCssColorString(e);a.visibleAreaColor=o}})),t((function(){return r.hiddenAreaColor}),(function(e){if(""!=e){var o=SuperMap3D.Color.fromCssColorString(e);a.hiddenAreaColor=o}})),t((function(){return r.addHeight}),(function(e,o){var t=e-o;t=SuperMap3D.defaultValue(t,0),a.viewPosition[2]+=Number(t),u=SuperMap3D.Cartesian3.fromDegrees(a.viewPosition[0],a.viewPosition[1],a.viewPosition[2]),a.startAngle=Number(r.startAngle)})),i((function(){v(),a.destroy(),a=void 0})),y(y({},o(r)),{},{analysis:function(){viewer.enableCursorStyle=!1,viewer._element.style.cursor="",document.body.classList.add("measureCur"),d&&(window.tooltip.showAt(" <p>点击鼠标左键确认分析位置</p>","250px"),d=!1),viewer.entities.removeById("opennessPoint"),viewer.entities.add(new SuperMap3D.Entity({id:"opennessPoint",point:new SuperMap3D.PointGraphics({color:SuperMap3D.Color.fromCssColorString("rgba(238,114,22,1)"),pixelSize:8}),position:new SuperMap3D.CallbackProperty((function(){return u}),!1)})),viewer.eventManager.addEventListener("CLICK",c,!0),viewer.eventManager.addEventListener("MOUSE_MOVE",m,!0)},clear:v})}var R={name:"Sm3dOpenness",props:{addHeight:{type:Number},viewPosition:{type:Array},viewDomeRadius:{type:Number},domeType:{type:String},isClosed:{type:Boolean},visibleAreaColor:{type:String},hiddenAreaColor:{type:String},startAngle:{type:Number},endAngle:{type:Number}},methods:{formatTooltip:function(e){return e+"米"}},setup:function(e){var o=E(e);return{addHeight:o.addHeight,viewDomeRadius:o.viewDomeRadius,domeType:o.domeType,isClosed:o.isClosed,visibleAreaColor:o.visibleAreaColor,hiddenAreaColor:o.hiddenAreaColor,startAngle:o.startAngle,endAngle:o.endAngle,analysis:o.analysis,clear:o.clear}}},x=f("data-v-8f58fc18");n("data-v-8f58fc18");var N={id:"openness-panel",class:"sm-panel"},T={class:"sm-function-module-sub-section",style:{margin:"0"}},k={class:"sm-half-L"},_={style:{width:"35%"}},j={class:"sm-half-L"},B={style:{width:"35%"}},H={class:"sm-half-L"},I={style:{width:"35%"}},U={class:"sm-half-L"},z={style:{width:"35%"}},W={class:"sm-half-L"},F={style:{width:"35%"}},G={class:"sm-half-L"},K={style:{width:"35%"}},q={class:"sm-half-L"},J={style:{width:"35%"}},Q={value:"ALLDOME"},X={value:"VISIBLEDOME"},Y={value:"HIDDENDOME"},Z={class:"sm-half-L"},$={style:{width:"auto"}},ee={class:"boxchild"};r();var oe=x((function(e,o,t,i,n,r){var f=s("el-slider"),h=s("el-color-picker"),b=l("stopdrag"),y=l("drag");return a((u(),d("div",N,[a(p("div",T,[p("div",k,[p("label",_,c(e.Resource.addheight),1),p(f,{modelValue:i.addHeight,"onUpdate:modelValue":o[1]||(o[1]=function(e){return i.addHeight=e}),min:0,step:.1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step"])]),p("div",j,[p("label",B,c(e.Resource.startAngle),1),p(f,{modelValue:i.startAngle,"onUpdate:modelValue":o[2]||(o[2]=function(e){return i.startAngle=e}),min:0,max:360,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),p("div",H,[p("label",I,c(e.Resource.endAngle),1),p(f,{modelValue:i.endAngle,"onUpdate:modelValue":o[3]||(o[3]=function(e){return i.endAngle=e}),min:0,max:360,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),p("div",U,[p("label",z,c(e.Resource.observeRadius),1),p(f,{modelValue:i.viewDomeRadius,"onUpdate:modelValue":o[4]||(o[4]=function(e){return i.viewDomeRadius=e}),min:1,step:1,max:1e3,"input-size":"mini",debounce:500,"format-tooltip":r.formatTooltip,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","format-tooltip"]),m(' <input class="sm-input-S" min="1" step="1" type="number" v-model="clipWidth" /> ')]),p("div",W,[p("label",F,c(e.Resource.visibleAreaColor),1),p(h,{modelValue:i.visibleAreaColor,"onUpdate:modelValue":o[5]||(o[5]=function(e){return i.visibleAreaColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),p("div",G,[p("label",K,c(e.Resource.hiddenAreaColor),1),p(h,{modelValue:i.hiddenAreaColor,"onUpdate:modelValue":o[6]||(o[6]=function(e){return i.hiddenAreaColor=e}),size:"mini","show-alpha":"",style:{width:"63%"}},null,8,["modelValue"])]),p("div",q,[p("label",J,c(e.Resource.displayMode),1),a(p("select",{class:"sm-select",style:{width:"63%"},"onUpdate:modelValue":o[7]||(o[7]=function(e){return i.domeType=e})},[p("option",Q,c(e.Resource.allShow),1),p("option",X,c(e.Resource.visibleShow),1),p("option",Y,c(e.Resource.hiddenShow),1)],512),[[v,i.domeType]])]),p("div",Z,[p("label",$,[a(p("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=function(e){return i.isClosed=e})},null,512),[[g,i.isClosed]]),w(" "+c(e.Resource.isClosed),1)])]),p("div",ee,[p("button",{class:"tbtn",type:"button",onClick:o[9]||(o[9]=function(){return i.analysis&&i.analysis.apply(i,arguments)})},c(e.Resource.analyze),1),p("button",{onClick:o[10]||(o[10]=function(){return i.clear&&i.clear.apply(i,arguments)}),class:"tbtn",style:{"margin-left":"4px"},type:"button"},c(e.Resource.clear),1)])],512),[[b]])],512)),[[y]])}));R.render=oe,R.__scopeId="data-v-8f58fc18",R.__file="src/components/analysis_3d/openness/openness.vue",R.install=function(e){e.component(R.name,R)};export default R;
