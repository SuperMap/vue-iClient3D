import{toRefs as e,reactive as t,onBeforeUnmount as n,watch as a,resolveComponent as i,resolveDirective as r,openBlock as o,createBlock as l,Fragment as s,withDirectives as c,createVNode as u,createCommentVNode as p,toDisplayString as m,unref as d,vModelSelect as f,renderList as b}from"vue";function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var h,g,w={errorMsg:function(e){console.log("error",e),alert("error："+e)},warnMsg:function(e){console.log("warn",e)},successMsg:function(e){console.log("success",e)}},S={showRenderLoopErrors:"渲染时发生错误，已停止渲染。",AttributeError:"该组件props没有这个属性：",NoPickPositionSupported:"不支持深度纹理,无法绘制多边形，地形操作功能无法使用！",NoTerrain:"请在地形里使用地形组件！",initViewerWarn:"请先初始化viewer!",MoveMouseHeightBox:"点击鼠标左键结束矩形绘制，移动鼠标绘制box高度",RightClickEndDrawing:"右键单击结束绘制",LeftClickBottomBox:"点击鼠标左键，开始绘制矩形作为box底面",ClickModelAddBox:"点击模型，添加裁剪盒子",SkyLineWarn:"获取天际线体前，请先绘制天际线！",SkyLineBody:"天际线体",ShadowqueryWarn:"此操作需要先开启阴影！",VeiwshedBody:"可视体",VeiwshedBodyHidden:"不可视体",EchartsErr:"二维显示需要echarts支持，未找到相关依赖！",BaseMapImg:"底图",tip1:"<p>点击左键确定操作区域中间点</p><p>右键单击结束绘制</p>"},R=(g=(navigator.language||navigator.browserLanguage).toLowerCase(),window.lang=g,g).toLowerCase();var x=((h=void 0!==R?R:(navigator.language||navigator.browserLanguage).toLowerCase()).startsWith("zh")||h.startsWith("ja"),S);function M(a){var i=t({particles:[{id:0,iconfont:"iconhuoyan",particleName:"火焰"},{id:1,iconfont:"iconshui",particleName:"水"},{id:2,iconfont:"iconyanhua",particleName:"烟花"}],particleSelectedId:0});if(a)for(var r in a)i.hasOwnProperty(r)?null!=a[r]&&(i[r]=a[r]):w.errorMsg(x.AttributeError+r);return n((function(){})),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e(i))}var C={class:"sm-function-module-sub-section",style:{margin:"0"}},k={class:"sm-half-L "},E={style:{width:"35%"}},L={class:"sm-half-L"},V={style:{width:"35%"}},D={class:"sm-half-L"},N={style:{width:"35%"}},P={class:"sm-half-L"},T={style:{width:"35%"}},I={class:"boxchild"},O={expose:[],setup:function(e){var f,b,v=viewer.scene,y=t({selectedType:"NONE",selectedId:0,showEditCheck:!0,emitRate:50,lifeRange:[.005,.25],speedRange:[1,10],scaleRange:[1,10],gravity:0}),h=new SuperMap3D.Matrix4;function g(){(b=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas)).setInputAction((function(e){var t,n=viewer.scene.pickPosition(e.position);SuperMap3D.Transforms.eastNorthUpToFixedFrame(n,void 0,h),t="public/data/particle/Fire.json",SuperMap3D.ParticleHelper.fromJsonUrl(t,v).then((function(e){(f=e).modelMatrix=h})),b.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}function w(){SuperMap3D.defaultValue(f)&&v.primitives.remove(f)}return a((function(){return y.emitRate}),(function(e){f&&(f.emitRate=Number(e))})),a((function(){return y.lifeRange}),(function(e){e.length>1&&(f.minLifeTime=Number(e[0]),f.maxLifeTime=Number(e[1]))})),a((function(){return y.speedRange}),(function(e){e.length>1&&(f.minEmitPower=Number(e[0]),f.maxEmitPower=Number(e[1]))})),a((function(){return y.scaleRange}),(function(e){e.length>1&&(f.minSize=Number(e[0]),f.maxSize=Number(e[1]))})),n((function(){w()})),function(e,t){var n=i("el-slider"),a=r("stopdrag");return o(),l(s,null,[c(u("div",C,[p(" 参数设置 "),u("div",k,[u("label",E,m(e.Resource.emitSpeed),1),u(n,{modelValue:d(y).emitRate,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d(y).emitRate=e}),min:1,max:2500,step:20,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),u("div",L,[u("label",V,m(e.Resource.lifeCycle),1),u(n,{modelValue:d(y).lifeRange,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d(y).lifeRange=e}),step:.001,range:"",min:.005,max:.25,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","step","min","max"])]),u("div",D,[u("label",N,m(e.Resource.speedRange),1),u(n,{modelValue:d(y).speedRange,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d(y).speedRange=e}),step:1,range:"",min:1,max:100,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),u("div",P,[u("label",T,m(e.Resource.scaleRange),1),u(n,{modelValue:d(y).scaleRange,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d(y).scaleRange=e}),step:1,range:"",min:1,max:100,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])])],512),[[a]]),u("div",I,[u("button",{type:"button",class:"tbtn",onClick:g},m(e.Resource.addParticle),1),u("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:w},m(e.Resource.clearParticle),1)])],64)}},__file:"src/components/special-effects/particle-system/coms/fire.vue"},z={class:"sm-function-module-sub-section",style:{margin:"0"}},j={class:"sm-half-L"},F=u("label",{class:"label-S"},"发射类型",-1),U={selected:"",value:"Cone"},A={value:"Sphere"},B={value:"Box"},_={class:"sm-half-L "},W={style:{width:"35%"}},H={class:"sm-half-L "},K={style:{width:"35%"}},G={class:"sm-half-L "},J={style:{width:"35%"}},X={class:"sm-half-L "},Y={style:{width:"35%"}},q={class:"sm-half-L "},Q={style:{width:"35%"}},Z={class:"sm-half-L "},$={style:{width:"35%"}},ee={class:"boxchild"},te={expose:[],setup:function(e){var p,b,v=viewer.scene,y=t({selectedType:"Cone",selectedId:0,showEditCheck:!0,setParam:!1,emitRate:1500,particleSize:1,lifeRange:[1,4],speedRange:[6,7],scaleRange:[1,4],gravity:-8}),h=new SuperMap3D.Matrix4;function g(){(b=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas)).setInputAction((function(e){var t,n=viewer.scene.pickPosition(e.position);SuperMap3D.Transforms.eastNorthUpToFixedFrame(n,void 0,h),t="public/data/particle/fountain.json",SuperMap3D.ParticleHelper.fromJsonUrl(t,v).then((function(e){(p=e).modelMatrix=h,p.start()})),b.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}function w(){SuperMap3D.defaultValue(p)&&v.primitives.remove(p)}return a((function(){return y.selectedType}),(function(e){if(p)switch(e){case"Cone":p.createConeEmitter(1,1.05);break;case"Sphere":p.createSphereEmitter(1);break;case"Box":var t=new SuperMap3D.Cartesian3(-1,1,1),n=new SuperMap3D.Cartesian3(1,1,-1),a=new SuperMap3D.Cartesian3(-10,0,-10),i=new SuperMap3D.Cartesian3(10,0,10);p.createBoxEmitter(t,n,a,i)}})),a((function(){return y.emitRate}),(function(e){p&&(p.emitRate=Number(e))})),a((function(){return y.particleSize}),(function(e){p&&(p.minScaleX=Number(e),p.minScaleY=Number(e),p.maxScaleX=Number(e),p.maxScaleY=Number(e))})),a((function(){return y.lifeRange}),(function(e){p&&e.length>1&&(p.minLifeTime=Number(e[0]),p.maxLifeTime=Number(e[1]))})),a((function(){return y.speedRange}),(function(e){p&&e.length>1&&(p.minEmitPower=Number(e[0]),p.maxEmitPower=Number(e[1]))})),a((function(){return y.scaleRange}),(function(e){p&&e.length>1&&(p.minSize=Number(e[0]),p.maxSize=Number(e[1]))})),a((function(){return y.gravity}),(function(e){p&&(p.gravity=new SuperMap3D.Cartesian3(0,0,Number(e)))})),n((function(){w()})),function(e,t){var n=i("el-slider"),a=r("stopdrag");return o(),l(s,null,[c(u("div",z,[u("div",j,[F,c(u("select",{class:"sm-select-m","onUpdate:modelValue":t[1]||(t[1]=function(e){return d(y).selectedType=e})},[u("option",U,m(e.Resource.coneEmit),1),u("option",A,m(e.Resource.sphereEmit),1),u("option",B,m(e.Resource.boxEmit),1)],512),[[f,d(y).selectedType]])]),u("div",_,[u("label",W,m(e.Resource.particleNumber),1),u(n,{modelValue:d(y).emitRate,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d(y).emitRate=e}),min:1,max:2500,step:20,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),u("div",H,[u("label",K,m(e.Resource.particleSize),1),u(n,{modelValue:d(y).particleSize,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d(y).particleSize=e}),min:1,max:60,step:1,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),u("div",G,[u("label",J,m(e.Resource.lifeCycle),1),u(n,{modelValue:d(y).lifeRange,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d(y).lifeRange=e}),step:1,range:"",min:.1,max:30,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue","min"])]),u("div",X,[u("label",Y,m(e.Resource.speedRange),1),u(n,{modelValue:d(y).speedRange,"onUpdate:modelValue":t[5]||(t[5]=function(e){return d(y).speedRange=e}),step:1,range:"",min:1,max:30,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),u("div",q,[u("label",Q,m(e.Resource.scaleRange),1),u(n,{modelValue:d(y).scaleRange,"onUpdate:modelValue":t[6]||(t[6]=function(e){return d(y).scaleRange=e}),step:1,range:"",min:1,max:10,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])]),u("div",Z,[u("label",$,m(e.Resource.gravity),1),u(n,{modelValue:d(y).gravity,"onUpdate:modelValue":t[7]||(t[7]=function(e){return d(y).gravity=e}),step:1,min:-20,max:20,"input-size":"mini",debounce:500,"tooltip-class":"tooltip-class",style:{width:"63%"}},null,8,["modelValue"])])],512),[[a]]),u("div",ee,[u("button",{type:"button",class:"tbtn",onClick:g},m(e.Resource.addParticle),1),u("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:w},m(e.Resource.clearParticle),1)])],64)}},__file:"src/components/special-effects/particle-system/coms/water.vue"},ne={class:"boxchild"},ae={expose:[],setup:function(e){var t,a=viewer.scene,i=new SuperMap3D.Matrix4,r=[];a.skyAtmosphere=new SuperMap3D.SkyAtmosphere,a.globe.show=!1,a.skyAtmosphere.show=!1;var s=-2100;function c(){for(var e=function(e){var t=SuperMap3D.Math.randomBetween(s+300*e,s+300*(e+1)),n=SuperMap3D.Math.randomBetween(0,2e3),o=SuperMap3D.Math.randomBetween(150,550),l=new SuperMap3D.Cartesian3(t,n,o),c="";e%4==0&&(c="public/data/particle/babylon/sparkGravityOne.json"),e%4==1&&(c="public/data/particle/babylon/sparkGravityTwo.json"),e%4==2&&(c="public/data/particle/babylon/sparkGravityThree.json"),e%4==3&&(c="public/data/particle/babylon/sparkGravityFour.json"),SuperMap3D.ParticleHelper.fromJsonUrl(c,a).then((function(t){!function(e,t,n){e.modelMatrix=i,e.worldOffset.x=t.x,e.worldOffset.y=t.y,e.worldOffset.z=t.z;var o=setInterval((function(){e.start()}),2e3+50*n);a.primitives.add(e),r.push(o)}(t,l,e)}))},t=0;t<8;++t)e(t)}function p(){a.globe.show=!1,a.skyAtmosphere.show=!1,(t=new SuperMap3D.ScreenSpaceEventHandler(viewer.scene.canvas)).setInputAction((function(e){var n=viewer.scene.pickPosition(e.position);SuperMap3D.Transforms.eastNorthUpToFixedFrame(n,void 0,i),c(),t.removeInputAction(SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}),SuperMap3D.ScreenSpaceEventType.LEFT_CLICK)}function d(){a.globe.show=!0,a.skyAtmosphere.show=!0,r.length>0&&(r.forEach((function(e){clearInterval(e)})),r=[])}return n((function(){d()})),function(e,t){return o(),l("div",ne,[u("button",{type:"button",class:"tbtn",onClick:p},m(e.Resource.addParticle),1),u("button",{type:"button",class:"tbtn tbtn-margin-left",onClick:d},m(e.Resource.clearParticle),1)])}},__file:"src/components/special-effects/particle-system/coms/fireworks.vue"},ie={name:"Sm3dParticleSystem",props:{},data:function(){return{}},setup:function(e){var t=M(e);return{particles:t.particles,particleSelectedId:t.particleSelectedId,Fire:O,Water:te,FireWorks:ae}}},re={id:"scan-effect-panel",class:"sm-panel"},oe={class:"sm-function-module-sub-section",style:{margin:"0"}},le={class:"sm-half-L symbolic"},se={style:{width:"100%"}},ce={key:0},ue={key:1},pe={key:2};ie.render=function(e,t,n,a,i,d){var f=r("stopdrag"),v=r("drag");return c((o(),l("div",re,[c(u("div",oe,[u("div",le,[(o(!0),l(s,null,b(a.particles,(function(e){return o(),l("div",{key:e.id,class:["symbolic-box",{"theme-color":e.id===a.particleSelectedId}],onClick:function(t){return a.particleSelectedId=e.id}},[u("span",{class:["iconfont",e.iconfont]},null,2),u("label",se,m(e.particleName),1)],10,["onClick"])})),128))]),0===a.particleSelectedId?(o(),l("div",ce,[u(a.Fire)])):p("v-if",!0),1===a.particleSelectedId?(o(),l("div",ue,[u(a.Water)])):p("v-if",!0),2===a.particleSelectedId?(o(),l("div",pe,[u(a.FireWorks)])):p("v-if",!0)],512),[[f]])],512)),[[v]])},ie.__file="src/components/special-effects/particle-system/particle-system.vue",ie.install=function(e){e.component(ie.name,ie)};export default ie;
