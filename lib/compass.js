import{reactive as e,toRefs as n,ref as o,watch as t,onBeforeUnmount as r,openBlock as s,createBlock as i,createVNode as a}from"vue";function c(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function u(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function l(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?u(Object(o),!0).forEach((function(n){c(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}var m=e({isViewer:!1,changeLayers:0,changeGeometrys:0});var p,f,d={errorMsg:function(e){console.log("error",e),alert("error："+e)},warnMsg:function(e){console.log("warn",e)},successMsg:function(e){console.log("success",e)}},v={showRenderLoopErrors:"渲染时发生错误，已停止渲染。",AttributeError:"该组件props没有这个属性：",NoPickPositionSupported:"不支持深度纹理,无法绘制多边形，地形操作功能无法使用！",NoTerrain:"请在地形里使用地形组件！",initViewerWarn:"请先初始化viewer!",MoveMouseHeightBox:"点击鼠标左键结束矩形绘制，移动鼠标绘制box高度",RightClickEndDrawing:"右键单击结束绘制",LeftClickBottomBox:"点击鼠标左键，开始绘制矩形作为box底面",ClickModelAddBox:"点击模型，添加裁剪盒子",SkyLineWarn:"获取天际线体前，请先绘制天际线！",SkyLineBody:"天际线体",ShadowqueryWarn:"此操作需要先开启阴影！",VeiwshedBody:"可视体",VeiwshedBodyHidden:"不可视体",EchartsErr:"二维显示需要echarts支持，未找到相关依赖！",BaseMapImg:"底图",tip1:"<p>点击左键确定操作区域中间点</p><p>右键单击结束绘制</p>"},g=(f=(navigator.language||navigator.browserLanguage).toLowerCase(),window.lang=f,f).toLowerCase();var w=((p=void 0!==g?g:(navigator.language||navigator.browserLanguage).toLowerCase()).startsWith("zh")||p.startsWith("ja"),v);function b(s){var i,a,c=e({resetPosition:"",isfull:!1});if(c.resetPosition=new SuperMap3D.Cartesian3.fromDegrees(110.60396458865515,34.54408834959379,30644793.325518917),s)for(var u in s)c.hasOwnProperty(u)?c[u]=s[u]:d.errorMsg(w.AttributeError+u);c.isfull&&z();var p,f,v=o(null),g=!1;function b(){(a=new SuperMap3D.Cartesian2).x=i.canvas.clientWidth/2,a.y=i.canvas.clientHeight/2,i.postRender.addEventListener(y),window.addEventListener("resize",(function(){a.x=i.canvas.clientWidth/2,a.y=i.canvas.clientHeight/2}))}function y(){var e=i.camera.heading,n="rotate("+-SuperMap3D.Math.toDegrees(e)+"deg)";v.value.style.transform=n,g&&(e<=.05||e>=6.23)&&(i.camera.stopFlyCircle(),e=0,g=!1)}function h(){var e=i.pickPosition(a),n=viewer.camera.position,o=SuperMap3D.Cartesian3.distance(e,n);return o>=1e3?o/30:o>=20?o/20:o>0?.5:0}function z(){var e;document.fullscreenElement?(c.isfull=!1,document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()):(c.isfull=!0,(e=document.documentElement).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())}return m.isViewer&&(i=viewer.scene,b()),t((function(){return m.isViewer}),(function(e){e&&(i=viewer.scene,b())})),r((function(){i.postRender.removeEventListener(y)})),l(l({},n(c)),{},{compass_dom:v,reduceCompass:function(){var e=i.camera.heading,n=8;if(!(e<=.05||e>=6.23)){(e<=.5||e>=5.8)&&(n=2),g=!0;var o=i.pickPosition(a);if(i.camera.heading-SuperMap3D.Math.PI>=0)return i.camera.speedRatio=n,void i.camera.flyCircle(o);i.camera.speedRatio=-n,i.camera.flyCircle(o)}},reset:function(){viewer.camera.flyTo({destination:c.resetPosition})},fullscreenchange:z,zoomIn:function(){var e=10;clearInterval(p),p=setInterval((function(){e=h(),viewer.camera.zoomIn(e)}),30)},mouseup_zoomIn:function(){clearInterval(p)},zoomOut:function(){var e=10;clearInterval(f),f=setInterval((function(){e=h(),viewer.camera.zoomOut(e)}),30)},mouseup_zoomOut:function(){clearInterval(f)}})}var y={name:"Sm3dCompass",props:{isfull:{type:Boolean,default:!1}},setup:function(e){var n=b(e);return{compass_dom:n.compass_dom,isfull:n.isfull,reduceCompass:n.reduceCompass,reset:n.reset,fullscreenchange:n.fullscreenchange,zoomIn:n.zoomIn,mouseup_zoomIn:n.mouseup_zoomIn,zoomOut:n.zoomOut,mouseup_zoomOut:n.mouseup_zoomOut}}},h={id:"compass-panel",class:"compass-panel"},z={id:"compass",style:{transform:"rotate(-45deg)",display:"inline-block"},class:"iconfont iconzhibeizhen",ref:"compass_dom"},O=a("span",{class:"iconfont iconzhongzhi"},null,-1),C=a("span",{class:"iconfont iconfangda"},null,-1),_=a("span",{class:"iconfont iconsuoxiao"},null,-1);y.render=function(e,n,o,t,r,c){return s(),i("div",h,[a("div",{class:"btn_box",style:{"border-radius":"50%"},onClick:n[1]||(n[1]=function(){return t.reduceCompass&&t.reduceCompass.apply(t,arguments)}),title:e.Resource.compass},[a("span",z,null,512)],8,["title"]),a("div",{class:"btn_box",onClick:n[2]||(n[2]=function(){return t.reset&&t.reset.apply(t,arguments)}),title:e.Resource.reset},[O],8,["title"]),a("div",{class:"btn_box",onMousedown:n[3]||(n[3]=function(){return t.zoomIn&&t.zoomIn.apply(t,arguments)}),onMouseup:n[4]||(n[4]=function(){return t.mouseup_zoomIn&&t.mouseup_zoomIn.apply(t,arguments)}),title:e.Resource.zoomIn},[C],40,["title"]),a("div",{class:"btn_box",onMousedown:n[5]||(n[5]=function(){return t.zoomOut&&t.zoomOut.apply(t,arguments)}),onMouseup:n[6]||(n[6]=function(){return t.mouseup_zoomOut&&t.mouseup_zoomOut.apply(t,arguments)}),title:e.Resource.zoomOut},[_],40,["title"]),a("div",{class:"btn_box",onClick:n[7]||(n[7]=function(){return t.fullscreenchange&&t.fullscreenchange.apply(t,arguments)}),title:e.Resource.fullScreen},[a("span",{class:["iconfont",t.isfull?"iconshouqi1":"iconquanping"]},null,2)],8,["title"])])},y.__file="src/components/scene/compass/compass.vue",y.install=function(e){e.component(y.name,y)};export default y;
