define(["./when-7d8885d2","./Cartesian2-54f49cd5","./ArcType-29cf2197","./buildModuleUrl-9403d69d","./Cartographic-9ee1f1bd","./Color-1274f10e","./ComponentDatatype-94b9147c","./Check-737bd4ec","./GeometryAttribute-bf27d0ff","./GeometryAttributes-2f749385","./IndexDatatype-cb5f74b7","./Math-4ffce144","./PolylinePipeline-89be7253","./FeatureDetection-07e177c7","./Event-1c0f5ff4","./RuntimeError-f53bcb51","./WebGLConstants-6b41cc89","./Cartesian4-6d2e270a","./EllipsoidGeodesic-83f454fb","./EllipsoidRhumbLine-fd512dba","./IntersectionTests-6a0482c9","./Plane-74ce87e7"],(function(e,o,r,t,a,l,i,n,s,p,d,f,c,y,u,h,C,g,T,m,b,v){"use strict";function P(e,o,r,t,a,i,n){var s,p=c.PolylinePipeline.numberOfPoints(e,o,a),d=r.red,f=r.green,y=r.blue,u=r.alpha,h=t.red,C=t.green,g=t.blue,T=t.alpha;if(l.Color.equals(r,t)){for(s=0;s<p;s++)i[n++]=l.Color.floatToByte(d),i[n++]=l.Color.floatToByte(f),i[n++]=l.Color.floatToByte(y),i[n++]=l.Color.floatToByte(u);return n}var m=(h-d)/p,b=(C-f)/p,v=(g-y)/p,P=(T-u)/p,_=n;for(s=0;s<p;s++)i[_++]=l.Color.floatToByte(d+s*m),i[_++]=l.Color.floatToByte(f+s*b),i[_++]=l.Color.floatToByte(y+s*v),i[_++]=l.Color.floatToByte(u+s*P);return _}function _(t){var i=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).positions,n=t.colors,s=e.defaultValue(t.colorsPerVertex,!1);this._positions=i,this._colors=n,this._colorsPerVertex=s,this._arcType=e.defaultValue(t.arcType,r.ArcType.GEODESIC),this._granularity=e.defaultValue(t.granularity,f.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=e.defaultValue(t.ellipsoid,o.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry";var p=1+i.length*a.Cartesian3.packedLength;p+=e.defined(n)?1+n.length*l.Color.packedLength:1,this.packedLength=p+o.Ellipsoid.packedLength+3}_.pack=function(r,t,i){var n;i=e.defaultValue(i,0);var s=r._positions,p=s.length;for(t[i++]=p,n=0;n<p;++n,i+=a.Cartesian3.packedLength)a.Cartesian3.pack(s[n],t,i);var d=r._colors;for(p=e.defined(d)?d.length:0,t[i++]=p,n=0;n<p;++n,i+=l.Color.packedLength)l.Color.pack(d[n],t,i);return o.Ellipsoid.pack(r._ellipsoid,t,i),i+=o.Ellipsoid.packedLength,t[i++]=r._colorsPerVertex?1:0,t[i++]=r._arcType,t[i]=r._granularity,t},_.unpack=function(r,t,i){var n;t=e.defaultValue(t,0);var s=r[t++],p=new Array(s);for(n=0;n<s;++n,t+=a.Cartesian3.packedLength)p[n]=a.Cartesian3.unpack(r,t);var d=(s=r[t++])>0?new Array(s):void 0;for(n=0;n<s;++n,t+=l.Color.packedLength)d[n]=l.Color.unpack(r,t);var f=o.Ellipsoid.unpack(r,t);t+=o.Ellipsoid.packedLength;var c=1===r[t++],y=r[t++],u=r[t];return e.defined(i)?(i._positions=p,i._colors=d,i._ellipsoid=f,i._colorsPerVertex=c,i._arcType=y,i._granularity=u,i):new _({positions:p,colors:d,ellipsoid:f,colorsPerVertex:c,arcType:y,granularity:u})};var B=new Array(2),E=new Array(2),A={positions:B,height:E,ellipsoid:void 0,minDistance:void 0,granularity:void 0};return _.createGeometry=function(o){var n,u,h,C,g,T=o._positions,m=o._colors,b=o._colorsPerVertex,v=o._arcType,_=o._granularity,k=o._ellipsoid,D=f.CesiumMath.chordLength(_,k.maximumRadius),G=e.defined(m)&&!b,w=T.length,L=0;if(v===r.ArcType.GEODESIC||v===r.ArcType.RHUMB){var V,x,S;v===r.ArcType.GEODESIC?(V=f.CesiumMath.chordLength(_,k.maximumRadius),x=c.PolylinePipeline.numberOfPoints,S=c.PolylinePipeline.generateArc):(V=_,x=c.PolylinePipeline.numberOfPointsRhumbLine,S=c.PolylinePipeline.generateRhumbArc);var I=c.PolylinePipeline.extractHeights(T,k),R=A;if(v===r.ArcType.GEODESIC?R.minDistance=D:R.granularity=_,R.ellipsoid=k,G){var O=0;for(n=0;n<w-1;n++)O+=x(T[n],T[n+1],V)+1;u=new Float64Array(3*O),C=new Uint8Array(4*O),R.positions=B,R.height=E;var M=0;for(n=0;n<w-1;++n){B[0]=T[n],B[1]=T[n+1],E[0]=I[n],E[1]=I[n+1];var U=S(R);if(e.defined(m)){var N=U.length/3;g=m[n];for(var F=0;F<N;++F)C[M++]=l.Color.floatToByte(g.red),C[M++]=l.Color.floatToByte(g.green),C[M++]=l.Color.floatToByte(g.blue),C[M++]=l.Color.floatToByte(g.alpha)}u.set(U,L),L+=U.length}}else if(R.positions=T,R.height=I,u=new Float64Array(S(R)),e.defined(m)){for(C=new Uint8Array(u.length/3*4),n=0;n<w-1;++n){L=P(T[n],T[n+1],m[n],m[n+1],D,C,L)}var H=m[w-1];C[L++]=l.Color.floatToByte(H.red),C[L++]=l.Color.floatToByte(H.green),C[L++]=l.Color.floatToByte(H.blue),C[L++]=l.Color.floatToByte(H.alpha)}}else{h=G?2*w-2:w,u=new Float64Array(3*h),C=e.defined(m)?new Uint8Array(4*h):void 0;var W=0,Y=0;for(n=0;n<w;++n){var q=T[n];if(G&&n>0&&(a.Cartesian3.pack(q,u,W),W+=3,g=m[n-1],C[Y++]=l.Color.floatToByte(g.red),C[Y++]=l.Color.floatToByte(g.green),C[Y++]=l.Color.floatToByte(g.blue),C[Y++]=l.Color.floatToByte(g.alpha)),G&&n===w-1)break;a.Cartesian3.pack(q,u,W),W+=3,e.defined(m)&&(g=m[n],C[Y++]=l.Color.floatToByte(g.red),C[Y++]=l.Color.floatToByte(g.green),C[Y++]=l.Color.floatToByte(g.blue),C[Y++]=l.Color.floatToByte(g.alpha))}}var z=new p.GeometryAttributes;z.position=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:u}),e.defined(m)&&(z.color=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:C,normalize:!0}));var J=2*((h=u.length/3)-1),j=d.IndexDatatype.createTypedArray(h,J),K=0;for(n=0;n<h-1;++n)j[K++]=n,j[K++]=n+1;return new s.Geometry({attributes:z,indices:j,primitiveType:y.PrimitiveType.LINES,boundingSphere:t.BoundingSphere.fromPoints(T)})},function(r,t){return e.defined(t)&&(r=_.unpack(r,t)),r._ellipsoid=o.Ellipsoid.clone(r._ellipsoid),_.createGeometry(r)}}));
