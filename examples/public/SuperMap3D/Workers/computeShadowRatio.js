define(["./Cartographic-9ee1f1bd","./Cartesian4-6d2e270a","./when-7d8885d2","./Math-4ffce144","./createTaskProcessorWorker","./Check-737bd4ec"],(function(r,e,a,t,n,i){"use strict";var s=new e.Cartesian4(1,1/255,1/65025,1/160581375),o=new e.Cartesian4,f=1024;function u(a,n,i,u,h,c,d){var C=a.longitude,v=a.latitude,g=a.height;if(C=t.CesiumMath.toDegrees(C),v=t.CesiumMath.toDegrees(v),C<n[0]||C>n[2]||v<n[1]||v>n[3])return-1;for(var l=!1,p=0,b=.1*u,m=0;m<=i;m+=u){if(Math.abs(h+m-g)<b){l=!0;break}p++}if(!l)return-1;if(c.length<0)return-1;l=!1;for(var k=0;k<c.length;k+=2){var w=r.Cartesian3.fromDegrees(C,v,g),D=r.Cartesian3.fromDegrees(c[k+0],c[k+1],g);if(r.Cartesian3.distance(w,D)<b){l=!0;break}}if(!l)return-1;var M=n[2]-n[0],x=(g=n[3]-n[1],n[0]-.025*M),y=n[1]-.025*g;M+=.05*M,g+=.05*g;var I=parseInt((C-x)/M*f),P=parseInt((v-y)/g*f);I=I<1?1:I,P=P<1?1:P;var z=d[p],A=0;for(k=-1;k<2;k++)for(var B=-1;B<2;B++){var R=4*(f*(P+B)+(I+k));o.x=z[R],o.y=z[R+1],o.z=z[R+2],o.w=z[R+3],e.Cartesian4.divideByScalar(o,255,o),A=Math.max(A,e.Cartesian4.dot(o,s))}return A=A>.999?1:A}return n((function(e,a){for(var t=e.points,n=e.enuPoints,i=e.bounds,s=e.extend,o=e.spacing,f=e.bottom,h=e.pixelsArray,c=[],d=0,C=t.length;d<C;d++){var v=t[d],g=u(r.Cartographic.fromCartesian(v),i,s,o,f,n,h);c.push({position:r.Cartesian3.clone(v),shadowRatio:g})}return{resultData:c}}))}));
